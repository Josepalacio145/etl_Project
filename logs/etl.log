2025-09-18 21:14:49 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 21:14:49 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 21:14:50 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 21:14:50 | CRITICAL | main | Fallo inesperado en el ETL: name 'logger' is not defined
Traceback (most recent call last):
  File "C:\Users\User\Documents\Python\etl_Project\etl\loader.py", line 9, in load_to_postgres
    logger.info(f"Cargado DataFrame a tabla {table_name} ({len(df)} filas)")
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\User\Documents\Python\etl_Project\main.py", line 19, in main
    load_to_postgres(df, config["table_name"], config["db_connection"])
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\Documents\Python\etl_Project\etl\loader.py", line 11, in load_to_postgres
    logger.error(f"Error al cargar datos en {table_name}: {e}", exc_info=True)
    ^^^^^^
NameError: name 'logger' is not defined
2025-09-18 21:15:44 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 21:15:44 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 21:15:44 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 21:15:44 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (472 filas)
2025-09-18 21:15:44 | INFO | main | âœ… ETL finalizado correctamente
2025-09-18 21:41:33 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 21:41:33 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 21:41:34 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 21:41:34 | CRITICAL | main | Fallo inesperado en el ETL: 'dict' object has no attribute 'columns'
Traceback (most recent call last):
  File "C:\Users\User\Documents\Python\etl_Project\main.py", line 19, in main
    df = clean_dataframe(df)
  File "C:\Users\User\Documents\Python\etl_Project\etl\transform.py", line 2, in clean_dataframe
    df.columns = [c.strip().lower().replace(" ", "_") for c in df.columns]
                                                               ^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'columns'
2025-09-18 21:43:16 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 21:43:16 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 21:43:17 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 21:43:17 | CRITICAL | main | Fallo inesperado en el ETL: name 'file_data' is not defined
Traceback (most recent call last):
  File "C:\Users\User\Documents\Python\etl_Project\main.py", line 20, in main
    df = clean_dataframe(file_data["df"])
                         ^^^^^^^^^
NameError: name 'file_data' is not defined
2025-09-18 21:44:42 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 21:44:42 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 21:44:43 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 21:44:43 | CRITICAL | main | Fallo inesperado en el ETL: name 'file_data' is not defined
Traceback (most recent call last):
  File "C:\Users\User\Documents\Python\etl_Project\main.py", line 19, in main
    df = clean_dataframe(file_data["df"])
                         ^^^^^^^^^
NameError: name 'file_data' is not defined
2025-09-18 21:45:51 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 21:45:51 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 21:45:52 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 21:45:52 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (472 filas)
2025-09-18 21:45:52 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-18 21:45:52 | INFO | main | âœ… ETL finalizado correctamente
2025-09-18 21:56:19 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 21:56:19 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 21:56:19 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 21:56:20 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (472 filas)
2025-09-18 21:56:20 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-18 21:56:20 | INFO | main | âœ… ETL finalizado correctamente
2025-09-18 21:57:35 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 21:57:35 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 21:57:35 | ERROR | etl.extractor | Error leyendo Datos_2020_550.xlsx: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
Traceback (most recent call last):
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\compat\_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "C:\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'xlrd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\User\Documents\Python\etl_Project\etl\extractor.py", line 19, in read_excels
    df = pd.read_excel(file)
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\io\excel\_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\io\excel\_xlrd.py", line 45, in __init__
    import_optional_dependency("xlrd", extra=err_msg)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\compat\_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
2025-09-18 21:57:35 | ERROR | etl.extractor | Error leyendo Datos_2021_550.xlsx: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
Traceback (most recent call last):
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\compat\_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "C:\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'xlrd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\User\Documents\Python\etl_Project\etl\extractor.py", line 19, in read_excels
    df = pd.read_excel(file)
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\io\excel\_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\io\excel\_xlrd.py", line 45, in __init__
    import_optional_dependency("xlrd", extra=err_msg)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\compat\_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
2025-09-18 21:57:35 | ERROR | etl.extractor | Error leyendo Datos_2022_550.xlsx: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
Traceback (most recent call last):
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\compat\_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "C:\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'xlrd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\User\Documents\Python\etl_Project\etl\extractor.py", line 19, in read_excels
    df = pd.read_excel(file)
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\io\excel\_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\io\excel\_xlrd.py", line 45, in __init__
    import_optional_dependency("xlrd", extra=err_msg)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Roaming\Python\Python313\site-packages\pandas\compat\_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
2025-09-18 21:57:35 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 21:57:36 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (472 filas)
2025-09-18 21:57:36 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-18 21:57:36 | INFO | main | âœ… ETL finalizado correctamente
2025-09-18 22:01:43 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 22:01:43 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 22:01:43 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-18 22:01:43 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-18 22:01:44 | INFO | etl.extractor | Archivo Datos_2022_550.xlsx leÃ­do correctamente con 484 filas
2025-09-18 22:01:44 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 22:01:44 | CRITICAL | main | Fallo inesperado en el ETL: 'int' object has no attribute 'strip'
Traceback (most recent call last):
  File "C:\Users\User\Documents\Python\etl_Project\main.py", line 19, in main
    df = clean_dataframe(file_data["df"])  # DataFrame real
  File "C:\Users\User\Documents\Python\etl_Project\etl\transform.py", line 2, in clean_dataframe
    df.columns = [c.strip().lower().replace(" ", "_") for c in df.columns]
                  ^^^^^^^
AttributeError: 'int' object has no attribute 'strip'
2025-09-18 22:05:43 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 22:05:43 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 22:05:43 | INFO | etl.extractor | Archivo Datos_2022_550.xlsx leÃ­do correctamente con 484 filas
2025-09-18 22:05:43 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 22:05:44 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (484 filas)
2025-09-18 22:05:44 | INFO | etl.utils | Archivo Datos_2022_550.xlsx movido a data\processed\Datos_2022_550.xlsx
2025-09-18 22:05:44 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (472 filas)
2025-09-18 22:05:44 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-18 22:05:44 | INFO | main | âœ… ETL finalizado correctamente
2025-09-18 22:31:24 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-18 22:31:24 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-18 22:31:25 | INFO | etl.extractor | Archivo Datos_2022_550.xlsx leÃ­do correctamente con 484 filas
2025-09-18 22:31:25 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-18 22:31:25 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (484 filas)
2025-09-18 22:31:25 | INFO | etl.utils | Archivo Datos_2022_550.xlsx movido a data\processed\Datos_2022_550.xlsx
2025-09-18 22:31:25 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (472 filas)
2025-09-18 22:31:25 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-18 22:31:25 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 19:03:33 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 19:03:33 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 19:03:37 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-19 19:03:37 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 19:03:38 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-19 19:03:38 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-19 19:03:39 | ERROR | etl.loader | Error al cargar datos en staging_table: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 843, in to_sql
    with pandasSQL_builder(con, schema=schema, need_transaction=True) as pandas_sql:
         ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 908, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1648, in __init__
    con = self.exit_stack.enter_context(con.connect())
                                        ~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
2025-09-19 19:03:39 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-19 19:03:40 | ERROR | etl.loader | Error al cargar datos en staging_table: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 843, in to_sql
    with pandasSQL_builder(con, schema=schema, need_transaction=True) as pandas_sql:
         ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 908, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1648, in __init__
    con = self.exit_stack.enter_context(con.connect())
                                        ~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
2025-09-19 19:03:40 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 19:03:40 | ERROR | etl.loader | Error al cargar datos en staging_table: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 843, in to_sql
    with pandasSQL_builder(con, schema=schema, need_transaction=True) as pandas_sql:
         ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 908, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1648, in __init__
    con = self.exit_stack.enter_context(con.connect())
                                        ~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
2025-09-19 19:03:40 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-19 19:03:40 | ERROR | etl.loader | Error al cargar datos en staging_table: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 843, in to_sql
    with pandasSQL_builder(con, schema=schema, need_transaction=True) as pandas_sql:
         ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 908, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1648, in __init__
    con = self.exit_stack.enter_context(con.connect())
                                        ~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
2025-09-19 19:03:40 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-19 19:03:40 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 19:16:30 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 19:16:30 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 19:16:30 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-19 19:16:31 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 19:16:32 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-19 19:16:32 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-19 19:16:33 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (550 filas)
2025-09-19 19:16:33 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-19 19:16:33 | ERROR | etl.loader | Error al cargar datos en staging_table: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_cas__0': 4, 'fec_arc_xl__0': '2020-07-22', 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'confirmados__0': 1, 'cod_mun_o__0': 307, 'fecha_nto__0': '2003-01-08', 'ocupacion__0': 9998, 'per_etn__0': 6, 'estrato__0': '2         ', 'fec_con__0': '2020-07-16', 'fec_hos__0': '2020-07-17', 'departamento_residencia__0': 'TOLIMA', 'edad__0': 17, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_dpto_n__0': 25, 'cod_ase__0': 'EPS037', 'gp_indigen__0': 2, 'gp_psiquia__0': 2, 'cod_dpto_o__0': 25, 'estado_final_de_caso__0': 4, 'gp_desplaz__0': 2, 'pais_ocurrencia__0': 'COLOMBIA', 'fec_not__0': '2020-07-19', 'cod_dpto_r__0': 73, 'cod_sub__0': 20, 'ini_sin__0': '2020-07-16', 'ano__0': 2020, 'fm_fuerza__0': None, 'uni_med__0': 1, 'fm_unidad__0': None, 'nacionalidad__0': 170, 'municipio_ocurrencia__0': 'GIRARDOT', 'gru_pob__0': None, 'cod_pre__0': 2589902990, 'gp_migrant__0': 2, 'pac_hos__0': 1, 'con_fin__0': 2, 'ajuste__0': 0, 'gp_gestan__0': 2, 'cod_mun_n__0': 25899, 'cer_def__0': 722298969.0, 'cbmte__0': '9999', 'fm_grado__0': None, 'consecutive_origen__0': 25, 'tip_ss__0': 'C', 'cod_pais_r__0': 170, 'gp_carcela__0': 2 ... 32531 parameters truncated ... 'gp_desplaz__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'fec_not__446': '2020-07-17', 'cod_dpto_r__446': 18, 'cod_sub__446': 1, 'ini_sin__446': '2020-07-04', 'ano__446': 2020, 'fm_fuerza__446': None, 'uni_med__446': 1, 'fm_unidad__446': None, 'nacionalidad__446': 170, 'municipio_ocurrencia__446': 'FLORENCIA', 'gru_pob__446': None, 'cod_pre__446': 1800107466, 'gp_migrant__446': 2, 'pac_hos__446': 1, 'con_fin__446': 2, 'ajuste__446': 7, 'gp_gestan__446': 2, 'cod_mun_n__446': 18001, 'cer_def__446': 720399987.0, 'cbmte__446': 'J189', 'fm_grado__446': None, 'consecutive_origen__446': 444, 'tip_ss__446': 'S', 'cod_pais_r__446': 170, 'gp_carcela__446': 2, 'gp_otros__446': 1, 'fec_def__446': '2020-07-17', 'consecutive_12__446': 0, 'nom_grupo__446': '                                                                                                    ', 'gp_discapa__446': 2, 'fec_aju__446': '2020-08-10', 'sem_ges__446': '          ', 'gp_pobicfb__446': 2, 'municipio_residencia__446': 'FLORENCIA', 'departamento_notificacion__446': 'CAQUETA', 'cod_pais_o__446': 170, 'sexo__446': 'F', 'gp_vic_vio__446': 2, 'fuente__446': 1, 'cod_mun_r__446': 1, 'gp_mad_com__446': 2, 'cod_eve__446': 550, 'va_sispro__446': 1, 'pais_residencia__446': 'COLOMBIA', 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'FLORENCIA', 'area__446': 1, 'semana__446': 29}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_cas__0': 4, 'fec_arc_xl__0': '2020-07-22', 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'confirmados__0': 1, 'cod_mun_o__0': 307, 'fecha_nto__0': '2003-01-08', 'ocupacion__0': 9998, 'per_etn__0': 6, 'estrato__0': '2         ', 'fec_con__0': '2020-07-16', 'fec_hos__0': '2020-07-17', 'departamento_residencia__0': 'TOLIMA', 'edad__0': 17, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_dpto_n__0': 25, 'cod_ase__0': 'EPS037', 'gp_indigen__0': 2, 'gp_psiquia__0': 2, 'cod_dpto_o__0': 25, 'estado_final_de_caso__0': 4, 'gp_desplaz__0': 2, 'pais_ocurrencia__0': 'COLOMBIA', 'fec_not__0': '2020-07-19', 'cod_dpto_r__0': 73, 'cod_sub__0': 20, 'ini_sin__0': '2020-07-16', 'ano__0': 2020, 'fm_fuerza__0': None, 'uni_med__0': 1, 'fm_unidad__0': None, 'nacionalidad__0': 170, 'municipio_ocurrencia__0': 'GIRARDOT', 'gru_pob__0': None, 'cod_pre__0': 2589902990, 'gp_migrant__0': 2, 'pac_hos__0': 1, 'con_fin__0': 2, 'ajuste__0': 0, 'gp_gestan__0': 2, 'cod_mun_n__0': 25899, 'cer_def__0': 722298969.0, 'cbmte__0': '9999', 'fm_grado__0': None, 'consecutive_origen__0': 25, 'tip_ss__0': 'C', 'cod_pais_r__0': 170, 'gp_carcela__0': 2 ... 32531 parameters truncated ... 'gp_desplaz__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'fec_not__446': '2020-07-17', 'cod_dpto_r__446': 18, 'cod_sub__446': 1, 'ini_sin__446': '2020-07-04', 'ano__446': 2020, 'fm_fuerza__446': None, 'uni_med__446': 1, 'fm_unidad__446': None, 'nacionalidad__446': 170, 'municipio_ocurrencia__446': 'FLORENCIA', 'gru_pob__446': None, 'cod_pre__446': 1800107466, 'gp_migrant__446': 2, 'pac_hos__446': 1, 'con_fin__446': 2, 'ajuste__446': 7, 'gp_gestan__446': 2, 'cod_mun_n__446': 18001, 'cer_def__446': 720399987.0, 'cbmte__446': 'J189', 'fm_grado__446': None, 'consecutive_origen__446': 444, 'tip_ss__446': 'S', 'cod_pais_r__446': 170, 'gp_carcela__446': 2, 'gp_otros__446': 1, 'fec_def__446': '2020-07-17', 'consecutive_12__446': 0, 'nom_grupo__446': '                                                                                                    ', 'gp_discapa__446': 2, 'fec_aju__446': '2020-08-10', 'sem_ges__446': '          ', 'gp_pobicfb__446': 2, 'municipio_residencia__446': 'FLORENCIA', 'departamento_notificacion__446': 'CAQUETA', 'cod_pais_o__446': 170, 'sexo__446': 'F', 'gp_vic_vio__446': 2, 'fuente__446': 1, 'cod_mun_r__446': 1, 'gp_mad_com__446': 2, 'cod_eve__446': 550, 'va_sispro__446': 1, 'pais_residencia__446': 'COLOMBIA', 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'FLORENCIA', 'area__446': 1, 'semana__446': 29}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 19:16:33 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 19:16:33 | ERROR | etl.loader | Error al cargar datos en staging_table: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...LOMBIA', 'MORTALIDAD MATERNA', 'META', 'GRANADA', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_cas__0': 4, 'fec_arc_xl__0': '2021-09-01', 'nom_upgd__0': 'HOSPITAL DEPARTAMENTAL DE GRANADA ESE', 'confirmados__0': 1, 'cod_mun_o__0': 313, 'fecha_nto__0': '2000-09-04', 'ocupacion__0': 9996, 'per_etn__0': 6, 'estrato__0': '2         ', 'fec_con__0': '2021-02-11', 'fec_hos__0': '2021-02-11', 'departamento_residencia__0': 'META', 'edad__0': 20, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_ocurrencia__0': 'META', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_dpto_n__0': 50, 'cod_ase__0': 'EPSS34', 'gp_indigen__0': 2, 'gp_psiquia__0': 2, 'cod_dpto_o__0': 50, 'estado_final_de_caso__0': 4, 'gp_desplaz__0': 2, 'pais_ocurrencia__0': 'COLOMBIA', 'fec_not__0': '2021-02-14', 'cod_dpto_r__0': 50, 'cod_sub__0': 1, 'ini_sin__0': '2021-02-11', 'ano__0': 2021, 'fm_fuerza__0': None, 'uni_med__0': 1, 'fm_unidad__0': None, 'nacionalidad__0': 170, 'municipio_ocurrencia__0': 'GRANADA', 'gru_pob__0': None, 'cod_pre__0': 5031300522, 'gp_migrant__0': 2, 'pac_hos__0': 1, 'con_fin__0': 2, 'ajuste__0': 7, 'gp_gestan__0': 2, 'cod_mun_n__0': 50313, 'cer_def__0': 724616210.0, 'cbmte__0': 'I469', 'fm_grado__0': None, 'consecutive_origen__0': 1, 'tip_ss__0': 'S', 'cod_pais_r__0': 170, 'gp_carcela__0': 2 ... 32531 parameters truncated ... 'gp_desplaz__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'fec_not__446': '2021-01-05', 'cod_dpto_r__446': 13, 'cod_sub__446': 1, 'ini_sin__446': '2020-12-30', 'ano__446': 2021, 'fm_fuerza__446': None, 'uni_med__446': 1, 'fm_unidad__446': None, 'nacionalidad__446': 170, 'municipio_ocurrencia__446': 'EL CARMEN DE BOLIVAR', 'gru_pob__446': None, 'cod_pre__446': 7000101513, 'gp_migrant__446': 2, 'pac_hos__446': 1, 'con_fin__446': 2, 'ajuste__446': 0, 'gp_gestan__446': 2, 'cod_mun_n__446': 70001, 'cer_def__446': 725465334.0, 'cbmte__446': 'O141', 'fm_grado__446': None, 'consecutive_origen__446': 447, 'tip_ss__446': 'S', 'cod_pais_r__446': 170, 'gp_carcela__446': 2, 'gp_otros__446': 1, 'fec_def__446': '2021-01-05', 'consecutive_12__446': 0, 'nom_grupo__446': '                                                                                                    ', 'gp_discapa__446': 2, 'fec_aju__446': '2021-01-05', 'sem_ges__446': '          ', 'gp_pobicfb__446': 2, 'municipio_residencia__446': 'EL CARMEN DE BOLIVAR', 'departamento_notificacion__446': 'SUCRE', 'cod_pais_o__446': 170, 'sexo__446': 'F', 'gp_vic_vio__446': 2, 'fuente__446': 1, 'cod_mun_r__446': 244, 'gp_mad_com__446': 2, 'cod_eve__446': 550, 'va_sispro__446': 1, 'pais_residencia__446': 'COLOMBIA', 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'SINCELEJO', 'area__446': 3, 'semana__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...LOMBIA', 'MORTALIDAD MATERNA', 'META', 'GRANADA', 'COLOMBIA'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...LOMBIA', 'MORTALIDAD MATERNA', 'META', 'GRANADA', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_cas__0': 4, 'fec_arc_xl__0': '2021-09-01', 'nom_upgd__0': 'HOSPITAL DEPARTAMENTAL DE GRANADA ESE', 'confirmados__0': 1, 'cod_mun_o__0': 313, 'fecha_nto__0': '2000-09-04', 'ocupacion__0': 9996, 'per_etn__0': 6, 'estrato__0': '2         ', 'fec_con__0': '2021-02-11', 'fec_hos__0': '2021-02-11', 'departamento_residencia__0': 'META', 'edad__0': 20, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_ocurrencia__0': 'META', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_dpto_n__0': 50, 'cod_ase__0': 'EPSS34', 'gp_indigen__0': 2, 'gp_psiquia__0': 2, 'cod_dpto_o__0': 50, 'estado_final_de_caso__0': 4, 'gp_desplaz__0': 2, 'pais_ocurrencia__0': 'COLOMBIA', 'fec_not__0': '2021-02-14', 'cod_dpto_r__0': 50, 'cod_sub__0': 1, 'ini_sin__0': '2021-02-11', 'ano__0': 2021, 'fm_fuerza__0': None, 'uni_med__0': 1, 'fm_unidad__0': None, 'nacionalidad__0': 170, 'municipio_ocurrencia__0': 'GRANADA', 'gru_pob__0': None, 'cod_pre__0': 5031300522, 'gp_migrant__0': 2, 'pac_hos__0': 1, 'con_fin__0': 2, 'ajuste__0': 7, 'gp_gestan__0': 2, 'cod_mun_n__0': 50313, 'cer_def__0': 724616210.0, 'cbmte__0': 'I469', 'fm_grado__0': None, 'consecutive_origen__0': 1, 'tip_ss__0': 'S', 'cod_pais_r__0': 170, 'gp_carcela__0': 2 ... 32531 parameters truncated ... 'gp_desplaz__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'fec_not__446': '2021-01-05', 'cod_dpto_r__446': 13, 'cod_sub__446': 1, 'ini_sin__446': '2020-12-30', 'ano__446': 2021, 'fm_fuerza__446': None, 'uni_med__446': 1, 'fm_unidad__446': None, 'nacionalidad__446': 170, 'municipio_ocurrencia__446': 'EL CARMEN DE BOLIVAR', 'gru_pob__446': None, 'cod_pre__446': 7000101513, 'gp_migrant__446': 2, 'pac_hos__446': 1, 'con_fin__446': 2, 'ajuste__446': 0, 'gp_gestan__446': 2, 'cod_mun_n__446': 70001, 'cer_def__446': 725465334.0, 'cbmte__446': 'O141', 'fm_grado__446': None, 'consecutive_origen__446': 447, 'tip_ss__446': 'S', 'cod_pais_r__446': 170, 'gp_carcela__446': 2, 'gp_otros__446': 1, 'fec_def__446': '2021-01-05', 'consecutive_12__446': 0, 'nom_grupo__446': '                                                                                                    ', 'gp_discapa__446': 2, 'fec_aju__446': '2021-01-05', 'sem_ges__446': '          ', 'gp_pobicfb__446': 2, 'municipio_residencia__446': 'EL CARMEN DE BOLIVAR', 'departamento_notificacion__446': 'SUCRE', 'cod_pais_o__446': 170, 'sexo__446': 'F', 'gp_vic_vio__446': 2, 'fuente__446': 1, 'cod_mun_r__446': 244, 'gp_mad_com__446': 2, 'cod_eve__446': 550, 'va_sispro__446': 1, 'pais_residencia__446': 'COLOMBIA', 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'SINCELEJO', 'area__446': 3, 'semana__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 19:16:33 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-19 19:16:34 | ERROR | etl.loader | Error al cargar datos en staging_table: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...ALIDAD MATERNA', 'ATLANTICO', 'PALMAR DE VARELA', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_cas__0': 4, 'fec_arc_xl__0': '2023-07-21', 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'confirmados__0': 1, 'cod_mun_o__0': 520, 'fecha_nto__0': '1985-03-26', 'ocupacion__0': 26340.0, 'per_etn__0': 6, 'estrato__0': '2         ', 'fec_con__0': '2023-07-19', 'fec_hos__0': '2023-07-19', 'departamento_residencia__0': 'ATLANTICO', 'edad__0': 38, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_ocurrencia__0': 'ATLANTICO', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_dpto_n__0': 8, 'cod_ase__0': 'EPS010', 'gp_indigen__0': 2, 'gp_psiquia__0': 2, 'cod_dpto_o__0': 8, 'estado_final_de_caso__0': 4, 'gp_desplaz__0': 2, 'pais_ocurrencia__0': 'COLOMBIA', 'fec_not__0': '2023-07-21', 'cod_dpto_r__0': 8, 'cod_sub__0': 1, 'ini_sin__0': '2023-07-19', 'ano__0': 2023, 'fm_fuerza__0': None, 'uni_med__0': 1, 'fm_unidad__0': None, 'nacionalidad__0': 170, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'gru_pob__0': None, 'cod_pre__0': 800101106, 'gp_migrant__0': 2, 'pac_hos__0': 1, 'con_fin__0': 2, 'ajuste__0': 7, 'gp_gestan__0': 1, 'cod_mun_n__0': 8001, 'cer_def__0': 23074520316259, 'cbmte__0': 'O881', 'fm_grado__0': None, 'consecutive_origen__0': 280, 'tip_ss__0': 'C', 'cod_pais_r__0': 170, 'gp_carcela__0': 2 ... 32531 parameters truncated ... 'gp_desplaz__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'fec_not__446': '2023-05-15', 'cod_dpto_r__446': 20, 'cod_sub__446': 1, 'ini_sin__446': '2023-04-10', 'ano__446': 2023, 'fm_fuerza__446': None, 'uni_med__446': 1, 'fm_unidad__446': None, 'nacionalidad__446': 170, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'gru_pob__446': None, 'cod_pre__446': 2000100183, 'gp_migrant__446': 2, 'pac_hos__446': 2, 'con_fin__446': 2, 'ajuste__446': 0, 'gp_gestan__446': 2, 'cod_mun_n__446': 20001, 'cer_def__446': 23055820256300, 'cbmte__446': 'C50X', 'fm_grado__446': None, 'consecutive_origen__446': 163, 'tip_ss__446': 'S', 'cod_pais_r__446': 170, 'gp_carcela__446': 2, 'gp_otros__446': 1, 'fec_def__446': '2023-05-15', 'consecutive_12__446': 10050179, 'nom_grupo__446': '                                                                                                    ', 'gp_discapa__446': 2, 'fec_aju__446': '2023-05-15', 'sem_ges__446': '          ', 'gp_pobicfb__446': 2, 'municipio_residencia__446': 'VALLEDUPAR', 'departamento_notificacion__446': 'CESAR', 'cod_pais_o__446': 170, 'sexo__446': 'F', 'gp_vic_vio__446': 2, 'fuente__446': 4, 'cod_mun_r__446': 1, 'gp_mad_com__446': 2, 'cod_eve__446': 550, 'va_sispro__446': 1, 'pais_residencia__446': 'COLOMBIA', 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'VALLEDUPAR', 'area__446': 1, 'semana__446': 20}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...ALIDAD MATERNA', 'ATLANTICO', 'PALMAR DE VARELA', 'COLOMBIA'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...ALIDAD MATERNA', 'ATLANTICO', 'PALMAR DE VARELA', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_cas__0': 4, 'fec_arc_xl__0': '2023-07-21', 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'confirmados__0': 1, 'cod_mun_o__0': 520, 'fecha_nto__0': '1985-03-26', 'ocupacion__0': 26340.0, 'per_etn__0': 6, 'estrato__0': '2         ', 'fec_con__0': '2023-07-19', 'fec_hos__0': '2023-07-19', 'departamento_residencia__0': 'ATLANTICO', 'edad__0': 38, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_ocurrencia__0': 'ATLANTICO', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_dpto_n__0': 8, 'cod_ase__0': 'EPS010', 'gp_indigen__0': 2, 'gp_psiquia__0': 2, 'cod_dpto_o__0': 8, 'estado_final_de_caso__0': 4, 'gp_desplaz__0': 2, 'pais_ocurrencia__0': 'COLOMBIA', 'fec_not__0': '2023-07-21', 'cod_dpto_r__0': 8, 'cod_sub__0': 1, 'ini_sin__0': '2023-07-19', 'ano__0': 2023, 'fm_fuerza__0': None, 'uni_med__0': 1, 'fm_unidad__0': None, 'nacionalidad__0': 170, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'gru_pob__0': None, 'cod_pre__0': 800101106, 'gp_migrant__0': 2, 'pac_hos__0': 1, 'con_fin__0': 2, 'ajuste__0': 7, 'gp_gestan__0': 1, 'cod_mun_n__0': 8001, 'cer_def__0': 23074520316259, 'cbmte__0': 'O881', 'fm_grado__0': None, 'consecutive_origen__0': 280, 'tip_ss__0': 'C', 'cod_pais_r__0': 170, 'gp_carcela__0': 2 ... 32531 parameters truncated ... 'gp_desplaz__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'fec_not__446': '2023-05-15', 'cod_dpto_r__446': 20, 'cod_sub__446': 1, 'ini_sin__446': '2023-04-10', 'ano__446': 2023, 'fm_fuerza__446': None, 'uni_med__446': 1, 'fm_unidad__446': None, 'nacionalidad__446': 170, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'gru_pob__446': None, 'cod_pre__446': 2000100183, 'gp_migrant__446': 2, 'pac_hos__446': 2, 'con_fin__446': 2, 'ajuste__446': 0, 'gp_gestan__446': 2, 'cod_mun_n__446': 20001, 'cer_def__446': 23055820256300, 'cbmte__446': 'C50X', 'fm_grado__446': None, 'consecutive_origen__446': 163, 'tip_ss__446': 'S', 'cod_pais_r__446': 170, 'gp_carcela__446': 2, 'gp_otros__446': 1, 'fec_def__446': '2023-05-15', 'consecutive_12__446': 10050179, 'nom_grupo__446': '                                                                                                    ', 'gp_discapa__446': 2, 'fec_aju__446': '2023-05-15', 'sem_ges__446': '          ', 'gp_pobicfb__446': 2, 'municipio_residencia__446': 'VALLEDUPAR', 'departamento_notificacion__446': 'CESAR', 'cod_pais_o__446': 170, 'sexo__446': 'F', 'gp_vic_vio__446': 2, 'fuente__446': 4, 'cod_mun_r__446': 1, 'gp_mad_com__446': 2, 'cod_eve__446': 550, 'va_sispro__446': 1, 'pais_residencia__446': 'COLOMBIA', 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'VALLEDUPAR', 'area__446': 1, 'semana__446': 20}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 19:16:34 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-19 19:16:34 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 19:26:32 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 19:26:32 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 19:26:33 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-19 19:26:34 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (550 filas)
2025-09-19 19:26:34 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-19 19:26:34 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 19:27:26 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 19:27:26 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 19:27:27 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 19:27:28 | ERROR | etl.loader | Error al cargar datos en staging_table: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_sub__0': 20, 'gru_pob__0': None, 'cod_mun_r__0': 275, 'pac_hos__0': 1, 'gp_desmovi__0': 2, 'va_sispro__0': 1, 'area__0': 1, 'fm_unidad__0': None, 'tip_cas__0': 4, 'gp_pobicfb__0': 2, 'gp_psiquia__0': 2, 'fecha_nto__0': '2003-01-08', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_residencia__0': 'TOLIMA', 'cod_mun_o__0': 307, 'municipio_residencia__0': 'FLANDES', 'consecutive_12__0': 0, 'gp_indigen__0': 2, 'tip_ss__0': 'C', 'fuente__0': 1, 'municipio_notificacion__0': 'ZIPAQUIRA', 'con_fin__0': 2, 'gp_carcela__0': 2, 'cod_ase__0': 'EPS037', 'fec_def__0': '2020-07-18', 'ocupacion__0': 9998, 'ajuste__0': 0, 'gp_desplaz__0': 2, 'cbmte__0': '9999', 'confirmados__0': 1, 'gp_migrant__0': 2, 'sexo__0': 'F', 'cod_pais_o__0': 170, 'gp_discapa__0': 2, 'cod_eve__0': 550, 'ini_sin__0': '2020-07-16', 'cod_dpto_r__0': 73, 'fec_aju__0': '2020-07-19', 'estado_final_de_caso__0': 4, 'cer_def__0': 722298969.0, 'gp_otros__0': 1, 'cod_pre__0': 2589902990, 'cod_pais_r__0': 170, 'edad__0': 17, 'nacionalidad__0': 170, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'per_etn__0': 6, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'sem_ges__0': '          ', 'fec_not__0': '2020-07-19' ... 32531 parameters truncated ... 'cod_ase__446': 'EPSS16', 'fec_def__446': '2020-07-17', 'ocupacion__446': 9996, 'ajuste__446': 7, 'gp_desplaz__446': 2, 'cbmte__446': 'J189', 'confirmados__446': 1, 'gp_migrant__446': 2, 'sexo__446': 'F', 'cod_pais_o__446': 170, 'gp_discapa__446': 2, 'cod_eve__446': 550, 'ini_sin__446': '2020-07-04', 'cod_dpto_r__446': 18, 'fec_aju__446': '2020-08-10', 'estado_final_de_caso__446': 4, 'cer_def__446': 720399987.0, 'gp_otros__446': 1, 'cod_pre__446': 1800107466, 'cod_pais_r__446': 170, 'edad__446': 33, 'nacionalidad__446': 170, 'departamento_ocurrencia__446': 'CAQUETA', 'per_etn__446': 6, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'sem_ges__446': '          ', 'fec_not__446': '2020-07-17', 'nom_grupo__446': '                                                                                                    ', 'estrato__446': '2         ', 'consecutive_origen__446': 444, 'municipio_ocurrencia__446': 'FLORENCIA', 'semana__446': 29, 'gp_vic_vio__446': 2, 'cod_mun_n__446': 18001, 'fec_hos__446': '2020-07-14', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'ano__446': 2020, 'cod_dpto_o__446': 18, 'cod_dpto_n__446': 18, 'fec_con__446': '2020-07-14', 'uni_med__446': 1, 'gp_gestan__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'fm_fuerza__446': None, 'pais_residencia__446': 'COLOMBIA', 'departamento_notificacion__446': 'CAQUETA', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'fec_arc_xl__446': '2020-07-22', 'gp_mad_com__446': 2, 'fm_grado__446': None}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_sub__0': 20, 'gru_pob__0': None, 'cod_mun_r__0': 275, 'pac_hos__0': 1, 'gp_desmovi__0': 2, 'va_sispro__0': 1, 'area__0': 1, 'fm_unidad__0': None, 'tip_cas__0': 4, 'gp_pobicfb__0': 2, 'gp_psiquia__0': 2, 'fecha_nto__0': '2003-01-08', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_residencia__0': 'TOLIMA', 'cod_mun_o__0': 307, 'municipio_residencia__0': 'FLANDES', 'consecutive_12__0': 0, 'gp_indigen__0': 2, 'tip_ss__0': 'C', 'fuente__0': 1, 'municipio_notificacion__0': 'ZIPAQUIRA', 'con_fin__0': 2, 'gp_carcela__0': 2, 'cod_ase__0': 'EPS037', 'fec_def__0': '2020-07-18', 'ocupacion__0': 9998, 'ajuste__0': 0, 'gp_desplaz__0': 2, 'cbmte__0': '9999', 'confirmados__0': 1, 'gp_migrant__0': 2, 'sexo__0': 'F', 'cod_pais_o__0': 170, 'gp_discapa__0': 2, 'cod_eve__0': 550, 'ini_sin__0': '2020-07-16', 'cod_dpto_r__0': 73, 'fec_aju__0': '2020-07-19', 'estado_final_de_caso__0': 4, 'cer_def__0': 722298969.0, 'gp_otros__0': 1, 'cod_pre__0': 2589902990, 'cod_pais_r__0': 170, 'edad__0': 17, 'nacionalidad__0': 170, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'per_etn__0': 6, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'sem_ges__0': '          ', 'fec_not__0': '2020-07-19' ... 32531 parameters truncated ... 'cod_ase__446': 'EPSS16', 'fec_def__446': '2020-07-17', 'ocupacion__446': 9996, 'ajuste__446': 7, 'gp_desplaz__446': 2, 'cbmte__446': 'J189', 'confirmados__446': 1, 'gp_migrant__446': 2, 'sexo__446': 'F', 'cod_pais_o__446': 170, 'gp_discapa__446': 2, 'cod_eve__446': 550, 'ini_sin__446': '2020-07-04', 'cod_dpto_r__446': 18, 'fec_aju__446': '2020-08-10', 'estado_final_de_caso__446': 4, 'cer_def__446': 720399987.0, 'gp_otros__446': 1, 'cod_pre__446': 1800107466, 'cod_pais_r__446': 170, 'edad__446': 33, 'nacionalidad__446': 170, 'departamento_ocurrencia__446': 'CAQUETA', 'per_etn__446': 6, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'sem_ges__446': '          ', 'fec_not__446': '2020-07-17', 'nom_grupo__446': '                                                                                                    ', 'estrato__446': '2         ', 'consecutive_origen__446': 444, 'municipio_ocurrencia__446': 'FLORENCIA', 'semana__446': 29, 'gp_vic_vio__446': 2, 'cod_mun_n__446': 18001, 'fec_hos__446': '2020-07-14', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'ano__446': 2020, 'cod_dpto_o__446': 18, 'cod_dpto_n__446': 18, 'fec_con__446': '2020-07-14', 'uni_med__446': 1, 'gp_gestan__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'fm_fuerza__446': None, 'pais_residencia__446': 'COLOMBIA', 'departamento_notificacion__446': 'CAQUETA', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'fec_arc_xl__446': '2020-07-22', 'gp_mad_com__446': 2, 'fm_grado__446': None}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 19:27:28 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 19:27:28 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 19:30:44 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 19:30:44 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 19:30:46 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 19:30:46 | ERROR | etl.loader | Error al cargar datos en staging_table: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'estado_final_de_caso__0': 4, 'gp_carcela__0': 2, 'cer_def__0': 722298969.0, 'fec_hos__0': '2020-07-17', 'cod_dpto_n__0': 25, 'cod_pre__0': 2589902990, 'fec_arc_xl__0': '2020-07-22', 'consecutive_origen__0': 25, 'gp_indigen__0': 2, 'municipio_residencia__0': 'FLANDES', 'fec_def__0': '2020-07-18', 'semana__0': 29, 'pais_ocurrencia__0': 'COLOMBIA', 'tip_ss__0': 'C', 'edad__0': 17, 'sexo__0': 'F', 'ini_sin__0': '2020-07-16', 'per_etn__0': 6, 'sem_ges__0': '          ', 'gp_desmovi__0': 2, 'confirmados__0': 1, 'cod_mun_n__0': 25899, 'ocupacion__0': 9998, 'gp_discapa__0': 2, 'pac_hos__0': 1, 'cod_mun_o__0': 307, 'ajuste__0': 0, 'fec_not__0': '2020-07-19', 'cod_dpto_o__0': 25, 'con_fin__0': 2, 'departamento_notificacion__0': 'CUNDINAMARCA', 'consecutive_12__0': 0, 'gp_psiquia__0': 2, 'cod_eve__0': 550, 'ano__0': 2020, 'nacionalidad__0': 170, 'departamento_residencia__0': 'TOLIMA', 'gp_pobicfb__0': 2, 'gru_pob__0': None, 'cod_dpto_r__0': 73, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_ase__0': 'EPS037', 'area__0': 1, 'gp_migrant__0': 2, 'cod_mun_r__0': 275, 'gp_desplaz__0': 2, 'gp_mad_com__0': 2, 'municipio_ocurrencia__0': 'GIRARDOT', 'nom_grupo__0': '                                                                                                    ', 'va_sispro__0': 1 ... 32531 parameters truncated ... 'gp_discapa__446': 2, 'pac_hos__446': 1, 'cod_mun_o__446': 1, 'ajuste__446': 7, 'fec_not__446': '2020-07-17', 'cod_dpto_o__446': 18, 'con_fin__446': 2, 'departamento_notificacion__446': 'CAQUETA', 'consecutive_12__446': 0, 'gp_psiquia__446': 2, 'cod_eve__446': 550, 'ano__446': 2020, 'nacionalidad__446': 170, 'departamento_residencia__446': 'CAQUETA', 'gp_pobicfb__446': 2, 'gru_pob__446': None, 'cod_dpto_r__446': 18, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'cod_ase__446': 'EPSS16', 'area__446': 1, 'gp_migrant__446': 2, 'cod_mun_r__446': 1, 'gp_desplaz__446': 2, 'gp_mad_com__446': 2, 'municipio_ocurrencia__446': 'FLORENCIA', 'nom_grupo__446': '                                                                                                    ', 'va_sispro__446': 1, 'fm_grado__446': None, 'departamento_ocurrencia__446': 'CAQUETA', 'gp_gestan__446': 2, 'pais_residencia__446': 'COLOMBIA', 'fec_aju__446': '2020-08-10', 'cbmte__446': 'J189', 'fuente__446': 1, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'fec_con__446': '2020-07-14', 'nom_upgd__446': 'CLINIA MEDILASER SA', 'fm_fuerza__446': None, 'fm_unidad__446': None, 'gp_vic_vio__446': 2, 'uni_med__446': 1, 'municipio_notificacion__446': 'FLORENCIA', 'cod_pais_r__446': 170, 'fecha_nto__446': '1987-03-13', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'cod_sub__446': 1, 'estrato__446': '2         ', 'cod_pais_o__446': 170, 'tip_cas__446': 4, 'gp_otros__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'estado_final_de_caso__0': 4, 'gp_carcela__0': 2, 'cer_def__0': 722298969.0, 'fec_hos__0': '2020-07-17', 'cod_dpto_n__0': 25, 'cod_pre__0': 2589902990, 'fec_arc_xl__0': '2020-07-22', 'consecutive_origen__0': 25, 'gp_indigen__0': 2, 'municipio_residencia__0': 'FLANDES', 'fec_def__0': '2020-07-18', 'semana__0': 29, 'pais_ocurrencia__0': 'COLOMBIA', 'tip_ss__0': 'C', 'edad__0': 17, 'sexo__0': 'F', 'ini_sin__0': '2020-07-16', 'per_etn__0': 6, 'sem_ges__0': '          ', 'gp_desmovi__0': 2, 'confirmados__0': 1, 'cod_mun_n__0': 25899, 'ocupacion__0': 9998, 'gp_discapa__0': 2, 'pac_hos__0': 1, 'cod_mun_o__0': 307, 'ajuste__0': 0, 'fec_not__0': '2020-07-19', 'cod_dpto_o__0': 25, 'con_fin__0': 2, 'departamento_notificacion__0': 'CUNDINAMARCA', 'consecutive_12__0': 0, 'gp_psiquia__0': 2, 'cod_eve__0': 550, 'ano__0': 2020, 'nacionalidad__0': 170, 'departamento_residencia__0': 'TOLIMA', 'gp_pobicfb__0': 2, 'gru_pob__0': None, 'cod_dpto_r__0': 73, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_ase__0': 'EPS037', 'area__0': 1, 'gp_migrant__0': 2, 'cod_mun_r__0': 275, 'gp_desplaz__0': 2, 'gp_mad_com__0': 2, 'municipio_ocurrencia__0': 'GIRARDOT', 'nom_grupo__0': '                                                                                                    ', 'va_sispro__0': 1 ... 32531 parameters truncated ... 'gp_discapa__446': 2, 'pac_hos__446': 1, 'cod_mun_o__446': 1, 'ajuste__446': 7, 'fec_not__446': '2020-07-17', 'cod_dpto_o__446': 18, 'con_fin__446': 2, 'departamento_notificacion__446': 'CAQUETA', 'consecutive_12__446': 0, 'gp_psiquia__446': 2, 'cod_eve__446': 550, 'ano__446': 2020, 'nacionalidad__446': 170, 'departamento_residencia__446': 'CAQUETA', 'gp_pobicfb__446': 2, 'gru_pob__446': None, 'cod_dpto_r__446': 18, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'cod_ase__446': 'EPSS16', 'area__446': 1, 'gp_migrant__446': 2, 'cod_mun_r__446': 1, 'gp_desplaz__446': 2, 'gp_mad_com__446': 2, 'municipio_ocurrencia__446': 'FLORENCIA', 'nom_grupo__446': '                                                                                                    ', 'va_sispro__446': 1, 'fm_grado__446': None, 'departamento_ocurrencia__446': 'CAQUETA', 'gp_gestan__446': 2, 'pais_residencia__446': 'COLOMBIA', 'fec_aju__446': '2020-08-10', 'cbmte__446': 'J189', 'fuente__446': 1, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'fec_con__446': '2020-07-14', 'nom_upgd__446': 'CLINIA MEDILASER SA', 'fm_fuerza__446': None, 'fm_unidad__446': None, 'gp_vic_vio__446': 2, 'uni_med__446': 1, 'municipio_notificacion__446': 'FLORENCIA', 'cod_pais_r__446': 170, 'fecha_nto__446': '1987-03-13', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'cod_sub__446': 1, 'estrato__446': '2         ', 'cod_pais_o__446': 170, 'tip_cas__446': 4, 'gp_otros__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 19:30:46 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 19:30:46 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 19:31:42 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 19:31:42 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 19:31:43 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 19:31:44 | ERROR | etl.loader | Error al cargar datos en staging_table: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_pais_o__0': 170, 'estrato__0': '2         ', 'gp_psiquia__0': 2, 'ajuste__0': 0, 'cod_sub__0': 20, 'tip_cas__0': 4, 'gp_otros__0': 1, 'municipio_ocurrencia__0': 'GIRARDOT', 'area__0': 1, 'cod_ase__0': 'EPS037', 'sexo__0': 'F', 'va_sispro__0': 1, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'ini_sin__0': '2020-07-16', 'fec_aju__0': '2020-07-19', 'pais_residencia__0': 'COLOMBIA', 'tip_ss__0': 'C', 'edad__0': 17, 'cer_def__0': 722298969.0, 'semana__0': 29, 'consecutive_origen__0': 25, 'gp_mad_com__0': 2, 'con_fin__0': 2, 'fuente__0': 1, 'cod_dpto_r__0': 73, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_residencia__0': 'TOLIMA', 'departamento_notificacion__0': 'CUNDINAMARCA', 'ocupacion__0': 9998, 'cod_dpto_n__0': 25, 'fec_arc_xl__0': '2020-07-22', 'fec_def__0': '2020-07-18', 'fm_grado__0': None, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'consecutive_12__0': 0, 'ano__0': 2020, 'gp_discapa__0': 2, 'fec_not__0': '2020-07-19', 'gp_indigen__0': 2, 'municipio_notificacion__0': 'ZIPAQUIRA', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'gru_pob__0': None, 'sem_ges__0': '          ', 'cod_eve__0': 550, 'gp_pobicfb__0': 2, 'fec_con__0': '2020-07-16', 'cbmte__0': '9999', 'gp_desmovi__0': 2, 'cod_dpto_o__0': 25, 'fm_fuerza__0': None ... 32531 parameters truncated ... 'fuente__446': 1, 'cod_dpto_r__446': 18, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'departamento_residencia__446': 'CAQUETA', 'departamento_notificacion__446': 'CAQUETA', 'ocupacion__446': 9996, 'cod_dpto_n__446': 18, 'fec_arc_xl__446': '2020-07-22', 'fec_def__446': '2020-07-17', 'fm_grado__446': None, 'departamento_ocurrencia__446': 'CAQUETA', 'consecutive_12__446': 0, 'ano__446': 2020, 'gp_discapa__446': 2, 'fec_not__446': '2020-07-17', 'gp_indigen__446': 2, 'municipio_notificacion__446': 'FLORENCIA', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'gru_pob__446': None, 'sem_ges__446': '          ', 'cod_eve__446': 550, 'gp_pobicfb__446': 2, 'fec_con__446': '2020-07-14', 'cbmte__446': 'J189', 'gp_desmovi__446': 2, 'cod_dpto_o__446': 18, 'fm_fuerza__446': None, 'pais_ocurrencia__446': 'COLOMBIA', 'nom_upgd__446': 'CLINIA MEDILASER SA', 'municipio_residencia__446': 'FLORENCIA', 'gp_carcela__446': 2, 'gp_gestan__446': 2, 'nom_grupo__446': '                                                                                                    ', 'cod_pais_r__446': 170, 'fm_unidad__446': None, 'cod_mun_r__446': 1, 'fecha_nto__446': '1987-03-13', 'per_etn__446': 6, 'pac_hos__446': 1, 'estado_final_de_caso__446': 4, 'fec_hos__446': '2020-07-14', 'cod_mun_n__446': 18001, 'nacionalidad__446': 170, 'gp_migrant__446': 2, 'cod_pre__446': 1800107466, 'confirmados__446': 1, 'cod_mun_o__446': 1, 'gp_vic_vio__446': 2, 'gp_desplaz__446': 2, 'uni_med__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_pais_o__0': 170, 'estrato__0': '2         ', 'gp_psiquia__0': 2, 'ajuste__0': 0, 'cod_sub__0': 20, 'tip_cas__0': 4, 'gp_otros__0': 1, 'municipio_ocurrencia__0': 'GIRARDOT', 'area__0': 1, 'cod_ase__0': 'EPS037', 'sexo__0': 'F', 'va_sispro__0': 1, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'ini_sin__0': '2020-07-16', 'fec_aju__0': '2020-07-19', 'pais_residencia__0': 'COLOMBIA', 'tip_ss__0': 'C', 'edad__0': 17, 'cer_def__0': 722298969.0, 'semana__0': 29, 'consecutive_origen__0': 25, 'gp_mad_com__0': 2, 'con_fin__0': 2, 'fuente__0': 1, 'cod_dpto_r__0': 73, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_residencia__0': 'TOLIMA', 'departamento_notificacion__0': 'CUNDINAMARCA', 'ocupacion__0': 9998, 'cod_dpto_n__0': 25, 'fec_arc_xl__0': '2020-07-22', 'fec_def__0': '2020-07-18', 'fm_grado__0': None, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'consecutive_12__0': 0, 'ano__0': 2020, 'gp_discapa__0': 2, 'fec_not__0': '2020-07-19', 'gp_indigen__0': 2, 'municipio_notificacion__0': 'ZIPAQUIRA', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'gru_pob__0': None, 'sem_ges__0': '          ', 'cod_eve__0': 550, 'gp_pobicfb__0': 2, 'fec_con__0': '2020-07-16', 'cbmte__0': '9999', 'gp_desmovi__0': 2, 'cod_dpto_o__0': 25, 'fm_fuerza__0': None ... 32531 parameters truncated ... 'fuente__446': 1, 'cod_dpto_r__446': 18, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'departamento_residencia__446': 'CAQUETA', 'departamento_notificacion__446': 'CAQUETA', 'ocupacion__446': 9996, 'cod_dpto_n__446': 18, 'fec_arc_xl__446': '2020-07-22', 'fec_def__446': '2020-07-17', 'fm_grado__446': None, 'departamento_ocurrencia__446': 'CAQUETA', 'consecutive_12__446': 0, 'ano__446': 2020, 'gp_discapa__446': 2, 'fec_not__446': '2020-07-17', 'gp_indigen__446': 2, 'municipio_notificacion__446': 'FLORENCIA', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'gru_pob__446': None, 'sem_ges__446': '          ', 'cod_eve__446': 550, 'gp_pobicfb__446': 2, 'fec_con__446': '2020-07-14', 'cbmte__446': 'J189', 'gp_desmovi__446': 2, 'cod_dpto_o__446': 18, 'fm_fuerza__446': None, 'pais_ocurrencia__446': 'COLOMBIA', 'nom_upgd__446': 'CLINIA MEDILASER SA', 'municipio_residencia__446': 'FLORENCIA', 'gp_carcela__446': 2, 'gp_gestan__446': 2, 'nom_grupo__446': '                                                                                                    ', 'cod_pais_r__446': 170, 'fm_unidad__446': None, 'cod_mun_r__446': 1, 'fecha_nto__446': '1987-03-13', 'per_etn__446': 6, 'pac_hos__446': 1, 'estado_final_de_caso__446': 4, 'fec_hos__446': '2020-07-14', 'cod_mun_n__446': 18001, 'nacionalidad__446': 170, 'gp_migrant__446': 2, 'cod_pre__446': 1800107466, 'confirmados__446': 1, 'cod_mun_o__446': 1, 'gp_vic_vio__446': 2, 'gp_desplaz__446': 2, 'uni_med__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 19:31:44 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 19:31:44 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 19:46:43 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 19:46:43 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 19:46:43 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-19 19:46:43 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 19:47:15 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 19:47:15 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 19:47:16 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 19:47:17 | ERROR | etl.loader | Error al cargar datos en staging_table: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'va_sispro__0': 1, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'nacionalidad__0': 170, 'gp_desplaz__0': 2, 'ano__0': 2020, 'gp_desmovi__0': 2, 'estrato__0': '2         ', 'gp_gestan__0': 2, 'gru_pob__0': None, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'gp_mad_com__0': 2, 'fec_def__0': '2020-07-18', 'uni_med__0': 1, 'fm_unidad__0': None, 'cod_pre__0': 2589902990, 'gp_otros__0': 1, 'cod_ase__0': 'EPS037', 'fuente__0': 1, 'fm_grado__0': None, 'gp_psiquia__0': 2, 'ajuste__0': 0, 'municipio_notificacion__0': 'ZIPAQUIRA', 'cod_mun_n__0': 25899, 'fecha_nto__0': '2003-01-08', 'cod_pais_r__0': 170, 'consecutive_origen__0': 25, 'fec_aju__0': '2020-07-19', 'municipio_ocurrencia__0': 'GIRARDOT', 'estado_final_de_caso__0': 4, 'fec_con__0': '2020-07-16', 'fm_fuerza__0': None, 'gp_carcela__0': 2, 'departamento_notificacion__0': 'CUNDINAMARCA', 'cod_eve__0': 550, 'cod_dpto_o__0': 25, 'gp_discapa__0': 2, 'pac_hos__0': 1, 'fec_hos__0': '2020-07-17', 'confirmados__0': 1, 'cod_mun_o__0': 307, 'cer_def__0': 722298969.0, 'consecutive_12__0': 0, 'municipio_residencia__0': 'FLANDES', 'edad__0': 17, 'sexo__0': 'F', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cbmte__0': '9999', 'sem_ges__0': '          ', 'cod_sub__0': 20, 'cod_dpto_n__0': 25 ... 32531 parameters truncated ... 'fecha_nto__446': '1987-03-13', 'cod_pais_r__446': 170, 'consecutive_origen__446': 444, 'fec_aju__446': '2020-08-10', 'municipio_ocurrencia__446': 'FLORENCIA', 'estado_final_de_caso__446': 4, 'fec_con__446': '2020-07-14', 'fm_fuerza__446': None, 'gp_carcela__446': 2, 'departamento_notificacion__446': 'CAQUETA', 'cod_eve__446': 550, 'cod_dpto_o__446': 18, 'gp_discapa__446': 2, 'pac_hos__446': 1, 'fec_hos__446': '2020-07-14', 'confirmados__446': 1, 'cod_mun_o__446': 1, 'cer_def__446': 720399987.0, 'consecutive_12__446': 0, 'municipio_residencia__446': 'FLORENCIA', 'edad__446': 33, 'sexo__446': 'F', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'cbmte__446': 'J189', 'sem_ges__446': '          ', 'cod_sub__446': 1, 'cod_dpto_n__446': 18, 'fec_not__446': '2020-07-17', 'cod_pais_o__446': 170, 'area__446': 1, 'tip_ss__446': 'S', 'gp_pobicfb__446': 2, 'ini_sin__446': '2020-07-04', 'cod_mun_r__446': 1, 'tip_cas__446': 4, 'con_fin__446': 2, 'nom_grupo__446': '                                                                                                    ', 'ocupacion__446': 9996, 'fec_arc_xl__446': '2020-07-22', 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'departamento_ocurrencia__446': 'CAQUETA', 'departamento_residencia__446': 'CAQUETA', 'gp_indigen__446': 2, 'per_etn__446': 6, 'pais_residencia__446': 'COLOMBIA', 'semana__446': 29, 'cod_dpto_r__446': 18, 'gp_migrant__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'gp_vic_vio__446': 2}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'va_sispro__0': 1, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'nacionalidad__0': 170, 'gp_desplaz__0': 2, 'ano__0': 2020, 'gp_desmovi__0': 2, 'estrato__0': '2         ', 'gp_gestan__0': 2, 'gru_pob__0': None, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'gp_mad_com__0': 2, 'fec_def__0': '2020-07-18', 'uni_med__0': 1, 'fm_unidad__0': None, 'cod_pre__0': 2589902990, 'gp_otros__0': 1, 'cod_ase__0': 'EPS037', 'fuente__0': 1, 'fm_grado__0': None, 'gp_psiquia__0': 2, 'ajuste__0': 0, 'municipio_notificacion__0': 'ZIPAQUIRA', 'cod_mun_n__0': 25899, 'fecha_nto__0': '2003-01-08', 'cod_pais_r__0': 170, 'consecutive_origen__0': 25, 'fec_aju__0': '2020-07-19', 'municipio_ocurrencia__0': 'GIRARDOT', 'estado_final_de_caso__0': 4, 'fec_con__0': '2020-07-16', 'fm_fuerza__0': None, 'gp_carcela__0': 2, 'departamento_notificacion__0': 'CUNDINAMARCA', 'cod_eve__0': 550, 'cod_dpto_o__0': 25, 'gp_discapa__0': 2, 'pac_hos__0': 1, 'fec_hos__0': '2020-07-17', 'confirmados__0': 1, 'cod_mun_o__0': 307, 'cer_def__0': 722298969.0, 'consecutive_12__0': 0, 'municipio_residencia__0': 'FLANDES', 'edad__0': 17, 'sexo__0': 'F', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cbmte__0': '9999', 'sem_ges__0': '          ', 'cod_sub__0': 20, 'cod_dpto_n__0': 25 ... 32531 parameters truncated ... 'fecha_nto__446': '1987-03-13', 'cod_pais_r__446': 170, 'consecutive_origen__446': 444, 'fec_aju__446': '2020-08-10', 'municipio_ocurrencia__446': 'FLORENCIA', 'estado_final_de_caso__446': 4, 'fec_con__446': '2020-07-14', 'fm_fuerza__446': None, 'gp_carcela__446': 2, 'departamento_notificacion__446': 'CAQUETA', 'cod_eve__446': 550, 'cod_dpto_o__446': 18, 'gp_discapa__446': 2, 'pac_hos__446': 1, 'fec_hos__446': '2020-07-14', 'confirmados__446': 1, 'cod_mun_o__446': 1, 'cer_def__446': 720399987.0, 'consecutive_12__446': 0, 'municipio_residencia__446': 'FLORENCIA', 'edad__446': 33, 'sexo__446': 'F', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'cbmte__446': 'J189', 'sem_ges__446': '          ', 'cod_sub__446': 1, 'cod_dpto_n__446': 18, 'fec_not__446': '2020-07-17', 'cod_pais_o__446': 170, 'area__446': 1, 'tip_ss__446': 'S', 'gp_pobicfb__446': 2, 'ini_sin__446': '2020-07-04', 'cod_mun_r__446': 1, 'tip_cas__446': 4, 'con_fin__446': 2, 'nom_grupo__446': '                                                                                                    ', 'ocupacion__446': 9996, 'fec_arc_xl__446': '2020-07-22', 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'departamento_ocurrencia__446': 'CAQUETA', 'departamento_residencia__446': 'CAQUETA', 'gp_indigen__446': 2, 'per_etn__446': 6, 'pais_residencia__446': 'COLOMBIA', 'semana__446': 29, 'cod_dpto_r__446': 18, 'gp_migrant__446': 2, 'pais_ocurrencia__446': 'COLOMBIA', 'gp_vic_vio__446': 2}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 19:47:17 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 19:47:17 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 19:55:58 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 19:55:58 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 19:55:59 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 19:55:59 | ERROR | etl.loader | Error al cargar datos en staging_table: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_ss__0': 'C', 'gp_desplaz__0': 2, 'cod_dpto_o__0': 25, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'pac_hos__0': 1, 'fec_hos__0': '2020-07-17', 'cod_mun_r__0': 275, 'fecha_nto__0': '2003-01-08', 'cbmte__0': '9999', 'municipio_residencia__0': 'FLANDES', 'estrato__0': '2         ', 'cod_pais_r__0': 170, 'cod_mun_n__0': 25899, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'confirmados__0': 1, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'gp_gestan__0': 2, 'ajuste__0': 0, 'gp_carcela__0': 2, 'tip_cas__0': 4, 'pais_ocurrencia__0': 'COLOMBIA', 'cod_dpto_r__0': 73, 'gp_desmovi__0': 2, 'ini_sin__0': '2020-07-16', 'gp_indigen__0': 2, 'uni_med__0': 1, 'gp_psiquia__0': 2, 'cod_sub__0': 20, 'gp_discapa__0': 2, 'cod_eve__0': 550, 'departamento_notificacion__0': 'CUNDINAMARCA', 'sexo__0': 'F', 'gp_pobicfb__0': 2, 'fuente__0': 1, 'fm_grado__0': None, 'ocupacion__0': 9998, 'area__0': 1, 'cod_mun_o__0': 307, 'gp_vic_vio__0': 2, 'fm_fuerza__0': None, 'ano__0': 2020, 'consecutive_origen__0': 25, 'semana__0': 29, 'con_fin__0': 2, 'per_etn__0': 6, 'va_sispro__0': 1, 'cod_pais_o__0': 170, 'fm_unidad__0': None, 'fec_not__0': '2020-07-19', 'cer_def__0': 722298969.0 ... 32531 parameters truncated ... 'ini_sin__446': '2020-07-04', 'gp_indigen__446': 2, 'uni_med__446': 1, 'gp_psiquia__446': 2, 'cod_sub__446': 1, 'gp_discapa__446': 2, 'cod_eve__446': 550, 'departamento_notificacion__446': 'CAQUETA', 'sexo__446': 'F', 'gp_pobicfb__446': 2, 'fuente__446': 1, 'fm_grado__446': None, 'ocupacion__446': 9996, 'area__446': 1, 'cod_mun_o__446': 1, 'gp_vic_vio__446': 2, 'fm_fuerza__446': None, 'ano__446': 2020, 'consecutive_origen__446': 444, 'semana__446': 29, 'con_fin__446': 2, 'per_etn__446': 6, 'va_sispro__446': 1, 'cod_pais_o__446': 170, 'fm_unidad__446': None, 'fec_not__446': '2020-07-17', 'cer_def__446': 720399987.0, 'gru_pob__446': None, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'nom_grupo__446': '                                                                                                    ', 'gp_mad_com__446': 2, 'gp_otros__446': 1, 'fec_con__446': '2020-07-14', 'fec_aju__446': '2020-08-10', 'departamento_ocurrencia__446': 'CAQUETA', 'departamento_residencia__446': 'CAQUETA', 'cod_dpto_n__446': 18, 'municipio_notificacion__446': 'FLORENCIA', 'fec_arc_xl__446': '2020-07-22', 'gp_migrant__446': 2, 'consecutive_12__446': 0, 'edad__446': 33, 'nacionalidad__446': 170, 'municipio_ocurrencia__446': 'FLORENCIA', 'fec_def__446': '2020-07-17', 'pais_residencia__446': 'COLOMBIA', 'cod_pre__446': 1800107466, 'estado_final_de_caso__446': 4, 'sem_ges__446': '          ', 'cod_ase__446': 'EPSS16'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_ss__0': 'C', 'gp_desplaz__0': 2, 'cod_dpto_o__0': 25, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'pac_hos__0': 1, 'fec_hos__0': '2020-07-17', 'cod_mun_r__0': 275, 'fecha_nto__0': '2003-01-08', 'cbmte__0': '9999', 'municipio_residencia__0': 'FLANDES', 'estrato__0': '2         ', 'cod_pais_r__0': 170, 'cod_mun_n__0': 25899, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'confirmados__0': 1, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'gp_gestan__0': 2, 'ajuste__0': 0, 'gp_carcela__0': 2, 'tip_cas__0': 4, 'pais_ocurrencia__0': 'COLOMBIA', 'cod_dpto_r__0': 73, 'gp_desmovi__0': 2, 'ini_sin__0': '2020-07-16', 'gp_indigen__0': 2, 'uni_med__0': 1, 'gp_psiquia__0': 2, 'cod_sub__0': 20, 'gp_discapa__0': 2, 'cod_eve__0': 550, 'departamento_notificacion__0': 'CUNDINAMARCA', 'sexo__0': 'F', 'gp_pobicfb__0': 2, 'fuente__0': 1, 'fm_grado__0': None, 'ocupacion__0': 9998, 'area__0': 1, 'cod_mun_o__0': 307, 'gp_vic_vio__0': 2, 'fm_fuerza__0': None, 'ano__0': 2020, 'consecutive_origen__0': 25, 'semana__0': 29, 'con_fin__0': 2, 'per_etn__0': 6, 'va_sispro__0': 1, 'cod_pais_o__0': 170, 'fm_unidad__0': None, 'fec_not__0': '2020-07-19', 'cer_def__0': 722298969.0 ... 32531 parameters truncated ... 'ini_sin__446': '2020-07-04', 'gp_indigen__446': 2, 'uni_med__446': 1, 'gp_psiquia__446': 2, 'cod_sub__446': 1, 'gp_discapa__446': 2, 'cod_eve__446': 550, 'departamento_notificacion__446': 'CAQUETA', 'sexo__446': 'F', 'gp_pobicfb__446': 2, 'fuente__446': 1, 'fm_grado__446': None, 'ocupacion__446': 9996, 'area__446': 1, 'cod_mun_o__446': 1, 'gp_vic_vio__446': 2, 'fm_fuerza__446': None, 'ano__446': 2020, 'consecutive_origen__446': 444, 'semana__446': 29, 'con_fin__446': 2, 'per_etn__446': 6, 'va_sispro__446': 1, 'cod_pais_o__446': 170, 'fm_unidad__446': None, 'fec_not__446': '2020-07-17', 'cer_def__446': 720399987.0, 'gru_pob__446': None, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'nom_grupo__446': '                                                                                                    ', 'gp_mad_com__446': 2, 'gp_otros__446': 1, 'fec_con__446': '2020-07-14', 'fec_aju__446': '2020-08-10', 'departamento_ocurrencia__446': 'CAQUETA', 'departamento_residencia__446': 'CAQUETA', 'cod_dpto_n__446': 18, 'municipio_notificacion__446': 'FLORENCIA', 'fec_arc_xl__446': '2020-07-22', 'gp_migrant__446': 2, 'consecutive_12__446': 0, 'edad__446': 33, 'nacionalidad__446': 170, 'municipio_ocurrencia__446': 'FLORENCIA', 'fec_def__446': '2020-07-17', 'pais_residencia__446': 'COLOMBIA', 'cod_pre__446': 1800107466, 'estado_final_de_caso__446': 4, 'sem_ges__446': '          ', 'cod_ase__446': 'EPSS16'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 19:55:59 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 19:55:59 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 20:00:17 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 20:00:17 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 20:00:18 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-19 20:00:18 | INFO | etl.loader | Cargado DataFrame a tabla staging_table (550 filas)
2025-09-19 20:00:18 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-19 20:00:18 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 20:47:04 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 20:47:04 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 20:47:04 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-19 20:47:04 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 20:48:34 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 20:48:34 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 20:48:35 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 20:48:35 | ERROR | etl.loader | Error al cargar datos en staging_table: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'sem_ges__0': '          ', 'cer_def__0': 722298969.0, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'fec_def__0': '2020-07-18', 'ajuste__0': 0, 'cod_mun_o__0': 307, 'cod_pre__0': 2589902990, 'ano__0': 2020, 'fec_not__0': '2020-07-19', 'gp_desmovi__0': 2, 'edad__0': 17, 'cod_dpto_o__0': 25, 'fec_aju__0': '2020-07-19', 'confirmados__0': 1, 'pais_residencia__0': 'COLOMBIA', 'fec_hos__0': '2020-07-17', 'fm_fuerza__0': None, 'departamento_notificacion__0': 'CUNDINAMARCA', 'municipio_notificacion__0': 'ZIPAQUIRA', 'gp_discapa__0': 2, 'gp_gestan__0': 2, 'gp_carcela__0': 2, 'gp_pobicfb__0': 2, 'nacionalidad__0': 170, 'gp_desplaz__0': 2, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_residencia__0': 'TOLIMA', 'gp_indigen__0': 2, 'sexo__0': 'F', 'semana__0': 29, 'fm_grado__0': None, 'cod_mun_n__0': 25899, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'tip_ss__0': 'C', 'fec_arc_xl__0': '2020-07-22', 'cod_ase__0': 'EPS037', 'nom_grupo__0': '                                                                                                    ', 'cod_pais_o__0': 170, 'cod_pais_r__0': 170, 'cod_mun_r__0': 275, 'municipio_residencia__0': 'FLANDES', 'cod_dpto_r__0': 73, 'fec_con__0': '2020-07-16', 'municipio_ocurrencia__0': 'GIRARDOT', 'gp_mad_com__0': 2, 'tip_cas__0': 4, 'ini_sin__0': '2020-07-16', 'pais_ocurrencia__0': 'COLOMBIA', 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'va_sispro__0': 1 ... 32531 parameters truncated ... 'nacionalidad__446': 170, 'gp_desplaz__446': 2, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'departamento_residencia__446': 'CAQUETA', 'gp_indigen__446': 2, 'sexo__446': 'F', 'semana__446': 29, 'fm_grado__446': None, 'cod_mun_n__446': 18001, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'tip_ss__446': 'S', 'fec_arc_xl__446': '2020-07-22', 'cod_ase__446': 'EPSS16', 'nom_grupo__446': '                                                                                                    ', 'cod_pais_o__446': 170, 'cod_pais_r__446': 170, 'cod_mun_r__446': 1, 'municipio_residencia__446': 'FLORENCIA', 'cod_dpto_r__446': 18, 'fec_con__446': '2020-07-14', 'municipio_ocurrencia__446': 'FLORENCIA', 'gp_mad_com__446': 2, 'tip_cas__446': 4, 'ini_sin__446': '2020-07-04', 'pais_ocurrencia__446': 'COLOMBIA', 'nom_upgd__446': 'CLINIA MEDILASER SA', 'va_sispro__446': 1, 'cod_dpto_n__446': 18, 'consecutive_origen__446': 444, 'gp_migrant__446': 2, 'gp_otros__446': 1, 'fuente__446': 1, 'fm_unidad__446': None, 'gru_pob__446': None, 'estado_final_de_caso__446': 4, 'pac_hos__446': 1, 'ocupacion__446': 9996, 'gp_psiquia__446': 2, 'uni_med__446': 1, 'con_fin__446': 2, 'cod_sub__446': 1, 'per_etn__446': 6, 'estrato__446': '2         ', 'cbmte__446': 'J189', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'cod_eve__446': 550, 'gp_vic_vio__446': 2, 'area__446': 1, 'consecutive_12__446': 0, 'fecha_nto__446': '1987-03-13'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo double precision: Â«COLOMBIAÂ»
LINE 1: ...'MORTALIDAD MATERNA', 'CUNDINAMARCA', 'GIRARDOT', 'COLOMBIA'...
                                                             ^

[SQL: INSERT INTO staging_table (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_discapa, ... 680913 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'sem_ges__0': '          ', 'cer_def__0': 722298969.0, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'fec_def__0': '2020-07-18', 'ajuste__0': 0, 'cod_mun_o__0': 307, 'cod_pre__0': 2589902990, 'ano__0': 2020, 'fec_not__0': '2020-07-19', 'gp_desmovi__0': 2, 'edad__0': 17, 'cod_dpto_o__0': 25, 'fec_aju__0': '2020-07-19', 'confirmados__0': 1, 'pais_residencia__0': 'COLOMBIA', 'fec_hos__0': '2020-07-17', 'fm_fuerza__0': None, 'departamento_notificacion__0': 'CUNDINAMARCA', 'municipio_notificacion__0': 'ZIPAQUIRA', 'gp_discapa__0': 2, 'gp_gestan__0': 2, 'gp_carcela__0': 2, 'gp_pobicfb__0': 2, 'nacionalidad__0': 170, 'gp_desplaz__0': 2, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'departamento_residencia__0': 'TOLIMA', 'gp_indigen__0': 2, 'sexo__0': 'F', 'semana__0': 29, 'fm_grado__0': None, 'cod_mun_n__0': 25899, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'tip_ss__0': 'C', 'fec_arc_xl__0': '2020-07-22', 'cod_ase__0': 'EPS037', 'nom_grupo__0': '                                                                                                    ', 'cod_pais_o__0': 170, 'cod_pais_r__0': 170, 'cod_mun_r__0': 275, 'municipio_residencia__0': 'FLANDES', 'cod_dpto_r__0': 73, 'fec_con__0': '2020-07-16', 'municipio_ocurrencia__0': 'GIRARDOT', 'gp_mad_com__0': 2, 'tip_cas__0': 4, 'ini_sin__0': '2020-07-16', 'pais_ocurrencia__0': 'COLOMBIA', 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'va_sispro__0': 1 ... 32531 parameters truncated ... 'nacionalidad__446': 170, 'gp_desplaz__446': 2, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'departamento_residencia__446': 'CAQUETA', 'gp_indigen__446': 2, 'sexo__446': 'F', 'semana__446': 29, 'fm_grado__446': None, 'cod_mun_n__446': 18001, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'tip_ss__446': 'S', 'fec_arc_xl__446': '2020-07-22', 'cod_ase__446': 'EPSS16', 'nom_grupo__446': '                                                                                                    ', 'cod_pais_o__446': 170, 'cod_pais_r__446': 170, 'cod_mun_r__446': 1, 'municipio_residencia__446': 'FLORENCIA', 'cod_dpto_r__446': 18, 'fec_con__446': '2020-07-14', 'municipio_ocurrencia__446': 'FLORENCIA', 'gp_mad_com__446': 2, 'tip_cas__446': 4, 'ini_sin__446': '2020-07-04', 'pais_ocurrencia__446': 'COLOMBIA', 'nom_upgd__446': 'CLINIA MEDILASER SA', 'va_sispro__446': 1, 'cod_dpto_n__446': 18, 'consecutive_origen__446': 444, 'gp_migrant__446': 2, 'gp_otros__446': 1, 'fuente__446': 1, 'fm_unidad__446': None, 'gru_pob__446': None, 'estado_final_de_caso__446': 4, 'pac_hos__446': 1, 'ocupacion__446': 9996, 'gp_psiquia__446': 2, 'uni_med__446': 1, 'con_fin__446': 2, 'cod_sub__446': 1, 'per_etn__446': 6, 'estrato__446': '2         ', 'cbmte__446': 'J189', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'cod_eve__446': 550, 'gp_vic_vio__446': 2, 'area__446': 1, 'consecutive_12__446': 0, 'fecha_nto__446': '1987-03-13'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 20:48:35 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 20:48:35 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 21:56:47 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 21:56:47 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 21:56:47 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-19 21:56:47 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 21:57:12 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 21:57:12 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 21:57:15 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 21:57:16 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.UndefinedColumn) no existe la columna Â«cod_eveÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano,...
                                      ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_mun_n__0': 25899, 'gp_discapa__0': 2, 'nacionalidad__0': 170, 'estrato__0': '2         ', 'gru_pob__0': None, 'gp_carcela__0': 2, 'area__0': 1, 'departamento_residencia__0': 'TOLIMA', 'nom_grupo__0': '                                                                                                    ', 'cod_mun_o__0': 307, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'sexo__0': 'F', 'fec_arc_xl__0': '2020-07-22', 'edad__0': 17, 'cod_dpto_n__0': 25, 'fec_aju__0': '2020-07-19', 'municipio_ocurrencia__0': 'GIRARDOT', 'fecha_nto__0': '2003-01-08', 'consecutive_origen__0': 25, 'cod_eve__0': 550, 'gp_desplaz__0': 2, 'departamento_notificacion__0': 'CUNDINAMARCA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'fec_hos__0': '2020-07-17', 'gp_pobicfb__0': 2, 'cod_pre__0': 2589902990, 'sem_ges__0': '          ', 'semana__0': 29, 'pac_hos__0': 1, 'gp_vic_vio__0': 2, 'gp_desmovi__0': 2, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'gp_mad_com__0': 2, 'ini_sin__0': '2020-07-16', 'gp_gestan__0': 2, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'per_etn__0': 6, 'fm_unidad__0': None, 'va_sispro__0': 1, 'ocupacion__0': 9998, 'confirmados__0': 1, 'pais_ocurrencia__0': 'COLOMBIA', 'pais_residencia__0': 'COLOMBIA', 'tip_ss__0': 'C', 'uni_med__0': 1, 'cer_def__0': 722298969.0, 'fm_grado__0': None, 'fuente__0': 1, 'fec_con__0': '2020-07-16', 'fec_def__0': '2020-07-18' ... 32531 parameters truncated ... 'fec_hos__446': '2020-07-14', 'gp_pobicfb__446': 2, 'cod_pre__446': 1800107466, 'sem_ges__446': '          ', 'semana__446': 29, 'pac_hos__446': 1, 'gp_vic_vio__446': 2, 'gp_desmovi__446': 2, 'departamento_ocurrencia__446': 'CAQUETA', 'gp_mad_com__446': 2, 'ini_sin__446': '2020-07-04', 'gp_gestan__446': 2, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'per_etn__446': 6, 'fm_unidad__446': None, 'va_sispro__446': 1, 'ocupacion__446': 9996, 'confirmados__446': 1, 'pais_ocurrencia__446': 'COLOMBIA', 'pais_residencia__446': 'COLOMBIA', 'tip_ss__446': 'S', 'uni_med__446': 1, 'cer_def__446': 720399987.0, 'fm_grado__446': None, 'fuente__446': 1, 'fec_con__446': '2020-07-14', 'fec_def__446': '2020-07-17', 'ano__446': 2020, 'gp_otros__446': 1, 'cod_sub__446': 1, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'cod_mun_r__446': 1, 'cod_pais_o__446': 170, 'fm_fuerza__446': None, 'gp_migrant__446': 2, 'cod_dpto_o__446': 18, 'con_fin__446': 2, 'gp_psiquia__446': 2, 'municipio_notificacion__446': 'FLORENCIA', 'cbmte__446': 'J189', 'consecutive_12__446': 0, 'cod_pais_r__446': 170, 'estado_final_de_caso__446': 4, 'municipio_residencia__446': 'FLORENCIA', 'gp_indigen__446': 2, 'fec_not__446': '2020-07-17', 'cod_dpto_r__446': 18, 'tip_cas__446': 4, 'ajuste__446': 7, 'cod_ase__446': 'EPSS16'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedColumn: no existe la columna Â«cod_eveÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano,...
                                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) no existe la columna Â«cod_eveÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano,...
                                      ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_mun_n__0': 25899, 'gp_discapa__0': 2, 'nacionalidad__0': 170, 'estrato__0': '2         ', 'gru_pob__0': None, 'gp_carcela__0': 2, 'area__0': 1, 'departamento_residencia__0': 'TOLIMA', 'nom_grupo__0': '                                                                                                    ', 'cod_mun_o__0': 307, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'sexo__0': 'F', 'fec_arc_xl__0': '2020-07-22', 'edad__0': 17, 'cod_dpto_n__0': 25, 'fec_aju__0': '2020-07-19', 'municipio_ocurrencia__0': 'GIRARDOT', 'fecha_nto__0': '2003-01-08', 'consecutive_origen__0': 25, 'cod_eve__0': 550, 'gp_desplaz__0': 2, 'departamento_notificacion__0': 'CUNDINAMARCA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'fec_hos__0': '2020-07-17', 'gp_pobicfb__0': 2, 'cod_pre__0': 2589902990, 'sem_ges__0': '          ', 'semana__0': 29, 'pac_hos__0': 1, 'gp_vic_vio__0': 2, 'gp_desmovi__0': 2, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'gp_mad_com__0': 2, 'ini_sin__0': '2020-07-16', 'gp_gestan__0': 2, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'per_etn__0': 6, 'fm_unidad__0': None, 'va_sispro__0': 1, 'ocupacion__0': 9998, 'confirmados__0': 1, 'pais_ocurrencia__0': 'COLOMBIA', 'pais_residencia__0': 'COLOMBIA', 'tip_ss__0': 'C', 'uni_med__0': 1, 'cer_def__0': 722298969.0, 'fm_grado__0': None, 'fuente__0': 1, 'fec_con__0': '2020-07-16', 'fec_def__0': '2020-07-18' ... 32531 parameters truncated ... 'fec_hos__446': '2020-07-14', 'gp_pobicfb__446': 2, 'cod_pre__446': 1800107466, 'sem_ges__446': '          ', 'semana__446': 29, 'pac_hos__446': 1, 'gp_vic_vio__446': 2, 'gp_desmovi__446': 2, 'departamento_ocurrencia__446': 'CAQUETA', 'gp_mad_com__446': 2, 'ini_sin__446': '2020-07-04', 'gp_gestan__446': 2, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'per_etn__446': 6, 'fm_unidad__446': None, 'va_sispro__446': 1, 'ocupacion__446': 9996, 'confirmados__446': 1, 'pais_ocurrencia__446': 'COLOMBIA', 'pais_residencia__446': 'COLOMBIA', 'tip_ss__446': 'S', 'uni_med__446': 1, 'cer_def__446': 720399987.0, 'fm_grado__446': None, 'fuente__446': 1, 'fec_con__446': '2020-07-14', 'fec_def__446': '2020-07-17', 'ano__446': 2020, 'gp_otros__446': 1, 'cod_sub__446': 1, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'cod_mun_r__446': 1, 'cod_pais_o__446': 170, 'fm_fuerza__446': None, 'gp_migrant__446': 2, 'cod_dpto_o__446': 18, 'con_fin__446': 2, 'gp_psiquia__446': 2, 'municipio_notificacion__446': 'FLORENCIA', 'cbmte__446': 'J189', 'consecutive_12__446': 0, 'cod_pais_r__446': 170, 'estado_final_de_caso__446': 4, 'municipio_residencia__446': 'FLORENCIA', 'gp_indigen__446': 2, 'fec_not__446': '2020-07-17', 'cod_dpto_r__446': 18, 'tip_cas__446': 4, 'ajuste__446': 7, 'cod_ase__446': 'EPSS16'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-19 21:57:16 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 21:57:16 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 22:02:23 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 22:02:23 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 22:02:24 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-19 22:02:25 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.UndefinedColumn) no existe la columna Â«cod_eveÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano,...
                                      ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'ini_sin__0': '2023-07-19', 'fecha_nto__0': '1985-03-26', 'fec_aju__0': '2023-08-14', 'fec_arc_xl__0': '2023-07-21', 'gp_desmovi__0': 2, 'consecutive_12__0': 10417462, 'gp_carcela__0': 2, 'fec_hos__0': '2023-07-19', 'tip_ss__0': 'C', 'cod_dpto_r__0': 8, 'cod_dpto_n__0': 8, 'cod_dpto_o__0': 8, 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'cod_ase__0': 'EPS010', 'gp_migrant__0': 2, 'cer_def__0': 23074520316259, 'cod_pre__0': 800101106, 'tip_cas__0': 4, 'edad__0': 38, 'gp_desplaz__0': 2, 'ajuste__0': 7, 'per_etn__0': 6, 'consecutive_origen__0': 280, 'municipio_residencia__0': 'PALMAR DE VARELA', 'ano__0': 2023, 'fuente__0': 1, 'gp_gestan__0': 1, 'sexo__0': 'F', 'cod_pais_r__0': 170, 'cod_mun_o__0': 520, 'confirmados__0': 1, 'departamento_ocurrencia__0': 'ATLANTICO', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'estado_final_de_caso__0': 4, 'municipio_notificacion__0': 'BARRANQUILLA', 'va_sispro__0': 1, 'semana__0': 29, 'gru_pob__0': None, 'gp_pobicfb__0': 2, 'cod_sub__0': 1, 'gp_psiquia__0': 2, 'cod_mun_n__0': 8001, 'cbmte__0': 'O881', 'gp_indigen__0': 2, 'fm_unidad__0': None, 'fec_con__0': '2023-07-19', 'gp_otros__0': 2, 'gp_discapa__0': 2, 'gp_mad_com__0': 2, 'fm_grado__0': None ... 32531 parameters truncated ... 'municipio_residencia__446': 'VALLEDUPAR', 'ano__446': 2023, 'fuente__446': 4, 'gp_gestan__446': 2, 'sexo__446': 'F', 'cod_pais_r__446': 170, 'cod_mun_o__446': 1, 'confirmados__446': 1, 'departamento_ocurrencia__446': 'CESAR', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'estado_final_de_caso__446': 4, 'municipio_notificacion__446': 'VALLEDUPAR', 'va_sispro__446': 1, 'semana__446': 20, 'gru_pob__446': None, 'gp_pobicfb__446': 2, 'cod_sub__446': 1, 'gp_psiquia__446': 2, 'cod_mun_n__446': 20001, 'cbmte__446': 'C50X', 'gp_indigen__446': 2, 'fm_unidad__446': None, 'fec_con__446': '2023-05-10', 'gp_otros__446': 1, 'gp_discapa__446': 2, 'gp_mad_com__446': 2, 'fm_grado__446': None, 'fec_not__446': '2023-05-15', 'ocupacion__446': 99999.04, 'cod_eve__446': 550, 'pais_ocurrencia__446': 'COLOMBIA', 'uni_med__446': 1, 'fm_fuerza__446': None, 'area__446': 1, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'departamento_residencia__446': 'CESAR', 'estrato__446': '1         ', 'fec_def__446': '2023-05-15', 'pais_residencia__446': 'COLOMBIA', 'nom_grupo__446': '                                                                                                    ', 'nacionalidad__446': 170, 'sem_ges__446': '          ', 'municipio_ocurrencia__446': 'VALLEDUPAR', 'cod_pais_o__446': 170, 'cod_mun_r__446': 1, 'con_fin__446': 2, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'gp_vic_vio__446': 2, 'pac_hos__446': 2, 'departamento_notificacion__446': 'CESAR'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedColumn: no existe la columna Â«cod_eveÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano,...
                                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) no existe la columna Â«cod_eveÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano,...
                                      ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'ini_sin__0': '2023-07-19', 'fecha_nto__0': '1985-03-26', 'fec_aju__0': '2023-08-14', 'fec_arc_xl__0': '2023-07-21', 'gp_desmovi__0': 2, 'consecutive_12__0': 10417462, 'gp_carcela__0': 2, 'fec_hos__0': '2023-07-19', 'tip_ss__0': 'C', 'cod_dpto_r__0': 8, 'cod_dpto_n__0': 8, 'cod_dpto_o__0': 8, 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'cod_ase__0': 'EPS010', 'gp_migrant__0': 2, 'cer_def__0': 23074520316259, 'cod_pre__0': 800101106, 'tip_cas__0': 4, 'edad__0': 38, 'gp_desplaz__0': 2, 'ajuste__0': 7, 'per_etn__0': 6, 'consecutive_origen__0': 280, 'municipio_residencia__0': 'PALMAR DE VARELA', 'ano__0': 2023, 'fuente__0': 1, 'gp_gestan__0': 1, 'sexo__0': 'F', 'cod_pais_r__0': 170, 'cod_mun_o__0': 520, 'confirmados__0': 1, 'departamento_ocurrencia__0': 'ATLANTICO', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'estado_final_de_caso__0': 4, 'municipio_notificacion__0': 'BARRANQUILLA', 'va_sispro__0': 1, 'semana__0': 29, 'gru_pob__0': None, 'gp_pobicfb__0': 2, 'cod_sub__0': 1, 'gp_psiquia__0': 2, 'cod_mun_n__0': 8001, 'cbmte__0': 'O881', 'gp_indigen__0': 2, 'fm_unidad__0': None, 'fec_con__0': '2023-07-19', 'gp_otros__0': 2, 'gp_discapa__0': 2, 'gp_mad_com__0': 2, 'fm_grado__0': None ... 32531 parameters truncated ... 'municipio_residencia__446': 'VALLEDUPAR', 'ano__446': 2023, 'fuente__446': 4, 'gp_gestan__446': 2, 'sexo__446': 'F', 'cod_pais_r__446': 170, 'cod_mun_o__446': 1, 'confirmados__446': 1, 'departamento_ocurrencia__446': 'CESAR', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'estado_final_de_caso__446': 4, 'municipio_notificacion__446': 'VALLEDUPAR', 'va_sispro__446': 1, 'semana__446': 20, 'gru_pob__446': None, 'gp_pobicfb__446': 2, 'cod_sub__446': 1, 'gp_psiquia__446': 2, 'cod_mun_n__446': 20001, 'cbmte__446': 'C50X', 'gp_indigen__446': 2, 'fm_unidad__446': None, 'fec_con__446': '2023-05-10', 'gp_otros__446': 1, 'gp_discapa__446': 2, 'gp_mad_com__446': 2, 'fm_grado__446': None, 'fec_not__446': '2023-05-15', 'ocupacion__446': 99999.04, 'cod_eve__446': 550, 'pais_ocurrencia__446': 'COLOMBIA', 'uni_med__446': 1, 'fm_fuerza__446': None, 'area__446': 1, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'departamento_residencia__446': 'CESAR', 'estrato__446': '1         ', 'fec_def__446': '2023-05-15', 'pais_residencia__446': 'COLOMBIA', 'nom_grupo__446': '                                                                                                    ', 'nacionalidad__446': 170, 'sem_ges__446': '          ', 'municipio_ocurrencia__446': 'VALLEDUPAR', 'cod_pais_o__446': 170, 'cod_mun_r__446': 1, 'con_fin__446': 2, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'gp_vic_vio__446': 2, 'pac_hos__446': 2, 'departamento_notificacion__446': 'CESAR'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-19 22:02:25 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-19 22:02:25 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 22:09:33 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 22:09:33 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 22:09:33 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-19 22:09:34 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.UndefinedColumn) no existe la columna Â«cod_eveÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano,...
                                      ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_ss__0': 'C', 'consecutive_12__0': 0, 'departamento_notificacion__0': 'CUNDINAMARCA', 'cod_mun_n__0': 25899, 'cod_dpto_n__0': 25, 'estrato__0': '2         ', 'cod_pre__0': 2589902990, 'gp_gestan__0': 2, 'cod_pais_r__0': 170, 'pais_residencia__0': 'COLOMBIA', 'fm_grado__0': None, 'sem_ges__0': '          ', 'gp_discapa__0': 2, 'fecha_nto__0': '2003-01-08', 'cod_pais_o__0': 170, 'gp_migrant__0': 2, 'fec_con__0': '2020-07-16', 'area__0': 1, 'gp_pobicfb__0': 2, 'municipio_notificacion__0': 'ZIPAQUIRA', 'estado_final_de_caso__0': 4, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'sexo__0': 'F', 'fec_not__0': '2020-07-19', 'ocupacion__0': 9998, 'ini_sin__0': '2020-07-16', 'gp_carcela__0': 2, 'uni_med__0': 1, 'tip_cas__0': 4, 'gp_desmovi__0': 2, 'departamento_residencia__0': 'TOLIMA', 'fec_def__0': '2020-07-18', 'nombre_evento__0': 'MORTALIDAD MATERNA', 'per_etn__0': 6, 'cod_dpto_r__0': 73, 'pais_ocurrencia__0': 'COLOMBIA', 'gp_vic_vio__0': 2, 'cod_sub__0': 20, 'gp_psiquia__0': 2, 'con_fin__0': 2, 'cbmte__0': '9999', 'va_sispro__0': 1, 'cod_mun_r__0': 275, 'edad__0': 17, 'fec_arc_xl__0': '2020-07-22', 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'cod_dpto_o__0': 25, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'nacionalidad__0': 170, 'cod_mun_o__0': 307 ... 32531 parameters truncated ... 'fec_not__446': '2020-07-17', 'ocupacion__446': 9996, 'ini_sin__446': '2020-07-04', 'gp_carcela__446': 2, 'uni_med__446': 1, 'tip_cas__446': 4, 'gp_desmovi__446': 2, 'departamento_residencia__446': 'CAQUETA', 'fec_def__446': '2020-07-17', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'per_etn__446': 6, 'cod_dpto_r__446': 18, 'pais_ocurrencia__446': 'COLOMBIA', 'gp_vic_vio__446': 2, 'cod_sub__446': 1, 'gp_psiquia__446': 2, 'con_fin__446': 2, 'cbmte__446': 'J189', 'va_sispro__446': 1, 'cod_mun_r__446': 1, 'edad__446': 33, 'fec_arc_xl__446': '2020-07-22', 'nom_upgd__446': 'CLINIA MEDILASER SA', 'cod_dpto_o__446': 18, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'nacionalidad__446': 170, 'cod_mun_o__446': 1, 'gp_indigen__446': 2, 'fuente__446': 1, 'fm_fuerza__446': None, 'confirmados__446': 1, 'gp_mad_com__446': 2, 'cod_ase__446': 'EPSS16', 'fec_aju__446': '2020-08-10', 'municipio_residencia__446': 'FLORENCIA', 'gp_desplaz__446': 2, 'municipio_ocurrencia__446': 'FLORENCIA', 'fm_unidad__446': None, 'gru_pob__446': None, 'ano__446': 2020, 'fec_hos__446': '2020-07-14', 'ajuste__446': 7, 'pac_hos__446': 1, 'cod_eve__446': 550, 'cer_def__446': 720399987.0, 'gp_otros__446': 1, 'nom_grupo__446': '                                                                                                    ', 'semana__446': 29, 'consecutive_origen__446': 444, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedColumn: no existe la columna Â«cod_eveÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano,...
                                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) no existe la columna Â«cod_eveÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano,...
                                      ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'tip_ss__0': 'C', 'consecutive_12__0': 0, 'departamento_notificacion__0': 'CUNDINAMARCA', 'cod_mun_n__0': 25899, 'cod_dpto_n__0': 25, 'estrato__0': '2         ', 'cod_pre__0': 2589902990, 'gp_gestan__0': 2, 'cod_pais_r__0': 170, 'pais_residencia__0': 'COLOMBIA', 'fm_grado__0': None, 'sem_ges__0': '          ', 'gp_discapa__0': 2, 'fecha_nto__0': '2003-01-08', 'cod_pais_o__0': 170, 'gp_migrant__0': 2, 'fec_con__0': '2020-07-16', 'area__0': 1, 'gp_pobicfb__0': 2, 'municipio_notificacion__0': 'ZIPAQUIRA', 'estado_final_de_caso__0': 4, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'sexo__0': 'F', 'fec_not__0': '2020-07-19', 'ocupacion__0': 9998, 'ini_sin__0': '2020-07-16', 'gp_carcela__0': 2, 'uni_med__0': 1, 'tip_cas__0': 4, 'gp_desmovi__0': 2, 'departamento_residencia__0': 'TOLIMA', 'fec_def__0': '2020-07-18', 'nombre_evento__0': 'MORTALIDAD MATERNA', 'per_etn__0': 6, 'cod_dpto_r__0': 73, 'pais_ocurrencia__0': 'COLOMBIA', 'gp_vic_vio__0': 2, 'cod_sub__0': 20, 'gp_psiquia__0': 2, 'con_fin__0': 2, 'cbmte__0': '9999', 'va_sispro__0': 1, 'cod_mun_r__0': 275, 'edad__0': 17, 'fec_arc_xl__0': '2020-07-22', 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'cod_dpto_o__0': 25, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'nacionalidad__0': 170, 'cod_mun_o__0': 307 ... 32531 parameters truncated ... 'fec_not__446': '2020-07-17', 'ocupacion__446': 9996, 'ini_sin__446': '2020-07-04', 'gp_carcela__446': 2, 'uni_med__446': 1, 'tip_cas__446': 4, 'gp_desmovi__446': 2, 'departamento_residencia__446': 'CAQUETA', 'fec_def__446': '2020-07-17', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'per_etn__446': 6, 'cod_dpto_r__446': 18, 'pais_ocurrencia__446': 'COLOMBIA', 'gp_vic_vio__446': 2, 'cod_sub__446': 1, 'gp_psiquia__446': 2, 'con_fin__446': 2, 'cbmte__446': 'J189', 'va_sispro__446': 1, 'cod_mun_r__446': 1, 'edad__446': 33, 'fec_arc_xl__446': '2020-07-22', 'nom_upgd__446': 'CLINIA MEDILASER SA', 'cod_dpto_o__446': 18, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'nacionalidad__446': 170, 'cod_mun_o__446': 1, 'gp_indigen__446': 2, 'fuente__446': 1, 'fm_fuerza__446': None, 'confirmados__446': 1, 'gp_mad_com__446': 2, 'cod_ase__446': 'EPSS16', 'fec_aju__446': '2020-08-10', 'municipio_residencia__446': 'FLORENCIA', 'gp_desplaz__446': 2, 'municipio_ocurrencia__446': 'FLORENCIA', 'fm_unidad__446': None, 'gru_pob__446': None, 'ano__446': 2020, 'fec_hos__446': '2020-07-14', 'ajuste__446': 7, 'pac_hos__446': 1, 'cod_eve__446': 550, 'cer_def__446': 720399987.0, 'gp_otros__446': 1, 'nom_grupo__446': '                                                                                                    ', 'semana__446': 29, 'consecutive_origen__446': 444, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-19 22:09:34 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-19 22:09:34 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 22:11:51 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 22:11:51 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 22:11:51 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-19 22:11:52 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.UndefinedColumn) no existe la columna Â«fec_notÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, an...
                                                 ^

[SQL: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_dis ... 680918 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'gp_pobicfb__0': 2, 'cod_dpto_r__0': 8, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'municipio_notificacion__0': 'BARRANQUILLA', 'fec_arc_xl__0': '2023-07-21', 'estrato__0': '2         ', 'consecutive_origen__0': 280, 'cod_pre__0': 800101106, 'confirmados__0': 1, 'consecutive_12__0': 10417462, 'gp_desmovi__0': 2, 'fecha_nto__0': '1985-03-26', 'ocupacion__0': 26340.0, 'estado_final_de_caso__0': 4, 'gru_pob__0': None, 'gp_otros__0': 2, 'ajuste__0': 7, 'gp_vic_vio__0': 2, 'cod_ase__0': 'EPS010', 'fec_def__0': '2023-07-21', 'va_sispro__0': 1, 'sexo__0': 'F', 'cod_mun_o__0': 520, 'edad__0': 38, 'gp_carcela__0': 2, 'gp_psiquia__0': 2, 'departamento_ocurrencia__0': 'ATLANTICO', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'area__0': 1, 'tip_cas__0': 4, 'tip_ss__0': 'C', 'uni_med__0': 1, 'gp_mad_com__0': 2, 'fm_unidad__0': None, 'pais_ocurrencia__0': 'COLOMBIA', 'nombre_evento__0': 'MORTALIDAD MATERNA', 'pac_hos__0': 1, 'ano__0': 2023, 'cod_mun_n__0': 8001, 'gp_gestan__0': 1, 'cod_dpto_n__0': 8, 'cer_def__0': 23074520316259, 'gp_discapa__0': 2, 'per_etn__0': 6, 'fuente__0': 1, 'fec_con__0': '2023-07-19', 'fec_not__0': '2023-07-21', 'sem_ges__0': '39        ', 'fec_hos__0': '2023-07-19', 'fm_grado__0': None ... 32531 parameters truncated ... 'edad__446': 25, 'gp_carcela__446': 2, 'gp_psiquia__446': 2, 'departamento_ocurrencia__446': 'CESAR', 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'area__446': 1, 'tip_cas__446': 4, 'tip_ss__446': 'S', 'uni_med__446': 1, 'gp_mad_com__446': 2, 'fm_unidad__446': None, 'pais_ocurrencia__446': 'COLOMBIA', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'pac_hos__446': 2, 'ano__446': 2023, 'cod_mun_n__446': 20001, 'gp_gestan__446': 2, 'cod_dpto_n__446': 20, 'cer_def__446': 23055820256300, 'gp_discapa__446': 2, 'per_etn__446': 6, 'fuente__446': 4, 'fec_con__446': '2023-05-10', 'fec_not__446': '2023-05-15', 'sem_ges__446': '          ', 'fec_hos__446': None, 'fm_grado__446': None, 'fm_fuerza__446': None, 'nacionalidad__446': 170, 'gp_desplaz__446': 2, 'cod_pais_r__446': 170, 'cod_mun_r__446': 1, 'cbmte__446': 'C50X', 'municipio_residencia__446': 'VALLEDUPAR', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'gp_migrant__446': 2, 'nom_grupo__446': '                                                                                                    ', 'COD_EVE__446': 550, 'nom_upgd__446': 'CLINICA BUENOS AIRES', 'semana__446': 20, 'gp_indigen__446': 2, 'fec_aju__446': '2023-05-15', 'pais_residencia__446': 'COLOMBIA', 'cod_pais_o__446': 170, 'departamento_residencia__446': 'CESAR', 'departamento_notificacion__446': 'CESAR', 'con_fin__446': 2, 'ini_sin__446': '2023-04-10', 'cod_dpto_o__446': 20, 'cod_sub__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedColumn: no existe la columna Â«fec_notÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, an...
                                                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) no existe la columna Â«fec_notÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, an...
                                                 ^

[SQL: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_dis ... 680918 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'gp_pobicfb__0': 2, 'cod_dpto_r__0': 8, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'municipio_notificacion__0': 'BARRANQUILLA', 'fec_arc_xl__0': '2023-07-21', 'estrato__0': '2         ', 'consecutive_origen__0': 280, 'cod_pre__0': 800101106, 'confirmados__0': 1, 'consecutive_12__0': 10417462, 'gp_desmovi__0': 2, 'fecha_nto__0': '1985-03-26', 'ocupacion__0': 26340.0, 'estado_final_de_caso__0': 4, 'gru_pob__0': None, 'gp_otros__0': 2, 'ajuste__0': 7, 'gp_vic_vio__0': 2, 'cod_ase__0': 'EPS010', 'fec_def__0': '2023-07-21', 'va_sispro__0': 1, 'sexo__0': 'F', 'cod_mun_o__0': 520, 'edad__0': 38, 'gp_carcela__0': 2, 'gp_psiquia__0': 2, 'departamento_ocurrencia__0': 'ATLANTICO', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'area__0': 1, 'tip_cas__0': 4, 'tip_ss__0': 'C', 'uni_med__0': 1, 'gp_mad_com__0': 2, 'fm_unidad__0': None, 'pais_ocurrencia__0': 'COLOMBIA', 'nombre_evento__0': 'MORTALIDAD MATERNA', 'pac_hos__0': 1, 'ano__0': 2023, 'cod_mun_n__0': 8001, 'gp_gestan__0': 1, 'cod_dpto_n__0': 8, 'cer_def__0': 23074520316259, 'gp_discapa__0': 2, 'per_etn__0': 6, 'fuente__0': 1, 'fec_con__0': '2023-07-19', 'fec_not__0': '2023-07-21', 'sem_ges__0': '39        ', 'fec_hos__0': '2023-07-19', 'fm_grado__0': None ... 32531 parameters truncated ... 'edad__446': 25, 'gp_carcela__446': 2, 'gp_psiquia__446': 2, 'departamento_ocurrencia__446': 'CESAR', 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'area__446': 1, 'tip_cas__446': 4, 'tip_ss__446': 'S', 'uni_med__446': 1, 'gp_mad_com__446': 2, 'fm_unidad__446': None, 'pais_ocurrencia__446': 'COLOMBIA', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'pac_hos__446': 2, 'ano__446': 2023, 'cod_mun_n__446': 20001, 'gp_gestan__446': 2, 'cod_dpto_n__446': 20, 'cer_def__446': 23055820256300, 'gp_discapa__446': 2, 'per_etn__446': 6, 'fuente__446': 4, 'fec_con__446': '2023-05-10', 'fec_not__446': '2023-05-15', 'sem_ges__446': '          ', 'fec_hos__446': None, 'fm_grado__446': None, 'fm_fuerza__446': None, 'nacionalidad__446': 170, 'gp_desplaz__446': 2, 'cod_pais_r__446': 170, 'cod_mun_r__446': 1, 'cbmte__446': 'C50X', 'municipio_residencia__446': 'VALLEDUPAR', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'gp_migrant__446': 2, 'nom_grupo__446': '                                                                                                    ', 'COD_EVE__446': 550, 'nom_upgd__446': 'CLINICA BUENOS AIRES', 'semana__446': 20, 'gp_indigen__446': 2, 'fec_aju__446': '2023-05-15', 'pais_residencia__446': 'COLOMBIA', 'cod_pais_o__446': 170, 'departamento_residencia__446': 'CESAR', 'departamento_notificacion__446': 'CESAR', 'con_fin__446': 2, 'ini_sin__446': '2023-04-10', 'cod_dpto_o__446': 20, 'cod_sub__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-19 22:11:52 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-19 22:11:52 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 22:16:28 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 22:16:28 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 22:16:29 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-19 22:16:29 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.UndefinedColumn) no existe la columna Â«COD_EVEÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, an...
                                      ^

[SQL: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_dis ... 680918 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_mun_r__0': 520, 'fec_arc_xl__0': '2023-07-21', 'COD_EVE__0': 550, 'cod_mun_o__0': 520, 'ano__0': 2023, 'cod_ase__0': 'EPS010', 'gp_mad_com__0': 2, 'fm_unidad__0': None, 'pais_ocurrencia__0': 'COLOMBIA', 'sexo__0': 'F', 'departamento_notificacion__0': 'ATLANTICO', 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'per_etn__0': 6, 'cod_dpto_n__0': 8, 'fec_aju__0': '2023-08-14', 'ini_sin__0': '2023-07-19', 'fecha_nto__0': '1985-03-26', 'consecutive_12__0': 10417462, 'nacionalidad__0': 170, 'area__0': 1, 'fuente__0': 1, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'gp_vic_vio__0': 2, 'cod_sub__0': 1, 'departamento_residencia__0': 'ATLANTICO', 'cbmte__0': 'O881', 'cod_dpto_o__0': 8, 'tip_cas__0': 4, 'cod_pre__0': 800101106, 'ajuste__0': 7, 'semana__0': 29, 'gp_discapa__0': 2, 'municipio_notificacion__0': 'BARRANQUILLA', 'cod_dpto_r__0': 8, 'municipio_residencia__0': 'PALMAR DE VARELA', 'gp_psiquia__0': 2, 'fec_not__0': '2023-07-21', 'estrato__0': '2         ', 'va_sispro__0': 1, 'confirmados__0': 1, 'departamento_ocurrencia__0': 'ATLANTICO', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'pac_hos__0': 1, 'estado_final_de_caso__0': 4, 'nom_grupo__0': '                                                                                                    ', 'con_fin__0': 2, 'gp_carcela__0': 2, 'cod_pais_o__0': 170, 'fec_hos__0': '2023-07-19', 'gp_migrant__0': 2 ... 32531 parameters truncated ... 'cod_sub__446': 1, 'departamento_residencia__446': 'CESAR', 'cbmte__446': 'C50X', 'cod_dpto_o__446': 20, 'tip_cas__446': 4, 'cod_pre__446': 2000100183, 'ajuste__446': 0, 'semana__446': 20, 'gp_discapa__446': 2, 'municipio_notificacion__446': 'VALLEDUPAR', 'cod_dpto_r__446': 20, 'municipio_residencia__446': 'VALLEDUPAR', 'gp_psiquia__446': 2, 'fec_not__446': '2023-05-15', 'estrato__446': '1         ', 'va_sispro__446': 1, 'confirmados__446': 1, 'departamento_ocurrencia__446': 'CESAR', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'pac_hos__446': 2, 'estado_final_de_caso__446': 4, 'nom_grupo__446': '                                                                                                    ', 'con_fin__446': 2, 'gp_carcela__446': 2, 'cod_pais_o__446': 170, 'fec_hos__446': None, 'gp_migrant__446': 2, 'fm_fuerza__446': None, 'pais_residencia__446': 'COLOMBIA', 'gru_pob__446': None, 'gp_desplaz__446': 2, 'ocupacion__446': 99999.04, 'tip_ss__446': 'S', 'gp_indigen__446': 2, 'cod_mun_n__446': 20001, 'sem_ges__446': '          ', 'fec_con__446': '2023-05-10', 'fec_def__446': '2023-05-15', 'cer_def__446': 23055820256300, 'fm_grado__446': None, 'cod_pais_r__446': 170, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'gp_pobicfb__446': 2, 'gp_gestan__446': 2, 'gp_desmovi__446': 2, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'consecutive_origen__446': 163, 'uni_med__446': 1, 'edad__446': 25, 'gp_otros__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedColumn: no existe la columna Â«COD_EVEÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, an...
                                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) no existe la columna Â«COD_EVEÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, an...
                                      ^

[SQL: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_dis ... 680918 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_mun_r__0': 520, 'fec_arc_xl__0': '2023-07-21', 'COD_EVE__0': 550, 'cod_mun_o__0': 520, 'ano__0': 2023, 'cod_ase__0': 'EPS010', 'gp_mad_com__0': 2, 'fm_unidad__0': None, 'pais_ocurrencia__0': 'COLOMBIA', 'sexo__0': 'F', 'departamento_notificacion__0': 'ATLANTICO', 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'per_etn__0': 6, 'cod_dpto_n__0': 8, 'fec_aju__0': '2023-08-14', 'ini_sin__0': '2023-07-19', 'fecha_nto__0': '1985-03-26', 'consecutive_12__0': 10417462, 'nacionalidad__0': 170, 'area__0': 1, 'fuente__0': 1, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'gp_vic_vio__0': 2, 'cod_sub__0': 1, 'departamento_residencia__0': 'ATLANTICO', 'cbmte__0': 'O881', 'cod_dpto_o__0': 8, 'tip_cas__0': 4, 'cod_pre__0': 800101106, 'ajuste__0': 7, 'semana__0': 29, 'gp_discapa__0': 2, 'municipio_notificacion__0': 'BARRANQUILLA', 'cod_dpto_r__0': 8, 'municipio_residencia__0': 'PALMAR DE VARELA', 'gp_psiquia__0': 2, 'fec_not__0': '2023-07-21', 'estrato__0': '2         ', 'va_sispro__0': 1, 'confirmados__0': 1, 'departamento_ocurrencia__0': 'ATLANTICO', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'pac_hos__0': 1, 'estado_final_de_caso__0': 4, 'nom_grupo__0': '                                                                                                    ', 'con_fin__0': 2, 'gp_carcela__0': 2, 'cod_pais_o__0': 170, 'fec_hos__0': '2023-07-19', 'gp_migrant__0': 2 ... 32531 parameters truncated ... 'cod_sub__446': 1, 'departamento_residencia__446': 'CESAR', 'cbmte__446': 'C50X', 'cod_dpto_o__446': 20, 'tip_cas__446': 4, 'cod_pre__446': 2000100183, 'ajuste__446': 0, 'semana__446': 20, 'gp_discapa__446': 2, 'municipio_notificacion__446': 'VALLEDUPAR', 'cod_dpto_r__446': 20, 'municipio_residencia__446': 'VALLEDUPAR', 'gp_psiquia__446': 2, 'fec_not__446': '2023-05-15', 'estrato__446': '1         ', 'va_sispro__446': 1, 'confirmados__446': 1, 'departamento_ocurrencia__446': 'CESAR', 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'pac_hos__446': 2, 'estado_final_de_caso__446': 4, 'nom_grupo__446': '                                                                                                    ', 'con_fin__446': 2, 'gp_carcela__446': 2, 'cod_pais_o__446': 170, 'fec_hos__446': None, 'gp_migrant__446': 2, 'fm_fuerza__446': None, 'pais_residencia__446': 'COLOMBIA', 'gru_pob__446': None, 'gp_desplaz__446': 2, 'ocupacion__446': 99999.04, 'tip_ss__446': 'S', 'gp_indigen__446': 2, 'cod_mun_n__446': 20001, 'sem_ges__446': '          ', 'fec_con__446': '2023-05-10', 'fec_def__446': '2023-05-15', 'cer_def__446': 23055820256300, 'fm_grado__446': None, 'cod_pais_r__446': 170, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'gp_pobicfb__446': 2, 'gp_gestan__446': 2, 'gp_desmovi__446': 2, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'consecutive_origen__446': 163, 'uni_med__446': 1, 'edad__446': 25, 'gp_otros__446': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-19 22:16:29 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-19 22:16:29 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 22:17:37 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 22:17:37 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 22:17:38 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-19 22:17:38 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.UndefinedColumn) no existe la columna Â«COD_EVEÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, an...
                                      ^

[SQL: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_dis ... 680918 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_ase__0': 'EPS010', 'uni_med__0': 1, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'consecutive_origen__0': 280, 'cod_dpto_n__0': 8, 'fec_hos__0': '2023-07-19', 'tip_ss__0': 'C', 'fec_def__0': '2023-07-21', 'cer_def__0': 23074520316259, 'gru_pob__0': None, 'fecha_nto__0': '1985-03-26', 'nacionalidad__0': 170, 'departamento_notificacion__0': 'ATLANTICO', 'gp_migrant__0': 2, 'gp_mad_com__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'cod_pais_r__0': 170, 'gp_vic_vio__0': 2, 'departamento_ocurrencia__0': 'ATLANTICO', 'municipio_residencia__0': 'PALMAR DE VARELA', 'sexo__0': 'F', 'gp_psiquia__0': 2, 'fm_unidad__0': None, 'gp_gestan__0': 1, 'gp_otros__0': 2, 'per_etn__0': 6, 'pais_residencia__0': 'COLOMBIA', 'fm_grado__0': None, 'fec_con__0': '2023-07-19', 'ajuste__0': 7, 'cbmte__0': 'O881', 'municipio_notificacion__0': 'BARRANQUILLA', 'gp_carcela__0': 2, 'fec_arc_xl__0': '2023-07-21', 'estado_final_de_caso__0': 4, 'departamento_residencia__0': 'ATLANTICO', 'edad__0': 38, 'semana__0': 29, 'cod_dpto_o__0': 8, 'area__0': 1, 'gp_discapa__0': 2, 'fm_fuerza__0': None, 'pais_ocurrencia__0': 'COLOMBIA', 'COD_EVE__0': 550, 'nom_grupo__0': '                                                                                                    ', 'pac_hos__0': 1, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'cod_dpto_r__0': 8, 'sem_ges__0': '39        ', 'fec_aju__0': '2023-08-14' ... 32531 parameters truncated ... 'gp_gestan__446': 2, 'gp_otros__446': 1, 'per_etn__446': 6, 'pais_residencia__446': 'COLOMBIA', 'fm_grado__446': None, 'fec_con__446': '2023-05-10', 'ajuste__446': 0, 'cbmte__446': 'C50X', 'municipio_notificacion__446': 'VALLEDUPAR', 'gp_carcela__446': 2, 'fec_arc_xl__446': '2023-05-15', 'estado_final_de_caso__446': 4, 'departamento_residencia__446': 'CESAR', 'edad__446': 25, 'semana__446': 20, 'cod_dpto_o__446': 20, 'area__446': 1, 'gp_discapa__446': 2, 'fm_fuerza__446': None, 'pais_ocurrencia__446': 'COLOMBIA', 'COD_EVE__446': 550, 'nom_grupo__446': '                                                                                                    ', 'pac_hos__446': 2, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'cod_dpto_r__446': 20, 'sem_ges__446': '          ', 'fec_aju__446': '2023-05-15', 'cod_mun_n__446': 20001, 'ano__446': 2023, 'estrato__446': '1         ', 'cod_pais_o__446': 170, 'ocupacion__446': 99999.04, 'va_sispro__446': 1, 'cod_mun_r__446': 1, 'con_fin__446': 2, 'fec_not__446': '2023-05-15', 'nom_upgd__446': 'CLINICA BUENOS AIRES', 'cod_mun_o__446': 1, 'consecutive_12__446': 10050179, 'gp_desmovi__446': 2, 'confirmados__446': 1, 'cod_pre__446': 2000100183, 'gp_pobicfb__446': 2, 'gp_indigen__446': 2, 'tip_cas__446': 4, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'cod_sub__446': 1, 'gp_desplaz__446': 2, 'fuente__446': 4, 'ini_sin__446': '2023-04-10'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedColumn: no existe la columna Â«COD_EVEÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, an...
                                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) no existe la columna Â«COD_EVEÂ» en la relaciÃ³n Â«staging_maternasÂ»
LINE 1: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, an...
                                      ^

[SQL: INSERT INTO staging_maternas ("COD_EVE", fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_dis ... 680918 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_ase__0': 'EPS010', 'uni_med__0': 1, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'consecutive_origen__0': 280, 'cod_dpto_n__0': 8, 'fec_hos__0': '2023-07-19', 'tip_ss__0': 'C', 'fec_def__0': '2023-07-21', 'cer_def__0': 23074520316259, 'gru_pob__0': None, 'fecha_nto__0': '1985-03-26', 'nacionalidad__0': 170, 'departamento_notificacion__0': 'ATLANTICO', 'gp_migrant__0': 2, 'gp_mad_com__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'cod_pais_r__0': 170, 'gp_vic_vio__0': 2, 'departamento_ocurrencia__0': 'ATLANTICO', 'municipio_residencia__0': 'PALMAR DE VARELA', 'sexo__0': 'F', 'gp_psiquia__0': 2, 'fm_unidad__0': None, 'gp_gestan__0': 1, 'gp_otros__0': 2, 'per_etn__0': 6, 'pais_residencia__0': 'COLOMBIA', 'fm_grado__0': None, 'fec_con__0': '2023-07-19', 'ajuste__0': 7, 'cbmte__0': 'O881', 'municipio_notificacion__0': 'BARRANQUILLA', 'gp_carcela__0': 2, 'fec_arc_xl__0': '2023-07-21', 'estado_final_de_caso__0': 4, 'departamento_residencia__0': 'ATLANTICO', 'edad__0': 38, 'semana__0': 29, 'cod_dpto_o__0': 8, 'area__0': 1, 'gp_discapa__0': 2, 'fm_fuerza__0': None, 'pais_ocurrencia__0': 'COLOMBIA', 'COD_EVE__0': 550, 'nom_grupo__0': '                                                                                                    ', 'pac_hos__0': 1, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'cod_dpto_r__0': 8, 'sem_ges__0': '39        ', 'fec_aju__0': '2023-08-14' ... 32531 parameters truncated ... 'gp_gestan__446': 2, 'gp_otros__446': 1, 'per_etn__446': 6, 'pais_residencia__446': 'COLOMBIA', 'fm_grado__446': None, 'fec_con__446': '2023-05-10', 'ajuste__446': 0, 'cbmte__446': 'C50X', 'municipio_notificacion__446': 'VALLEDUPAR', 'gp_carcela__446': 2, 'fec_arc_xl__446': '2023-05-15', 'estado_final_de_caso__446': 4, 'departamento_residencia__446': 'CESAR', 'edad__446': 25, 'semana__446': 20, 'cod_dpto_o__446': 20, 'area__446': 1, 'gp_discapa__446': 2, 'fm_fuerza__446': None, 'pais_ocurrencia__446': 'COLOMBIA', 'COD_EVE__446': 550, 'nom_grupo__446': '                                                                                                    ', 'pac_hos__446': 2, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'cod_dpto_r__446': 20, 'sem_ges__446': '          ', 'fec_aju__446': '2023-05-15', 'cod_mun_n__446': 20001, 'ano__446': 2023, 'estrato__446': '1         ', 'cod_pais_o__446': 170, 'ocupacion__446': 99999.04, 'va_sispro__446': 1, 'cod_mun_r__446': 1, 'con_fin__446': 2, 'fec_not__446': '2023-05-15', 'nom_upgd__446': 'CLINICA BUENOS AIRES', 'cod_mun_o__446': 1, 'consecutive_12__446': 10050179, 'gp_desmovi__446': 2, 'confirmados__446': 1, 'cod_pre__446': 2000100183, 'gp_pobicfb__446': 2, 'gp_indigen__446': 2, 'tip_cas__446': 4, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'cod_sub__446': 1, 'gp_desplaz__446': 2, 'fuente__446': 4, 'ini_sin__446': '2023-04-10'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-19 22:17:38 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-19 22:17:38 | INFO | main | âœ… ETL finalizado correctamente
2025-09-19 22:18:35 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-19 22:18:35 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-19 22:18:36 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-19 22:18:36 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...                  ', '2         ', 2, 2, 2, 2, 2, '         ...
                                                             ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'gp_vic_vio__0': 2, 'ini_sin__0': '2023-07-19', 'fecha_nto__0': '1985-03-26', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'confirmados__0': 1, 'gp_gestan__0': 1, 'consecutive_origen__0': 280, 'gp_otros__0': 2, 'pais_ocurrencia__0': 'COLOMBIA', 'departamento_ocurrencia__0': 'ATLANTICO', 'sexo__0': 'F', 'sem_ges__0': '39        ', 'cod_dpto_o__0': 8, 'gp_discapa__0': 2, 'fm_fuerza__0': None, 'fm_grado__0': None, 'va_sispro__0': 1, 'nom_grupo__0': '                                                                                                    ', 'ajuste__0': 7, 'departamento_residencia__0': 'ATLANTICO', 'cod_dpto_n__0': 8, 'pais_residencia__0': 'COLOMBIA', 'area__0': 1, 'cod_pais_o__0': 170, 'gp_desplaz__0': 2, 'gp_indigen__0': 2, 'municipio_residencia__0': 'PALMAR DE VARELA', 'consecutive_12__0': 10417462, 'gp_psiquia__0': 2, 'cbmte__0': 'O881', 'cod_dpto_r__0': 8, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'fec_arc_xl__0': '2023-07-21', 'gru_pob__0': None, 'uni_med__0': 1, 'tip_cas__0': 4, 'fec_def__0': '2023-07-21', 'pac_hos__0': 1, 'semana__0': 29, 'gp_migrant__0': 2, 'cod_mun_o__0': 520, 'fm_unidad__0': None, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'estrato__0': '2         ', 'cod_mun_r__0': 520, 'gp_pobicfb__0': 2, 'gp_mad_com__0': 2, 'gp_desmovi__0': 2, 'municipio_notificacion__0': 'BARRANQUILLA', 'fec_con__0': '2023-07-19' ... 32531 parameters truncated ... 'cod_pais_o__446': 170, 'gp_desplaz__446': 2, 'gp_indigen__446': 2, 'municipio_residencia__446': 'VALLEDUPAR', 'consecutive_12__446': 10050179, 'gp_psiquia__446': 2, 'cbmte__446': 'C50X', 'cod_dpto_r__446': 20, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'fec_arc_xl__446': '2023-05-15', 'gru_pob__446': None, 'uni_med__446': 1, 'tip_cas__446': 4, 'fec_def__446': '2023-05-15', 'pac_hos__446': 2, 'semana__446': 20, 'gp_migrant__446': 2, 'cod_mun_o__446': 1, 'fm_unidad__446': None, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'estrato__446': '1         ', 'cod_mun_r__446': 1, 'gp_pobicfb__446': 2, 'gp_mad_com__446': 2, 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'VALLEDUPAR', 'fec_con__446': '2023-05-10', 'ocupacion__446': 99999.04, 'cod_mun_n__446': 20001, 'cod_eve__446': 550, 'per_etn__446': 6, 'fec_hos__446': None, 'fuente__446': 4, 'fec_not__446': '2023-05-15', 'con_fin__446': 2, 'ano__446': 2023, 'tip_ss__446': 'S', 'departamento_notificacion__446': 'CESAR', 'gp_carcela__446': 2, 'cer_def__446': 23055820256300, 'estado_final_de_caso__446': 4, 'cod_pais_r__446': 170, 'nacionalidad__446': 170, 'cod_ase__446': 'ESS024', 'fec_aju__446': '2023-05-15', 'nom_upgd__446': 'CLINICA BUENOS AIRES', 'cod_sub__446': 1, 'cod_pre__446': 2000100183, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'edad__446': 25}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...                  ', '2         ', 2, 2, 2, 2, 2, '         ...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...                  ', '2         ', 2, 2, 2, 2, 2, '         ...
                                                             ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'gp_vic_vio__0': 2, 'ini_sin__0': '2023-07-19', 'fecha_nto__0': '1985-03-26', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'confirmados__0': 1, 'gp_gestan__0': 1, 'consecutive_origen__0': 280, 'gp_otros__0': 2, 'pais_ocurrencia__0': 'COLOMBIA', 'departamento_ocurrencia__0': 'ATLANTICO', 'sexo__0': 'F', 'sem_ges__0': '39        ', 'cod_dpto_o__0': 8, 'gp_discapa__0': 2, 'fm_fuerza__0': None, 'fm_grado__0': None, 'va_sispro__0': 1, 'nom_grupo__0': '                                                                                                    ', 'ajuste__0': 7, 'departamento_residencia__0': 'ATLANTICO', 'cod_dpto_n__0': 8, 'pais_residencia__0': 'COLOMBIA', 'area__0': 1, 'cod_pais_o__0': 170, 'gp_desplaz__0': 2, 'gp_indigen__0': 2, 'municipio_residencia__0': 'PALMAR DE VARELA', 'consecutive_12__0': 10417462, 'gp_psiquia__0': 2, 'cbmte__0': 'O881', 'cod_dpto_r__0': 8, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'fec_arc_xl__0': '2023-07-21', 'gru_pob__0': None, 'uni_med__0': 1, 'tip_cas__0': 4, 'fec_def__0': '2023-07-21', 'pac_hos__0': 1, 'semana__0': 29, 'gp_migrant__0': 2, 'cod_mun_o__0': 520, 'fm_unidad__0': None, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'estrato__0': '2         ', 'cod_mun_r__0': 520, 'gp_pobicfb__0': 2, 'gp_mad_com__0': 2, 'gp_desmovi__0': 2, 'municipio_notificacion__0': 'BARRANQUILLA', 'fec_con__0': '2023-07-19' ... 32531 parameters truncated ... 'cod_pais_o__446': 170, 'gp_desplaz__446': 2, 'gp_indigen__446': 2, 'municipio_residencia__446': 'VALLEDUPAR', 'consecutive_12__446': 10050179, 'gp_psiquia__446': 2, 'cbmte__446': 'C50X', 'cod_dpto_r__446': 20, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'fec_arc_xl__446': '2023-05-15', 'gru_pob__446': None, 'uni_med__446': 1, 'tip_cas__446': 4, 'fec_def__446': '2023-05-15', 'pac_hos__446': 2, 'semana__446': 20, 'gp_migrant__446': 2, 'cod_mun_o__446': 1, 'fm_unidad__446': None, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'estrato__446': '1         ', 'cod_mun_r__446': 1, 'gp_pobicfb__446': 2, 'gp_mad_com__446': 2, 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'VALLEDUPAR', 'fec_con__446': '2023-05-10', 'ocupacion__446': 99999.04, 'cod_mun_n__446': 20001, 'cod_eve__446': 550, 'per_etn__446': 6, 'fec_hos__446': None, 'fuente__446': 4, 'fec_not__446': '2023-05-15', 'con_fin__446': 2, 'ano__446': 2023, 'tip_ss__446': 'S', 'departamento_notificacion__446': 'CESAR', 'gp_carcela__446': 2, 'cer_def__446': 23055820256300, 'estado_final_de_caso__446': 4, 'cod_pais_r__446': 170, 'nacionalidad__446': 170, 'cod_ase__446': 'ESS024', 'fec_aju__446': '2023-05-15', 'nom_upgd__446': 'CLINICA BUENOS AIRES', 'cod_sub__446': 1, 'cod_pre__446': 2000100183, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'edad__446': 25}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-19 22:18:36 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-19 22:18:36 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 21:43:55 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 21:43:55 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 21:43:58 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-21 21:43:59 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...                  ', '2         ', 2, 2, 2, 2, 2, '         ...
                                                             ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'sexo__0': 'F', 'cod_mun_o__0': 307, 'gp_psiquia__0': 2, 'gp_vic_vio__0': 2, 'fec_not__0': '2020-07-19', 'edad__0': 17, 'tip_ss__0': 'C', 'nom_grupo__0': '                                                                                                    ', 'fec_hos__0': '2020-07-17', 'con_fin__0': 2, 'ajuste__0': 0, 'fm_grado__0': None, 'consecutive_origen__0': 25, 'gp_mad_com__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'per_etn__0': 6, 'fec_arc_xl__0': '2020-07-22', 'tip_cas__0': 4, 'cod_dpto_r__0': 73, 'fm_unidad__0': None, 'departamento_notificacion__0': 'CUNDINAMARCA', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'semana__0': 29, 'gp_desmovi__0': 2, 'municipio_notificacion__0': 'ZIPAQUIRA', 'departamento_residencia__0': 'TOLIMA', 'estrato__0': '2         ', 'cod_mun_n__0': 25899, 'estado_final_de_caso__0': 4, 'cod_sub__0': 20, 'gp_migrant__0': 2, 'pac_hos__0': 1, 'gru_pob__0': None, 'cod_dpto_n__0': 25, 'municipio_ocurrencia__0': 'GIRARDOT', 'fm_fuerza__0': None, 'gp_gestan__0': 2, 'gp_carcela__0': 2, 'gp_otros__0': 1, 'ini_sin__0': '2020-07-16', 'pais_residencia__0': 'COLOMBIA', 'uni_med__0': 1, 'gp_desplaz__0': 2, 'gp_indigen__0': 2, 'cbmte__0': '9999', 'pais_ocurrencia__0': 'COLOMBIA', 'municipio_residencia__0': 'FLANDES', 'fec_def__0': '2020-07-18', 'cod_mun_r__0': 275, 'departamento_ocurrencia__0': 'CUNDINAMARCA' ... 32531 parameters truncated ... 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'FLORENCIA', 'departamento_residencia__446': 'CAQUETA', 'estrato__446': '2         ', 'cod_mun_n__446': 18001, 'estado_final_de_caso__446': 4, 'cod_sub__446': 1, 'gp_migrant__446': 2, 'pac_hos__446': 1, 'gru_pob__446': None, 'cod_dpto_n__446': 18, 'municipio_ocurrencia__446': 'FLORENCIA', 'fm_fuerza__446': None, 'gp_gestan__446': 2, 'gp_carcela__446': 2, 'gp_otros__446': 1, 'ini_sin__446': '2020-07-04', 'pais_residencia__446': 'COLOMBIA', 'uni_med__446': 1, 'gp_desplaz__446': 2, 'gp_indigen__446': 2, 'cbmte__446': 'J189', 'pais_ocurrencia__446': 'COLOMBIA', 'municipio_residencia__446': 'FLORENCIA', 'fec_def__446': '2020-07-17', 'cod_mun_r__446': 1, 'departamento_ocurrencia__446': 'CAQUETA', 'cod_pais_o__446': 170, 'nacionalidad__446': 170, 'consecutive_12__446': 0, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'cod_ase__446': 'EPSS16', 'ano__446': 2020, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'va_sispro__446': 1, 'cod_dpto_o__446': 18, 'ocupacion__446': 9996, 'area__446': 1, 'cod_pais_r__446': 170, 'cod_eve__446': 550, 'fuente__446': 1, 'fecha_nto__446': '1987-03-13', 'confirmados__446': 1, 'gp_pobicfb__446': 2, 'fec_con__446': '2020-07-14', 'cod_pre__446': 1800107466, 'cer_def__446': 720399987.0, 'gp_discapa__446': 2, 'fec_aju__446': '2020-08-10', 'sem_ges__446': '          '}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...                  ', '2         ', 2, 2, 2, 2, 2, '         ...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...                  ', '2         ', 2, 2, 2, 2, 2, '         ...
                                                             ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'sexo__0': 'F', 'cod_mun_o__0': 307, 'gp_psiquia__0': 2, 'gp_vic_vio__0': 2, 'fec_not__0': '2020-07-19', 'edad__0': 17, 'tip_ss__0': 'C', 'nom_grupo__0': '                                                                                                    ', 'fec_hos__0': '2020-07-17', 'con_fin__0': 2, 'ajuste__0': 0, 'fm_grado__0': None, 'consecutive_origen__0': 25, 'gp_mad_com__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'per_etn__0': 6, 'fec_arc_xl__0': '2020-07-22', 'tip_cas__0': 4, 'cod_dpto_r__0': 73, 'fm_unidad__0': None, 'departamento_notificacion__0': 'CUNDINAMARCA', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'semana__0': 29, 'gp_desmovi__0': 2, 'municipio_notificacion__0': 'ZIPAQUIRA', 'departamento_residencia__0': 'TOLIMA', 'estrato__0': '2         ', 'cod_mun_n__0': 25899, 'estado_final_de_caso__0': 4, 'cod_sub__0': 20, 'gp_migrant__0': 2, 'pac_hos__0': 1, 'gru_pob__0': None, 'cod_dpto_n__0': 25, 'municipio_ocurrencia__0': 'GIRARDOT', 'fm_fuerza__0': None, 'gp_gestan__0': 2, 'gp_carcela__0': 2, 'gp_otros__0': 1, 'ini_sin__0': '2020-07-16', 'pais_residencia__0': 'COLOMBIA', 'uni_med__0': 1, 'gp_desplaz__0': 2, 'gp_indigen__0': 2, 'cbmte__0': '9999', 'pais_ocurrencia__0': 'COLOMBIA', 'municipio_residencia__0': 'FLANDES', 'fec_def__0': '2020-07-18', 'cod_mun_r__0': 275, 'departamento_ocurrencia__0': 'CUNDINAMARCA' ... 32531 parameters truncated ... 'gp_desmovi__446': 2, 'municipio_notificacion__446': 'FLORENCIA', 'departamento_residencia__446': 'CAQUETA', 'estrato__446': '2         ', 'cod_mun_n__446': 18001, 'estado_final_de_caso__446': 4, 'cod_sub__446': 1, 'gp_migrant__446': 2, 'pac_hos__446': 1, 'gru_pob__446': None, 'cod_dpto_n__446': 18, 'municipio_ocurrencia__446': 'FLORENCIA', 'fm_fuerza__446': None, 'gp_gestan__446': 2, 'gp_carcela__446': 2, 'gp_otros__446': 1, 'ini_sin__446': '2020-07-04', 'pais_residencia__446': 'COLOMBIA', 'uni_med__446': 1, 'gp_desplaz__446': 2, 'gp_indigen__446': 2, 'cbmte__446': 'J189', 'pais_ocurrencia__446': 'COLOMBIA', 'municipio_residencia__446': 'FLORENCIA', 'fec_def__446': '2020-07-17', 'cod_mun_r__446': 1, 'departamento_ocurrencia__446': 'CAQUETA', 'cod_pais_o__446': 170, 'nacionalidad__446': 170, 'consecutive_12__446': 0, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'cod_ase__446': 'EPSS16', 'ano__446': 2020, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'va_sispro__446': 1, 'cod_dpto_o__446': 18, 'ocupacion__446': 9996, 'area__446': 1, 'cod_pais_r__446': 170, 'cod_eve__446': 550, 'fuente__446': 1, 'fecha_nto__446': '1987-03-13', 'confirmados__446': 1, 'gp_pobicfb__446': 2, 'fec_con__446': '2020-07-14', 'cod_pre__446': 1800107466, 'cer_def__446': 720399987.0, 'gp_discapa__446': 2, 'fec_aju__446': '2020-08-10', 'sem_ges__446': '          '}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 21:43:59 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-21 21:43:59 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 21:49:56 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 21:49:56 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 21:49:56 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-21 21:49:57 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...                  ', '3         ', 2, 2, 2, 2, 2, '         ...
                                                             ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'municipio_notificacion__0': 'VICTORIA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'fec_arc_xl__0': '2019-03-06', 'nacionalidad__0': '170       ', 'gp_indigen__0': 2, 'cod_pais_r__0': None, 'ini_sin__0': '2019-02-28', 'gp_pobicfb__0': 2, 'cod_mun_o__0': 867, 'fm_grado__0': None, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_dpto_r__0': 17, 'gp_mad_com__0': 2, 'gp_migrant__0': 2, 'confirmados__0': 1, 'fec_con__0': '2019-03-02', 'fm_fuerza__0': None, 'area__0': 1, 'nom_grupo__0': '                                                                                                    ', 'ano__0': 2019, 'departamento_notificacion__0': 'CALDAS', 'fec_def__0': '2019-03-02', 'consecutive_12__0': 0, 'gp_desmovi__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'sem_ges__0': '12        ', 'cod_mun_r__0': 867, 'cod_eve__0': 550, 'semana__0': 9, 'cbmte__0': 'I513', 'gp_gestan__0': 1, 'gp_vic_vio__0': 2, 'estrato__0': '2         ', 'fuente__0': 1, 'departamento_ocurrencia__0': 'CALDAS', 'edad__0': 43, 'fec_not__0': '2019-03-02', 'cod_dpto_n__0': 17, 'tip_ss__0': 'C', 'cer_def__0': 719334323.0, 'estado_final_de_caso__0': 4, 'pais_ocurrencia__0': 'COLOMBIA', 'cod_ase__0': 'EPS037', 'cod_dpto_o__0': 17, 'tip_cas__0': 4, 'ocupacion__0': 2342, 'fec_aju__0': '2019-03-02', 'gp_otros__0': 2, 'departamento_residencia__0': 'CALDAS', 'per_etn__0': 6 ... 32531 parameters truncated ... 'gp_desmovi__446': 2, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'sem_ges__446': '39        ', 'cod_mun_r__446': 560, 'cod_eve__446': 550, 'semana__446': 47, 'cbmte__446': 'O141', 'gp_gestan__446': 1, 'gp_vic_vio__446': 2, 'estrato__446': '          ', 'fuente__446': 1, 'departamento_ocurrencia__446': 'GUAJIRA', 'edad__446': 27, 'fec_not__446': '2019-11-23', 'cod_dpto_n__446': 44, 'tip_ss__446': 'S', 'cer_def__446': 721258879.0, 'estado_final_de_caso__446': 4, 'pais_ocurrencia__446': 'COLOMBIA', 'cod_ase__446': 'EPSI04', 'cod_dpto_o__446': 44, 'tip_cas__446': 4, 'ocupacion__446': 9999, 'fec_aju__446': '2019-11-23', 'gp_otros__446': 2, 'departamento_residencia__446': 'GUAJIRA', 'per_etn__446': 1, 'cod_pais_o__446': 170, 'cod_mun_n__446': 44001, 'va_sispro__446': 1, 'municipio_ocurrencia__446': 'RIOHACHA', 'ajuste__446': 7, 'fm_unidad__446': None, 'pac_hos__446': 1, 'gru_pob__446': None, 'uni_med__446': 1, 'gp_discapa__446': 2, 'cod_pre__446': 4400100065, 'gp_carcela__446': 2, 'nom_upgd__446': 'CENTRO DIAGNOSTICO DE ESPECIALISTAS LTDA', 'consecutive_origen__446': 447, 'fec_hos__446': '2019-11-18', 'sexo__446': 'F', 'cod_sub__446': 2, 'gp_psiquia__446': 2, 'fecha_nto__446': '1992-03-24', 'pais_residencia__446': None, 'con_fin__446': 2, 'municipio_residencia__446': 'MANAURE', 'gp_desplaz__446': 2}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...                  ', '3         ', 2, 2, 2, 2, 2, '         ...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...                  ', '3         ', 2, 2, 2, 2, 2, '         ...
                                                             ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'municipio_notificacion__0': 'VICTORIA', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'fec_arc_xl__0': '2019-03-06', 'nacionalidad__0': '170       ', 'gp_indigen__0': 2, 'cod_pais_r__0': None, 'ini_sin__0': '2019-02-28', 'gp_pobicfb__0': 2, 'cod_mun_o__0': 867, 'fm_grado__0': None, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_dpto_r__0': 17, 'gp_mad_com__0': 2, 'gp_migrant__0': 2, 'confirmados__0': 1, 'fec_con__0': '2019-03-02', 'fm_fuerza__0': None, 'area__0': 1, 'nom_grupo__0': '                                                                                                    ', 'ano__0': 2019, 'departamento_notificacion__0': 'CALDAS', 'fec_def__0': '2019-03-02', 'consecutive_12__0': 0, 'gp_desmovi__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'sem_ges__0': '12        ', 'cod_mun_r__0': 867, 'cod_eve__0': 550, 'semana__0': 9, 'cbmte__0': 'I513', 'gp_gestan__0': 1, 'gp_vic_vio__0': 2, 'estrato__0': '2         ', 'fuente__0': 1, 'departamento_ocurrencia__0': 'CALDAS', 'edad__0': 43, 'fec_not__0': '2019-03-02', 'cod_dpto_n__0': 17, 'tip_ss__0': 'C', 'cer_def__0': 719334323.0, 'estado_final_de_caso__0': 4, 'pais_ocurrencia__0': 'COLOMBIA', 'cod_ase__0': 'EPS037', 'cod_dpto_o__0': 17, 'tip_cas__0': 4, 'ocupacion__0': 2342, 'fec_aju__0': '2019-03-02', 'gp_otros__0': 2, 'departamento_residencia__0': 'CALDAS', 'per_etn__0': 6 ... 32531 parameters truncated ... 'gp_desmovi__446': 2, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'sem_ges__446': '39        ', 'cod_mun_r__446': 560, 'cod_eve__446': 550, 'semana__446': 47, 'cbmte__446': 'O141', 'gp_gestan__446': 1, 'gp_vic_vio__446': 2, 'estrato__446': '          ', 'fuente__446': 1, 'departamento_ocurrencia__446': 'GUAJIRA', 'edad__446': 27, 'fec_not__446': '2019-11-23', 'cod_dpto_n__446': 44, 'tip_ss__446': 'S', 'cer_def__446': 721258879.0, 'estado_final_de_caso__446': 4, 'pais_ocurrencia__446': 'COLOMBIA', 'cod_ase__446': 'EPSI04', 'cod_dpto_o__446': 44, 'tip_cas__446': 4, 'ocupacion__446': 9999, 'fec_aju__446': '2019-11-23', 'gp_otros__446': 2, 'departamento_residencia__446': 'GUAJIRA', 'per_etn__446': 1, 'cod_pais_o__446': 170, 'cod_mun_n__446': 44001, 'va_sispro__446': 1, 'municipio_ocurrencia__446': 'RIOHACHA', 'ajuste__446': 7, 'fm_unidad__446': None, 'pac_hos__446': 1, 'gru_pob__446': None, 'uni_med__446': 1, 'gp_discapa__446': 2, 'cod_pre__446': 4400100065, 'gp_carcela__446': 2, 'nom_upgd__446': 'CENTRO DIAGNOSTICO DE ESPECIALISTAS LTDA', 'consecutive_origen__446': 447, 'fec_hos__446': '2019-11-18', 'sexo__446': 'F', 'cod_sub__446': 2, 'gp_psiquia__446': 2, 'fecha_nto__446': '1992-03-24', 'pais_residencia__446': None, 'con_fin__446': 2, 'municipio_residencia__446': 'MANAURE', 'gp_desplaz__446': 2}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 21:49:59 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-21 21:49:59 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 21:52:54 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 21:52:54 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 21:52:54 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-21 21:52:55 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...50, '2019-03-08', 10, 2019, 5000100529, 1, 24, 1, '         ...
                                                             ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'departamento_residencia__0': 'CALDAS', 'consecutive_origen__0': 82, 'gp_gestan__0': 1, 'cbmte__0': 'I513', 'fec_not__0': '2019-03-02', 'estrato__0': '2         ', 'gp_desmovi__0': 2, 'nacionalidad__0': '170       ', 'pais_ocurrencia__0': 'COLOMBIA', 'estado_final_de_caso__0': 4, 'fm_unidad__0': None, 'gp_migrant__0': 2, 'gp_indigen__0': 2, 'gp_psiquia__0': 2, 'nom_grupo__0': '                                                                                                    ', 'fec_hos__0': None, 'gp_discapa__0': 2, 'gp_mad_com__0': 2, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'uni_med__0': 1, 'con_fin__0': 2, 'cod_dpto_r__0': 17, 'municipio_residencia__0': 'VICTORIA', 'cod_sub__0': 1, 'fec_def__0': '2019-03-02', 'gp_vic_vio__0': 2, 'cod_pais_r__0': None, 'cod_ase__0': 'EPS037', 'fec_aju__0': '2019-03-02', 'cod_dpto_o__0': 17, 'fm_fuerza__0': None, 'tip_cas__0': 4, 'cod_mun_r__0': 867, 'nom_upgd__0': 'ESE HOSPITAL SAN SIMON', 'fuente__0': 1, 'cod_dpto_n__0': 17, 'municipio_ocurrencia__0': 'VICTORIA', 'fm_grado__0': None, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'per_etn__0': 6, 'gp_carcela__0': 2, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'consecutive_12__0': 0, 'cod_mun_o__0': 867, 'confirmados__0': 1, 'departamento_ocurrencia__0': 'CALDAS', 'gp_pobicfb__0': 2, 'gp_desplaz__0': 2, 'cod_pre__0': 1786700720, 'fec_con__0': '2019-03-02' ... 32531 parameters truncated ... 'cod_sub__446': 2, 'fec_def__446': '2019-11-22', 'gp_vic_vio__446': 2, 'cod_pais_r__446': None, 'cod_ase__446': 'EPSI04', 'fec_aju__446': '2019-11-23', 'cod_dpto_o__446': 44, 'fm_fuerza__446': None, 'tip_cas__446': 4, 'cod_mun_r__446': 560, 'nom_upgd__446': 'CENTRO DIAGNOSTICO DE ESPECIALISTAS LTDA', 'fuente__446': 1, 'cod_dpto_n__446': 44, 'municipio_ocurrencia__446': 'RIOHACHA', 'fm_grado__446': None, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'per_etn__446': 1, 'gp_carcela__446': 2, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'consecutive_12__446': 0, 'cod_mun_o__446': 1, 'confirmados__446': 1, 'departamento_ocurrencia__446': 'GUAJIRA', 'gp_pobicfb__446': 2, 'gp_desplaz__446': 2, 'cod_pre__446': 4400100065, 'fec_con__446': '2019-11-18', 'fec_arc_xl__446': '2019-11-27', 'ocupacion__446': 9999, 'sem_ges__446': '39        ', 'municipio_notificacion__446': 'RIOHACHA', 'gp_otros__446': 2, 'va_sispro__446': 1, 'cod_pais_o__446': 170, 'cod_mun_n__446': 44001, 'ajuste__446': 7, 'pac_hos__446': 1, 'sexo__446': 'F', 'departamento_notificacion__446': 'GUAJIRA', 'edad__446': 27, 'cer_def__446': 721258879.0, 'ini_sin__446': '2019-11-18', 'ano__446': 2019, 'area__446': 1, 'semana__446': 47, 'gru_pob__446': None, 'fecha_nto__446': '1992-03-24', 'pais_residencia__446': None, 'cod_eve__446': 550, 'tip_ss__446': 'S'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.InvalidTextRepresentation: la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...50, '2019-03-08', 10, 2019, 5000100529, 1, 24, 1, '         ...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) la sintaxis de entrada no es vÃ¡lida para tipo integer: Â«          Â»
LINE 1: ...50, '2019-03-08', 10, 2019, 5000100529, 1, 24, 1, '         ...
                                                             ^

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'departamento_residencia__0': 'CALDAS', 'consecutive_origen__0': 82, 'gp_gestan__0': 1, 'cbmte__0': 'I513', 'fec_not__0': '2019-03-02', 'estrato__0': '2         ', 'gp_desmovi__0': 2, 'nacionalidad__0': '170       ', 'pais_ocurrencia__0': 'COLOMBIA', 'estado_final_de_caso__0': 4, 'fm_unidad__0': None, 'gp_migrant__0': 2, 'gp_indigen__0': 2, 'gp_psiquia__0': 2, 'nom_grupo__0': '                                                                                                    ', 'fec_hos__0': None, 'gp_discapa__0': 2, 'gp_mad_com__0': 2, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'uni_med__0': 1, 'con_fin__0': 2, 'cod_dpto_r__0': 17, 'municipio_residencia__0': 'VICTORIA', 'cod_sub__0': 1, 'fec_def__0': '2019-03-02', 'gp_vic_vio__0': 2, 'cod_pais_r__0': None, 'cod_ase__0': 'EPS037', 'fec_aju__0': '2019-03-02', 'cod_dpto_o__0': 17, 'fm_fuerza__0': None, 'tip_cas__0': 4, 'cod_mun_r__0': 867, 'nom_upgd__0': 'ESE HOSPITAL SAN SIMON', 'fuente__0': 1, 'cod_dpto_n__0': 17, 'municipio_ocurrencia__0': 'VICTORIA', 'fm_grado__0': None, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'per_etn__0': 6, 'gp_carcela__0': 2, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'consecutive_12__0': 0, 'cod_mun_o__0': 867, 'confirmados__0': 1, 'departamento_ocurrencia__0': 'CALDAS', 'gp_pobicfb__0': 2, 'gp_desplaz__0': 2, 'cod_pre__0': 1786700720, 'fec_con__0': '2019-03-02' ... 32531 parameters truncated ... 'cod_sub__446': 2, 'fec_def__446': '2019-11-22', 'gp_vic_vio__446': 2, 'cod_pais_r__446': None, 'cod_ase__446': 'EPSI04', 'fec_aju__446': '2019-11-23', 'cod_dpto_o__446': 44, 'fm_fuerza__446': None, 'tip_cas__446': 4, 'cod_mun_r__446': 560, 'nom_upgd__446': 'CENTRO DIAGNOSTICO DE ESPECIALISTAS LTDA', 'fuente__446': 1, 'cod_dpto_n__446': 44, 'municipio_ocurrencia__446': 'RIOHACHA', 'fm_grado__446': None, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'per_etn__446': 1, 'gp_carcela__446': 2, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'consecutive_12__446': 0, 'cod_mun_o__446': 1, 'confirmados__446': 1, 'departamento_ocurrencia__446': 'GUAJIRA', 'gp_pobicfb__446': 2, 'gp_desplaz__446': 2, 'cod_pre__446': 4400100065, 'fec_con__446': '2019-11-18', 'fec_arc_xl__446': '2019-11-27', 'ocupacion__446': 9999, 'sem_ges__446': '39        ', 'municipio_notificacion__446': 'RIOHACHA', 'gp_otros__446': 2, 'va_sispro__446': 1, 'cod_pais_o__446': 170, 'cod_mun_n__446': 44001, 'ajuste__446': 7, 'pac_hos__446': 1, 'sexo__446': 'F', 'departamento_notificacion__446': 'GUAJIRA', 'edad__446': 27, 'cer_def__446': 721258879.0, 'ini_sin__446': '2019-11-18', 'ano__446': 2019, 'area__446': 1, 'semana__446': 47, 'gru_pob__446': None, 'fecha_nto__446': '1992-03-24', 'pais_residencia__446': None, 'cod_eve__446': 550, 'tip_ss__446': 'S'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 21:52:55 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-21 21:52:55 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 21:54:49 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 21:54:49 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 21:54:49 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-21 21:54:50 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(10)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'fec_def__0': '2019-03-02', 'fec_aju__0': '2019-03-02', 'fec_arc_xl__0': '2019-03-06', 'nom_upgd__0': 'ESE HOSPITAL SAN SIMON', 'cod_mun_r__0': 867, 'fuente__0': 1, 'cod_mun_o__0': 867, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'sem_ges__0': '12        ', 'semana__0': 9, 'fecha_nto__0': '1976-02-29', 'cod_pais_o__0': 170, 'nom_grupo__0': '                                                                                                    ', 'fm_unidad__0': None, 'per_etn__0': 6, 'pac_hos__0': 2, 'ano__0': 2019, 'edad__0': 43, 'area__0': 1, 'gp_migrant__0': 2, 'gp_vic_vio__0': 2, 'confirmados__0': 1, 'con_fin__0': 2, 'pais_residencia__0': None, 'fec_not__0': '2019-03-02', 'cod_ase__0': 'EPS037', 'gp_psiquia__0': 2, 'sexo__0': 'F', 'cbmte__0': 'I513', 'pais_ocurrencia__0': 'COLOMBIA', 'tip_cas__0': 4, 'gp_desplaz__0': 2, 'cod_dpto_n__0': 17, 'fm_grado__0': None, 'consecutive_origen__0': 82, 'cod_dpto_o__0': 17, 'cod_pre__0': 1786700720, 'estrato__0': '2         ', 'departamento_ocurrencia__0': 'CALDAS', 'gru_pob__0': None, 'gp_pobicfb__0': 2, 'municipio_residencia__0': 'VICTORIA', 'cod_mun_n__0': 17867, 'uni_med__0': 1, 'tip_ss__0': 'C', 'ajuste__0': 0, 'cod_sub__0': 1, 'ini_sin__0': '2019-02-28', 'cer_def__0': 719334323.0, 'gp_indigen__0': 2 ... 32531 parameters truncated ... 'pais_residencia__446': None, 'fec_not__446': '2019-11-23', 'cod_ase__446': 'EPSI04', 'gp_psiquia__446': 2, 'sexo__446': 'F', 'cbmte__446': 'O141', 'pais_ocurrencia__446': 'COLOMBIA', 'tip_cas__446': 4, 'gp_desplaz__446': 2, 'cod_dpto_n__446': 44, 'fm_grado__446': None, 'consecutive_origen__446': 447, 'cod_dpto_o__446': 44, 'cod_pre__446': 4400100065, 'estrato__446': '          ', 'departamento_ocurrencia__446': 'GUAJIRA', 'gru_pob__446': None, 'gp_pobicfb__446': 2, 'municipio_residencia__446': 'MANAURE', 'cod_mun_n__446': 44001, 'uni_med__446': 1, 'tip_ss__446': 'S', 'ajuste__446': 7, 'cod_sub__446': 2, 'ini_sin__446': '2019-11-18', 'cer_def__446': 721258879.0, 'gp_indigen__446': 2, 'fm_fuerza__446': None, 'gp_otros__446': 2, 'va_sispro__446': 1, 'consecutive_12__446': 0, 'gp_desmovi__446': 2, 'cod_eve__446': 550, 'departamento_notificacion__446': 'GUAJIRA', 'municipio_notificacion__446': 'RIOHACHA', 'nacionalidad__446': '170       ', 'cod_dpto_r__446': 44, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'gp_carcela__446': 2, 'fec_con__446': '2019-11-18', 'fec_hos__446': '2019-11-18', 'gp_mad_com__446': 2, 'gp_discapa__446': 2, 'departamento_residencia__446': 'GUAJIRA', 'estado_final_de_caso__446': 4, 'municipio_ocurrencia__446': 'RIOHACHA', 'ocupacion__446': 9999, 'cod_pais_r__446': None, 'gp_gestan__446': 1, 'nombre_evento__446': 'MORTALIDAD MATERNA'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.StringDataRightTruncation: el valor es demasiado largo para el tipo character varying(10)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(10)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'fec_def__0': '2019-03-02', 'fec_aju__0': '2019-03-02', 'fec_arc_xl__0': '2019-03-06', 'nom_upgd__0': 'ESE HOSPITAL SAN SIMON', 'cod_mun_r__0': 867, 'fuente__0': 1, 'cod_mun_o__0': 867, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'sem_ges__0': '12        ', 'semana__0': 9, 'fecha_nto__0': '1976-02-29', 'cod_pais_o__0': 170, 'nom_grupo__0': '                                                                                                    ', 'fm_unidad__0': None, 'per_etn__0': 6, 'pac_hos__0': 2, 'ano__0': 2019, 'edad__0': 43, 'area__0': 1, 'gp_migrant__0': 2, 'gp_vic_vio__0': 2, 'confirmados__0': 1, 'con_fin__0': 2, 'pais_residencia__0': None, 'fec_not__0': '2019-03-02', 'cod_ase__0': 'EPS037', 'gp_psiquia__0': 2, 'sexo__0': 'F', 'cbmte__0': 'I513', 'pais_ocurrencia__0': 'COLOMBIA', 'tip_cas__0': 4, 'gp_desplaz__0': 2, 'cod_dpto_n__0': 17, 'fm_grado__0': None, 'consecutive_origen__0': 82, 'cod_dpto_o__0': 17, 'cod_pre__0': 1786700720, 'estrato__0': '2         ', 'departamento_ocurrencia__0': 'CALDAS', 'gru_pob__0': None, 'gp_pobicfb__0': 2, 'municipio_residencia__0': 'VICTORIA', 'cod_mun_n__0': 17867, 'uni_med__0': 1, 'tip_ss__0': 'C', 'ajuste__0': 0, 'cod_sub__0': 1, 'ini_sin__0': '2019-02-28', 'cer_def__0': 719334323.0, 'gp_indigen__0': 2 ... 32531 parameters truncated ... 'pais_residencia__446': None, 'fec_not__446': '2019-11-23', 'cod_ase__446': 'EPSI04', 'gp_psiquia__446': 2, 'sexo__446': 'F', 'cbmte__446': 'O141', 'pais_ocurrencia__446': 'COLOMBIA', 'tip_cas__446': 4, 'gp_desplaz__446': 2, 'cod_dpto_n__446': 44, 'fm_grado__446': None, 'consecutive_origen__446': 447, 'cod_dpto_o__446': 44, 'cod_pre__446': 4400100065, 'estrato__446': '          ', 'departamento_ocurrencia__446': 'GUAJIRA', 'gru_pob__446': None, 'gp_pobicfb__446': 2, 'municipio_residencia__446': 'MANAURE', 'cod_mun_n__446': 44001, 'uni_med__446': 1, 'tip_ss__446': 'S', 'ajuste__446': 7, 'cod_sub__446': 2, 'ini_sin__446': '2019-11-18', 'cer_def__446': 721258879.0, 'gp_indigen__446': 2, 'fm_fuerza__446': None, 'gp_otros__446': 2, 'va_sispro__446': 1, 'consecutive_12__446': 0, 'gp_desmovi__446': 2, 'cod_eve__446': 550, 'departamento_notificacion__446': 'GUAJIRA', 'municipio_notificacion__446': 'RIOHACHA', 'nacionalidad__446': '170       ', 'cod_dpto_r__446': 44, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'gp_carcela__446': 2, 'fec_con__446': '2019-11-18', 'fec_hos__446': '2019-11-18', 'gp_mad_com__446': 2, 'gp_discapa__446': 2, 'departamento_residencia__446': 'GUAJIRA', 'estado_final_de_caso__446': 4, 'municipio_ocurrencia__446': 'RIOHACHA', 'ocupacion__446': 9999, 'cod_pais_r__446': None, 'gp_gestan__446': 1, 'nombre_evento__446': 'MORTALIDAD MATERNA'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 21:54:50 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-21 21:54:50 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 21:59:34 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 21:59:34 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 21:59:35 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-21 21:59:35 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-21 21:59:35 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-21 21:59:35 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:00:08 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:00:08 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:00:08 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-21 22:00:08 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(20)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_mun_r__0': 275, 'pac_hos__0': 1, 'pais_residencia__0': 'COLOMBIA', 'cod_ase__0': 'EPS037', 'fm_fuerza__0': None, 'consecutive_12__0': 0, 'fuente__0': 1, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'cod_pais_r__0': 170, 'municipio_residencia__0': 'FLANDES', 'fecha_nto__0': '2003-01-08', 'tip_ss__0': 'C', 'gp_desmovi__0': 2, 'fec_arc_xl__0': '2020-07-22', 'gp_mad_com__0': 2, 'area__0': 1, 'ano__0': 2020, 'sexo__0': 'F', 'gp_vic_vio__0': 2, 'cod_dpto_n__0': 25, 'departamento_notificacion__0': 'CUNDINAMARCA', 'cod_dpto_r__0': 73, 'ajuste__0': 0, 'pais_ocurrencia__0': 'COLOMBIA', 'departamento_residencia__0': 'TOLIMA', 'nom_grupo__0': '                                                                                                    ', 'municipio_notificacion__0': 'ZIPAQUIRA', 'estrato__0': '2         ', 'con_fin__0': 2, 'gp_gestan__0': 2, 'ini_sin__0': '2020-07-16', 'cod_mun_o__0': 307, 'fec_con__0': '2020-07-16', 'gp_otros__0': 1, 'gp_carcela__0': 2, 'semana__0': 29, 'municipio_ocurrencia__0': 'GIRARDOT', 'nombre_evento__0': 'MORTALIDAD MATERNA', 'fec_def__0': '2020-07-18', 'gp_pobicfb__0': 2, 'consecutive_origen__0': 25, 'cod_pais_o__0': 170, 'gp_indigen__0': 2, 'fec_aju__0': '2020-07-19', 'confirmados__0': 1, 'fec_hos__0': '2020-07-17', 'uni_med__0': 1, 'cer_def__0': 722298969.0, 'gp_discapa__0': 2, 'nacionalidad__0': 170 ... 32531 parameters truncated ... 'pais_ocurrencia__446': 'COLOMBIA', 'departamento_residencia__446': 'CAQUETA', 'nom_grupo__446': '                                                                                                    ', 'municipio_notificacion__446': 'FLORENCIA', 'estrato__446': '2         ', 'con_fin__446': 2, 'gp_gestan__446': 2, 'ini_sin__446': '2020-07-04', 'cod_mun_o__446': 1, 'fec_con__446': '2020-07-14', 'gp_otros__446': 1, 'gp_carcela__446': 2, 'semana__446': 29, 'municipio_ocurrencia__446': 'FLORENCIA', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'fec_def__446': '2020-07-17', 'gp_pobicfb__446': 2, 'consecutive_origen__446': 444, 'cod_pais_o__446': 170, 'gp_indigen__446': 2, 'fec_aju__446': '2020-08-10', 'confirmados__446': 1, 'fec_hos__446': '2020-07-14', 'uni_med__446': 1, 'cer_def__446': 720399987.0, 'gp_discapa__446': 2, 'nacionalidad__446': 170, 'edad__446': 33, 'gp_migrant__446': 2, 'cod_sub__446': 1, 'fm_unidad__446': None, 'va_sispro__446': 1, 'cod_mun_n__446': 18001, 'cod_dpto_o__446': 18, 'gru_pob__446': None, 'fec_not__446': '2020-07-17', 'gp_psiquia__446': 2, 'departamento_ocurrencia__446': 'CAQUETA', 'gp_desplaz__446': 2, 'fm_grado__446': None, 'estado_final_de_caso__446': 4, 'cod_eve__446': 550, 'tip_cas__446': 4, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'ocupacion__446': 9996, 'sem_ges__446': '          ', 'cbmte__446': 'J189', 'per_etn__446': 6, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'cod_pre__446': 1800107466}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.StringDataRightTruncation: el valor es demasiado largo para el tipo character varying(20)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(20)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_mun_r__0': 275, 'pac_hos__0': 1, 'pais_residencia__0': 'COLOMBIA', 'cod_ase__0': 'EPS037', 'fm_fuerza__0': None, 'consecutive_12__0': 0, 'fuente__0': 1, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'cod_pais_r__0': 170, 'municipio_residencia__0': 'FLANDES', 'fecha_nto__0': '2003-01-08', 'tip_ss__0': 'C', 'gp_desmovi__0': 2, 'fec_arc_xl__0': '2020-07-22', 'gp_mad_com__0': 2, 'area__0': 1, 'ano__0': 2020, 'sexo__0': 'F', 'gp_vic_vio__0': 2, 'cod_dpto_n__0': 25, 'departamento_notificacion__0': 'CUNDINAMARCA', 'cod_dpto_r__0': 73, 'ajuste__0': 0, 'pais_ocurrencia__0': 'COLOMBIA', 'departamento_residencia__0': 'TOLIMA', 'nom_grupo__0': '                                                                                                    ', 'municipio_notificacion__0': 'ZIPAQUIRA', 'estrato__0': '2         ', 'con_fin__0': 2, 'gp_gestan__0': 2, 'ini_sin__0': '2020-07-16', 'cod_mun_o__0': 307, 'fec_con__0': '2020-07-16', 'gp_otros__0': 1, 'gp_carcela__0': 2, 'semana__0': 29, 'municipio_ocurrencia__0': 'GIRARDOT', 'nombre_evento__0': 'MORTALIDAD MATERNA', 'fec_def__0': '2020-07-18', 'gp_pobicfb__0': 2, 'consecutive_origen__0': 25, 'cod_pais_o__0': 170, 'gp_indigen__0': 2, 'fec_aju__0': '2020-07-19', 'confirmados__0': 1, 'fec_hos__0': '2020-07-17', 'uni_med__0': 1, 'cer_def__0': 722298969.0, 'gp_discapa__0': 2, 'nacionalidad__0': 170 ... 32531 parameters truncated ... 'pais_ocurrencia__446': 'COLOMBIA', 'departamento_residencia__446': 'CAQUETA', 'nom_grupo__446': '                                                                                                    ', 'municipio_notificacion__446': 'FLORENCIA', 'estrato__446': '2         ', 'con_fin__446': 2, 'gp_gestan__446': 2, 'ini_sin__446': '2020-07-04', 'cod_mun_o__446': 1, 'fec_con__446': '2020-07-14', 'gp_otros__446': 1, 'gp_carcela__446': 2, 'semana__446': 29, 'municipio_ocurrencia__446': 'FLORENCIA', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'fec_def__446': '2020-07-17', 'gp_pobicfb__446': 2, 'consecutive_origen__446': 444, 'cod_pais_o__446': 170, 'gp_indigen__446': 2, 'fec_aju__446': '2020-08-10', 'confirmados__446': 1, 'fec_hos__446': '2020-07-14', 'uni_med__446': 1, 'cer_def__446': 720399987.0, 'gp_discapa__446': 2, 'nacionalidad__446': 170, 'edad__446': 33, 'gp_migrant__446': 2, 'cod_sub__446': 1, 'fm_unidad__446': None, 'va_sispro__446': 1, 'cod_mun_n__446': 18001, 'cod_dpto_o__446': 18, 'gru_pob__446': None, 'fec_not__446': '2020-07-17', 'gp_psiquia__446': 2, 'departamento_ocurrencia__446': 'CAQUETA', 'gp_desplaz__446': 2, 'fm_grado__446': None, 'estado_final_de_caso__446': 4, 'cod_eve__446': 550, 'tip_cas__446': 4, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'ocupacion__446': 9996, 'sem_ges__446': '          ', 'cbmte__446': 'J189', 'per_etn__446': 6, 'nombre_nacionalidad__446': 'COLOMBIA                                                                                            ', 'cod_pre__446': 1800107466}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 22:00:09 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-21 22:00:09 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:01:50 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:01:50 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:01:51 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-21 22:01:51 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-21 22:01:51 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-21 22:01:51 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-21 22:01:52 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-21 22:01:52 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-21 22:01:52 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(20)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'fm_grado__0': None, 'tip_cas__0': 4, 'gp_desplaz__0': 2, 'pac_hos__0': 1, 'cbmte__0': '9999', 'consecutive_origen__0': 25, 'cod_pais_o__0': 170, 'departamento_residencia__0': 'TOLIMA', 'cod_dpto_r__0': 73, 'cod_mun_r__0': 275, 'gp_indigen__0': 2, 'gp_carcela__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'area__0': 1, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'municipio_residencia__0': 'FLANDES', 'edad__0': 17, 'gp_discapa__0': 2, 'ini_sin__0': '2020-07-16', 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'municipio_notificacion__0': 'ZIPAQUIRA', 'ocupacion__0': 9998, 'nacionalidad__0': 170, 'sem_ges__0': '          ', 'cod_dpto_n__0': 25, 'estrato__0': '2         ', 'gp_gestan__0': 2, 'tip_ss__0': 'C', 'fec_con__0': '2020-07-16', 'fec_def__0': '2020-07-18', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'fuente__0': 1, 'cod_ase__0': 'EPS037', 'confirmados__0': 1, 'con_fin__0': 2, 'sexo__0': 'F', 'fecha_nto__0': '2003-01-08', 'semana__0': 29, 'cer_def__0': 722298969.0, 'va_sispro__0': 1, 'uni_med__0': 1, 'fm_unidad__0': None, 'cod_dpto_o__0': 25, 'gru_pob__0': None, 'ajuste__0': 0, 'gp_otros__0': 1, 'cod_mun_n__0': 25899, 'gp_desmovi__0': 2, 'fec_aju__0': '2020-07-19', 'gp_mad_com__0': 2 ... 32531 parameters truncated ... 'sem_ges__446': '          ', 'cod_dpto_n__446': 18, 'estrato__446': '2         ', 'gp_gestan__446': 2, 'tip_ss__446': 'S', 'fec_con__446': '2020-07-14', 'fec_def__446': '2020-07-17', 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'fuente__446': 1, 'cod_ase__446': 'EPSS16', 'confirmados__446': 1, 'con_fin__446': 2, 'sexo__446': 'F', 'fecha_nto__446': '1987-03-13', 'semana__446': 29, 'cer_def__446': 720399987.0, 'va_sispro__446': 1, 'uni_med__446': 1, 'fm_unidad__446': None, 'cod_dpto_o__446': 18, 'gru_pob__446': None, 'ajuste__446': 7, 'gp_otros__446': 1, 'cod_mun_n__446': 18001, 'gp_desmovi__446': 2, 'fec_aju__446': '2020-08-10', 'gp_mad_com__446': 2, 'gp_pobicfb__446': 2, 'estado_final_de_caso__446': 4, 'gp_migrant__446': 2, 'cod_pre__446': 1800107466, 'gp_psiquia__446': 2, 'gp_vic_vio__446': 2, 'departamento_notificacion__446': 'CAQUETA', 'pais_ocurrencia__446': 'COLOMBIA', 'cod_mun_o__446': 1, 'fec_arc_xl__446': '2020-07-22', 'nom_grupo__446': '                                                                                                    ', 'cod_sub__446': 1, 'fec_not__446': '2020-07-17', 'consecutive_12__446': 0, 'pais_residencia__446': 'COLOMBIA', 'fec_hos__446': '2020-07-14', 'ano__446': 2020, 'fm_fuerza__446': None, 'municipio_ocurrencia__446': 'FLORENCIA', 'per_etn__446': 6, 'departamento_ocurrencia__446': 'CAQUETA', 'cod_pais_r__446': 170, 'cod_eve__446': 550}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.StringDataRightTruncation: el valor es demasiado largo para el tipo character varying(20)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(20)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'fm_grado__0': None, 'tip_cas__0': 4, 'gp_desplaz__0': 2, 'pac_hos__0': 1, 'cbmte__0': '9999', 'consecutive_origen__0': 25, 'cod_pais_o__0': 170, 'departamento_residencia__0': 'TOLIMA', 'cod_dpto_r__0': 73, 'cod_mun_r__0': 275, 'gp_indigen__0': 2, 'gp_carcela__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'area__0': 1, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'municipio_residencia__0': 'FLANDES', 'edad__0': 17, 'gp_discapa__0': 2, 'ini_sin__0': '2020-07-16', 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'municipio_notificacion__0': 'ZIPAQUIRA', 'ocupacion__0': 9998, 'nacionalidad__0': 170, 'sem_ges__0': '          ', 'cod_dpto_n__0': 25, 'estrato__0': '2         ', 'gp_gestan__0': 2, 'tip_ss__0': 'C', 'fec_con__0': '2020-07-16', 'fec_def__0': '2020-07-18', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'fuente__0': 1, 'cod_ase__0': 'EPS037', 'confirmados__0': 1, 'con_fin__0': 2, 'sexo__0': 'F', 'fecha_nto__0': '2003-01-08', 'semana__0': 29, 'cer_def__0': 722298969.0, 'va_sispro__0': 1, 'uni_med__0': 1, 'fm_unidad__0': None, 'cod_dpto_o__0': 25, 'gru_pob__0': None, 'ajuste__0': 0, 'gp_otros__0': 1, 'cod_mun_n__0': 25899, 'gp_desmovi__0': 2, 'fec_aju__0': '2020-07-19', 'gp_mad_com__0': 2 ... 32531 parameters truncated ... 'sem_ges__446': '          ', 'cod_dpto_n__446': 18, 'estrato__446': '2         ', 'gp_gestan__446': 2, 'tip_ss__446': 'S', 'fec_con__446': '2020-07-14', 'fec_def__446': '2020-07-17', 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'fuente__446': 1, 'cod_ase__446': 'EPSS16', 'confirmados__446': 1, 'con_fin__446': 2, 'sexo__446': 'F', 'fecha_nto__446': '1987-03-13', 'semana__446': 29, 'cer_def__446': 720399987.0, 'va_sispro__446': 1, 'uni_med__446': 1, 'fm_unidad__446': None, 'cod_dpto_o__446': 18, 'gru_pob__446': None, 'ajuste__446': 7, 'gp_otros__446': 1, 'cod_mun_n__446': 18001, 'gp_desmovi__446': 2, 'fec_aju__446': '2020-08-10', 'gp_mad_com__446': 2, 'gp_pobicfb__446': 2, 'estado_final_de_caso__446': 4, 'gp_migrant__446': 2, 'cod_pre__446': 1800107466, 'gp_psiquia__446': 2, 'gp_vic_vio__446': 2, 'departamento_notificacion__446': 'CAQUETA', 'pais_ocurrencia__446': 'COLOMBIA', 'cod_mun_o__446': 1, 'fec_arc_xl__446': '2020-07-22', 'nom_grupo__446': '                                                                                                    ', 'cod_sub__446': 1, 'fec_not__446': '2020-07-17', 'consecutive_12__446': 0, 'pais_residencia__446': 'COLOMBIA', 'fec_hos__446': '2020-07-14', 'ano__446': 2020, 'fm_fuerza__446': None, 'municipio_ocurrencia__446': 'FLORENCIA', 'per_etn__446': 6, 'departamento_ocurrencia__446': 'CAQUETA', 'cod_pais_r__446': 170, 'cod_eve__446': 550}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 22:01:52 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-21 22:01:52 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-21 22:01:52 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-21 22:01:52 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.NumericValueOutOfRange) entero fuera de rango

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'fm_grado__0': None, 'tip_cas__0': 4, 'gp_desplaz__0': 2, 'pac_hos__0': 1, 'cbmte__0': 'O881', 'consecutive_origen__0': 280, 'cod_pais_o__0': 170, 'departamento_residencia__0': 'ATLANTICO', 'cod_dpto_r__0': 8, 'cod_mun_r__0': 520, 'gp_indigen__0': 2, 'gp_carcela__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'area__0': 1, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'municipio_residencia__0': 'PALMAR DE VARELA', 'edad__0': 38, 'gp_discapa__0': 2, 'ini_sin__0': '2023-07-19', 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'municipio_notificacion__0': 'BARRANQUILLA', 'ocupacion__0': 26340.0, 'nacionalidad__0': 170, 'sem_ges__0': '39        ', 'cod_dpto_n__0': 8, 'estrato__0': '2         ', 'gp_gestan__0': 1, 'tip_ss__0': 'C', 'fec_con__0': '2023-07-19', 'fec_def__0': '2023-07-21', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'fuente__0': 1, 'cod_ase__0': 'EPS010', 'confirmados__0': 1, 'con_fin__0': 2, 'sexo__0': 'F', 'fecha_nto__0': '1985-03-26', 'semana__0': 29, 'cer_def__0': 23074520316259, 'va_sispro__0': 1, 'uni_med__0': 1, 'fm_unidad__0': None, 'cod_dpto_o__0': 8, 'gru_pob__0': None, 'ajuste__0': 7, 'gp_otros__0': 2, 'cod_mun_n__0': 8001, 'gp_desmovi__0': 2, 'fec_aju__0': '2023-08-14', 'gp_mad_com__0': 2 ... 32531 parameters truncated ... 'sem_ges__446': '          ', 'cod_dpto_n__446': 20, 'estrato__446': '1         ', 'gp_gestan__446': 2, 'tip_ss__446': 'S', 'fec_con__446': '2023-05-10', 'fec_def__446': '2023-05-15', 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'fuente__446': 4, 'cod_ase__446': 'ESS024', 'confirmados__446': 1, 'con_fin__446': 2, 'sexo__446': 'F', 'fecha_nto__446': '1997-09-01', 'semana__446': 20, 'cer_def__446': 23055820256300, 'va_sispro__446': 1, 'uni_med__446': 1, 'fm_unidad__446': None, 'cod_dpto_o__446': 20, 'gru_pob__446': None, 'ajuste__446': 0, 'gp_otros__446': 1, 'cod_mun_n__446': 20001, 'gp_desmovi__446': 2, 'fec_aju__446': '2023-05-15', 'gp_mad_com__446': 2, 'gp_pobicfb__446': 2, 'estado_final_de_caso__446': 4, 'gp_migrant__446': 2, 'cod_pre__446': 2000100183, 'gp_psiquia__446': 2, 'gp_vic_vio__446': 2, 'departamento_notificacion__446': 'CESAR', 'pais_ocurrencia__446': 'COLOMBIA', 'cod_mun_o__446': 1, 'fec_arc_xl__446': '2023-05-15', 'nom_grupo__446': '                                                                                                    ', 'cod_sub__446': 1, 'fec_not__446': '2023-05-15', 'consecutive_12__446': 10050179, 'pais_residencia__446': 'COLOMBIA', 'fec_hos__446': None, 'ano__446': 2023, 'fm_fuerza__446': None, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'per_etn__446': 6, 'departamento_ocurrencia__446': 'CESAR', 'cod_pais_r__446': 170, 'cod_eve__446': 550}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.NumericValueOutOfRange: entero fuera de rango


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.NumericValueOutOfRange) entero fuera de rango

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'fm_grado__0': None, 'tip_cas__0': 4, 'gp_desplaz__0': 2, 'pac_hos__0': 1, 'cbmte__0': 'O881', 'consecutive_origen__0': 280, 'cod_pais_o__0': 170, 'departamento_residencia__0': 'ATLANTICO', 'cod_dpto_r__0': 8, 'cod_mun_r__0': 520, 'gp_indigen__0': 2, 'gp_carcela__0': 2, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'area__0': 1, 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'municipio_residencia__0': 'PALMAR DE VARELA', 'edad__0': 38, 'gp_discapa__0': 2, 'ini_sin__0': '2023-07-19', 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'municipio_notificacion__0': 'BARRANQUILLA', 'ocupacion__0': 26340.0, 'nacionalidad__0': 170, 'sem_ges__0': '39        ', 'cod_dpto_n__0': 8, 'estrato__0': '2         ', 'gp_gestan__0': 1, 'tip_ss__0': 'C', 'fec_con__0': '2023-07-19', 'fec_def__0': '2023-07-21', 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'fuente__0': 1, 'cod_ase__0': 'EPS010', 'confirmados__0': 1, 'con_fin__0': 2, 'sexo__0': 'F', 'fecha_nto__0': '1985-03-26', 'semana__0': 29, 'cer_def__0': 23074520316259, 'va_sispro__0': 1, 'uni_med__0': 1, 'fm_unidad__0': None, 'cod_dpto_o__0': 8, 'gru_pob__0': None, 'ajuste__0': 7, 'gp_otros__0': 2, 'cod_mun_n__0': 8001, 'gp_desmovi__0': 2, 'fec_aju__0': '2023-08-14', 'gp_mad_com__0': 2 ... 32531 parameters truncated ... 'sem_ges__446': '          ', 'cod_dpto_n__446': 20, 'estrato__446': '1         ', 'gp_gestan__446': 2, 'tip_ss__446': 'S', 'fec_con__446': '2023-05-10', 'fec_def__446': '2023-05-15', 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'fuente__446': 4, 'cod_ase__446': 'ESS024', 'confirmados__446': 1, 'con_fin__446': 2, 'sexo__446': 'F', 'fecha_nto__446': '1997-09-01', 'semana__446': 20, 'cer_def__446': 23055820256300, 'va_sispro__446': 1, 'uni_med__446': 1, 'fm_unidad__446': None, 'cod_dpto_o__446': 20, 'gru_pob__446': None, 'ajuste__446': 0, 'gp_otros__446': 1, 'cod_mun_n__446': 20001, 'gp_desmovi__446': 2, 'fec_aju__446': '2023-05-15', 'gp_mad_com__446': 2, 'gp_pobicfb__446': 2, 'estado_final_de_caso__446': 4, 'gp_migrant__446': 2, 'cod_pre__446': 2000100183, 'gp_psiquia__446': 2, 'gp_vic_vio__446': 2, 'departamento_notificacion__446': 'CESAR', 'pais_ocurrencia__446': 'COLOMBIA', 'cod_mun_o__446': 1, 'fec_arc_xl__446': '2023-05-15', 'nom_grupo__446': '                                                                                                    ', 'cod_sub__446': 1, 'fec_not__446': '2023-05-15', 'consecutive_12__446': 10050179, 'pais_residencia__446': 'COLOMBIA', 'fec_hos__446': None, 'ano__446': 2023, 'fm_fuerza__446': None, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'per_etn__446': 6, 'departamento_ocurrencia__446': 'CESAR', 'cod_pais_r__446': 170, 'cod_eve__446': 550}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 22:01:52 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-21 22:01:52 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:04:39 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:04:39 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:04:40 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-21 22:04:40 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(20)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'gru_pob__0': None, 'pais_residencia__0': 'COLOMBIA', 'gp_mad_com__0': 2, 'per_etn__0': 6, 'municipio_notificacion__0': 'ZIPAQUIRA', 'estado_final_de_caso__0': 4, 'va_sispro__0': 1, 'cod_mun_n__0': 25899, 'ajuste__0': 0, 'ini_sin__0': '2020-07-16', 'cod_pais_r__0': 170, 'cod_dpto_o__0': 25, 'fec_hos__0': '2020-07-17', 'gp_desplaz__0': 2, 'cod_pais_o__0': 170, 'gp_psiquia__0': 2, 'fm_grado__0': None, 'municipio_residencia__0': 'FLANDES', 'sem_ges__0': '          ', 'cbmte__0': '9999', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'consecutive_origen__0': 25, 'pac_hos__0': 1, 'cod_pre__0': 2589902990, 'cod_dpto_r__0': 73, 'cod_dpto_n__0': 25, 'cod_sub__0': 20, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'nombre_evento__0': 'MORTALIDAD MATERNA', 'municipio_ocurrencia__0': 'GIRARDOT', 'fec_not__0': '2020-07-19', 'gp_otros__0': 1, 'tip_cas__0': 4, 'confirmados__0': 1, 'gp_vic_vio__0': 2, 'departamento_residencia__0': 'TOLIMA', 'departamento_notificacion__0': 'CUNDINAMARCA', 'pais_ocurrencia__0': 'COLOMBIA', 'edad__0': 17, 'cod_eve__0': 550, 'gp_migrant__0': 2, 'fec_arc_xl__0': '2020-07-22', 'fec_aju__0': '2020-07-19', 'fm_fuerza__0': None, 'fuente__0': 1, 'uni_med__0': 1, 'cod_ase__0': 'EPS037', 'fm_unidad__0': None, 'gp_pobicfb__0': 2, 'fec_def__0': '2020-07-18' ... 32531 parameters truncated ... 'cod_pre__446': 1800107466, 'cod_dpto_r__446': 18, 'cod_dpto_n__446': 18, 'cod_sub__446': 1, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'municipio_ocurrencia__446': 'FLORENCIA', 'fec_not__446': '2020-07-17', 'gp_otros__446': 1, 'tip_cas__446': 4, 'confirmados__446': 1, 'gp_vic_vio__446': 2, 'departamento_residencia__446': 'CAQUETA', 'departamento_notificacion__446': 'CAQUETA', 'pais_ocurrencia__446': 'COLOMBIA', 'edad__446': 33, 'cod_eve__446': 550, 'gp_migrant__446': 2, 'fec_arc_xl__446': '2020-07-22', 'fec_aju__446': '2020-08-10', 'fm_fuerza__446': None, 'fuente__446': 1, 'uni_med__446': 1, 'cod_ase__446': 'EPSS16', 'fm_unidad__446': None, 'gp_pobicfb__446': 2, 'fec_def__446': '2020-07-17', 'fec_con__446': '2020-07-14', 'gp_desmovi__446': 2, 'gp_carcela__446': 2, 'departamento_ocurrencia__446': 'CAQUETA', 'nacionalidad__446': 170, 'cer_def__446': 720399987.0, 'semana__446': 29, 'sexo__446': 'F', 'gp_gestan__446': 2, 'ocupacion__446': 9996, 'consecutive_12__446': 0, 'fecha_nto__446': '1987-03-13', 'cod_mun_r__446': 1, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'gp_discapa__446': 2, 'tip_ss__446': 'S', 'cod_mun_o__446': 1, 'con_fin__446': 2, 'area__446': 1, 'nom_grupo__446': '                                                                                                    ', 'ano__446': 2020, 'gp_indigen__446': 2, 'estrato__446': '2         '}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.StringDataRightTruncation: el valor es demasiado largo para el tipo character varying(20)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(20)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'gru_pob__0': None, 'pais_residencia__0': 'COLOMBIA', 'gp_mad_com__0': 2, 'per_etn__0': 6, 'municipio_notificacion__0': 'ZIPAQUIRA', 'estado_final_de_caso__0': 4, 'va_sispro__0': 1, 'cod_mun_n__0': 25899, 'ajuste__0': 0, 'ini_sin__0': '2020-07-16', 'cod_pais_r__0': 170, 'cod_dpto_o__0': 25, 'fec_hos__0': '2020-07-17', 'gp_desplaz__0': 2, 'cod_pais_o__0': 170, 'gp_psiquia__0': 2, 'fm_grado__0': None, 'municipio_residencia__0': 'FLANDES', 'sem_ges__0': '          ', 'cbmte__0': '9999', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'consecutive_origen__0': 25, 'pac_hos__0': 1, 'cod_pre__0': 2589902990, 'cod_dpto_r__0': 73, 'cod_dpto_n__0': 25, 'cod_sub__0': 20, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'nombre_evento__0': 'MORTALIDAD MATERNA', 'municipio_ocurrencia__0': 'GIRARDOT', 'fec_not__0': '2020-07-19', 'gp_otros__0': 1, 'tip_cas__0': 4, 'confirmados__0': 1, 'gp_vic_vio__0': 2, 'departamento_residencia__0': 'TOLIMA', 'departamento_notificacion__0': 'CUNDINAMARCA', 'pais_ocurrencia__0': 'COLOMBIA', 'edad__0': 17, 'cod_eve__0': 550, 'gp_migrant__0': 2, 'fec_arc_xl__0': '2020-07-22', 'fec_aju__0': '2020-07-19', 'fm_fuerza__0': None, 'fuente__0': 1, 'uni_med__0': 1, 'cod_ase__0': 'EPS037', 'fm_unidad__0': None, 'gp_pobicfb__0': 2, 'fec_def__0': '2020-07-18' ... 32531 parameters truncated ... 'cod_pre__446': 1800107466, 'cod_dpto_r__446': 18, 'cod_dpto_n__446': 18, 'cod_sub__446': 1, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'nombre_evento__446': 'MORTALIDAD MATERNA', 'municipio_ocurrencia__446': 'FLORENCIA', 'fec_not__446': '2020-07-17', 'gp_otros__446': 1, 'tip_cas__446': 4, 'confirmados__446': 1, 'gp_vic_vio__446': 2, 'departamento_residencia__446': 'CAQUETA', 'departamento_notificacion__446': 'CAQUETA', 'pais_ocurrencia__446': 'COLOMBIA', 'edad__446': 33, 'cod_eve__446': 550, 'gp_migrant__446': 2, 'fec_arc_xl__446': '2020-07-22', 'fec_aju__446': '2020-08-10', 'fm_fuerza__446': None, 'fuente__446': 1, 'uni_med__446': 1, 'cod_ase__446': 'EPSS16', 'fm_unidad__446': None, 'gp_pobicfb__446': 2, 'fec_def__446': '2020-07-17', 'fec_con__446': '2020-07-14', 'gp_desmovi__446': 2, 'gp_carcela__446': 2, 'departamento_ocurrencia__446': 'CAQUETA', 'nacionalidad__446': 170, 'cer_def__446': 720399987.0, 'semana__446': 29, 'sexo__446': 'F', 'gp_gestan__446': 2, 'ocupacion__446': 9996, 'consecutive_12__446': 0, 'fecha_nto__446': '1987-03-13', 'cod_mun_r__446': 1, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'gp_discapa__446': 2, 'tip_ss__446': 'S', 'cod_mun_o__446': 1, 'con_fin__446': 2, 'area__446': 1, 'nom_grupo__446': '                                                                                                    ', 'ano__446': 2020, 'gp_indigen__446': 2, 'estrato__446': '2         '}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 22:04:40 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-21 22:04:40 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:05:37 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:05:37 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:05:38 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-21 22:05:38 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-21 22:05:38 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-21 22:05:38 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:06:13 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:06:13 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:06:14 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-21 22:06:14 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.NumericValueOutOfRange) entero fuera de rango

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'estado_final_de_caso__0': 4, 'cbmte__0': 'O881', 'cod_mun_r__0': 520, 'cod_mun_o__0': 520, 'gp_vic_vio__0': 2, 'fec_hos__0': '2023-07-19', 'fecha_nto__0': '1985-03-26', 'nom_grupo__0': '                                                                                                    ', 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'municipio_notificacion__0': 'BARRANQUILLA', 'consecutive_12__0': 10417462, 'cod_eve__0': 550, 'cod_dpto_n__0': 8, 'fec_con__0': '2023-07-19', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_mun_n__0': 8001, 'uni_med__0': 1, 'gp_carcela__0': 2, 'cod_pais_r__0': 170, 'gp_discapa__0': 2, 'pac_hos__0': 1, 'gp_desmovi__0': 2, 'con_fin__0': 2, 'fec_arc_xl__0': '2023-07-21', 'fm_grado__0': None, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'ocupacion__0': 26340.0, 'estrato__0': '2         ', 'cod_dpto_r__0': 8, 'cod_sub__0': 1, 'ini_sin__0': '2023-07-19', 'pais_residencia__0': 'COLOMBIA', 'cod_ase__0': 'EPS010', 'gp_otros__0': 2, 'gp_mad_com__0': 2, 'gp_gestan__0': 1, 'semana__0': 29, 'pais_ocurrencia__0': 'COLOMBIA', 'fec_not__0': '2023-07-21', 'edad__0': 38, 'gp_desplaz__0': 2, 'fm_unidad__0': None, 'fuente__0': 1, 'confirmados__0': 1, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'gp_psiquia__0': 2, 'fec_aju__0': '2023-08-14', 'departamento_notificacion__0': 'ATLANTICO', 'fm_fuerza__0': None, 'consecutive_origen__0': 280 ... 32531 parameters truncated ... 'fec_arc_xl__446': '2023-05-15', 'fm_grado__446': None, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'ocupacion__446': 99999.04, 'estrato__446': '1         ', 'cod_dpto_r__446': 20, 'cod_sub__446': 1, 'ini_sin__446': '2023-04-10', 'pais_residencia__446': 'COLOMBIA', 'cod_ase__446': 'ESS024', 'gp_otros__446': 1, 'gp_mad_com__446': 2, 'gp_gestan__446': 2, 'semana__446': 20, 'pais_ocurrencia__446': 'COLOMBIA', 'fec_not__446': '2023-05-15', 'edad__446': 25, 'gp_desplaz__446': 2, 'fm_unidad__446': None, 'fuente__446': 4, 'confirmados__446': 1, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'gp_psiquia__446': 2, 'fec_aju__446': '2023-05-15', 'departamento_notificacion__446': 'CESAR', 'fm_fuerza__446': None, 'consecutive_origen__446': 163, 'nacionalidad__446': 170, 'area__446': 1, 'per_etn__446': 6, 'sem_ges__446': '          ', 'departamento_ocurrencia__446': 'CESAR', 'cod_pais_o__446': 170, 'fec_def__446': '2023-05-15', 'sexo__446': 'F', 'municipio_residencia__446': 'VALLEDUPAR', 'departamento_residencia__446': 'CESAR', 'ano__446': 2023, 'tip_cas__446': 4, 'va_sispro__446': 1, 'gp_pobicfb__446': 2, 'gru_pob__446': None, 'cod_pre__446': 2000100183, 'gp_migrant__446': 2, 'ajuste__446': 0, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'cod_dpto_o__446': 20, 'tip_ss__446': 'S', 'gp_indigen__446': 2, 'cer_def__446': 23055820256300}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.NumericValueOutOfRange: entero fuera de rango


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.NumericValueOutOfRange) entero fuera de rango

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'estado_final_de_caso__0': 4, 'cbmte__0': 'O881', 'cod_mun_r__0': 520, 'cod_mun_o__0': 520, 'gp_vic_vio__0': 2, 'fec_hos__0': '2023-07-19', 'fecha_nto__0': '1985-03-26', 'nom_grupo__0': '                                                                                                    ', 'nom_upgd__0': 'CONGREGACION DE HNAS FRANCISCANAS MISIONERAS DE MA', 'municipio_notificacion__0': 'BARRANQUILLA', 'consecutive_12__0': 10417462, 'cod_eve__0': 550, 'cod_dpto_n__0': 8, 'fec_con__0': '2023-07-19', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'cod_mun_n__0': 8001, 'uni_med__0': 1, 'gp_carcela__0': 2, 'cod_pais_r__0': 170, 'gp_discapa__0': 2, 'pac_hos__0': 1, 'gp_desmovi__0': 2, 'con_fin__0': 2, 'fec_arc_xl__0': '2023-07-21', 'fm_grado__0': None, 'municipio_ocurrencia__0': 'PALMAR DE VARELA', 'ocupacion__0': 26340.0, 'estrato__0': '2         ', 'cod_dpto_r__0': 8, 'cod_sub__0': 1, 'ini_sin__0': '2023-07-19', 'pais_residencia__0': 'COLOMBIA', 'cod_ase__0': 'EPS010', 'gp_otros__0': 2, 'gp_mad_com__0': 2, 'gp_gestan__0': 1, 'semana__0': 29, 'pais_ocurrencia__0': 'COLOMBIA', 'fec_not__0': '2023-07-21', 'edad__0': 38, 'gp_desplaz__0': 2, 'fm_unidad__0': None, 'fuente__0': 1, 'confirmados__0': 1, 'nom_est_f_caso__0': 'Confirmado por ClÃ­nica', 'gp_psiquia__0': 2, 'fec_aju__0': '2023-08-14', 'departamento_notificacion__0': 'ATLANTICO', 'fm_fuerza__0': None, 'consecutive_origen__0': 280 ... 32531 parameters truncated ... 'fec_arc_xl__446': '2023-05-15', 'fm_grado__446': None, 'municipio_ocurrencia__446': 'VALLEDUPAR', 'ocupacion__446': 99999.04, 'estrato__446': '1         ', 'cod_dpto_r__446': 20, 'cod_sub__446': 1, 'ini_sin__446': '2023-04-10', 'pais_residencia__446': 'COLOMBIA', 'cod_ase__446': 'ESS024', 'gp_otros__446': 1, 'gp_mad_com__446': 2, 'gp_gestan__446': 2, 'semana__446': 20, 'pais_ocurrencia__446': 'COLOMBIA', 'fec_not__446': '2023-05-15', 'edad__446': 25, 'gp_desplaz__446': 2, 'fm_unidad__446': None, 'fuente__446': 4, 'confirmados__446': 1, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'gp_psiquia__446': 2, 'fec_aju__446': '2023-05-15', 'departamento_notificacion__446': 'CESAR', 'fm_fuerza__446': None, 'consecutive_origen__446': 163, 'nacionalidad__446': 170, 'area__446': 1, 'per_etn__446': 6, 'sem_ges__446': '          ', 'departamento_ocurrencia__446': 'CESAR', 'cod_pais_o__446': 170, 'fec_def__446': '2023-05-15', 'sexo__446': 'F', 'municipio_residencia__446': 'VALLEDUPAR', 'departamento_residencia__446': 'CESAR', 'ano__446': 2023, 'tip_cas__446': 4, 'va_sispro__446': 1, 'gp_pobicfb__446': 2, 'gru_pob__446': None, 'cod_pre__446': 2000100183, 'gp_migrant__446': 2, 'ajuste__446': 0, 'nombre_evento__446': 'MORTALIDAD MATERNA', 'cod_dpto_o__446': 20, 'tip_ss__446': 'S', 'gp_indigen__446': 2, 'cer_def__446': 23055820256300}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 22:06:14 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-21 22:06:14 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:10:38 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:10:38 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:10:38 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-21 22:10:38 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:10:49 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:10:49 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:10:50 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-21 22:10:50 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-21 22:10:50 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-21 22:10:50 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:11:13 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:11:13 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:11:14 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-21 22:11:14 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-21 22:11:14 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-21 22:11:15 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-21 22:11:15 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-21 22:11:15 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-21 22:11:15 | ERROR | etl.loader | Error al cargar datos en staging_maternas: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(30)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_dpto_n__0': 25, 'consecutive_12__0': 0, 'gp_otros__0': 1, 'cer_def__0': 722298969.0, 'pac_hos__0': 1, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'fec_aju__0': '2020-07-19', 'uni_med__0': 1, 'sem_ges__0': '          ', 'cod_pre__0': 2589902990, 'gp_psiquia__0': 2, 'fec_not__0': '2020-07-19', 'cod_mun_n__0': 25899, 'fm_grado__0': None, 'area__0': 1, 'pais_ocurrencia__0': 'COLOMBIA', 'gp_desmovi__0': 2, 'municipio_ocurrencia__0': 'GIRARDOT', 'cbmte__0': '9999', 'confirmados__0': 1, 'edad__0': 17, 'municipio_notificacion__0': 'ZIPAQUIRA', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'nom_grupo__0': '                                                                                                    ', 'municipio_residencia__0': 'FLANDES', 'ano__0': 2020, 'cod_mun_o__0': 307, 'gp_discapa__0': 2, 'fuente__0': 1, 'cod_pais_r__0': 170, 'tip_cas__0': 4, 'fec_arc_xl__0': '2020-07-22', 'gp_vic_vio__0': 2, 'gp_gestan__0': 2, 'ini_sin__0': '2020-07-16', 'con_fin__0': 2, 'nacionalidad__0': 170, 'cod_mun_r__0': 275, 'ajuste__0': 0, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'pais_residencia__0': 'COLOMBIA', 'gp_desplaz__0': 2, 'cod_dpto_r__0': 73, 'fec_con__0': '2020-07-16', 'ocupacion__0': 9998, 'fm_unidad__0': None, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'cod_sub__0': 20, 'semana__0': 29, 'sexo__0': 'F' ... 32531 parameters truncated ... 'nom_grupo__446': '                                                                                                    ', 'municipio_residencia__446': 'FLORENCIA', 'ano__446': 2020, 'cod_mun_o__446': 1, 'gp_discapa__446': 2, 'fuente__446': 1, 'cod_pais_r__446': 170, 'tip_cas__446': 4, 'fec_arc_xl__446': '2020-07-22', 'gp_vic_vio__446': 2, 'gp_gestan__446': 2, 'ini_sin__446': '2020-07-04', 'con_fin__446': 2, 'nacionalidad__446': 170, 'cod_mun_r__446': 1, 'ajuste__446': 7, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'pais_residencia__446': 'COLOMBIA', 'gp_desplaz__446': 2, 'cod_dpto_r__446': 18, 'fec_con__446': '2020-07-14', 'ocupacion__446': 9996, 'fm_unidad__446': None, 'departamento_ocurrencia__446': 'CAQUETA', 'cod_sub__446': 1, 'semana__446': 29, 'sexo__446': 'F', 'tip_ss__446': 'S', 'per_etn__446': 6, 'gru_pob__446': None, 'gp_migrant__446': 2, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'gp_mad_com__446': 2, 'fec_hos__446': '2020-07-14', 'fec_def__446': '2020-07-17', 'consecutive_origen__446': 444, 'estado_final_de_caso__446': 4, 'gp_carcela__446': 2, 'estrato__446': '2         ', 'gp_pobicfb__446': 2, 'fm_fuerza__446': None, 'cod_dpto_o__446': 18, 'departamento_notificacion__446': 'CAQUETA', 'cod_pais_o__446': 170, 'cod_eve__446': 550, 'fecha_nto__446': '1987-03-13', 'va_sispro__446': 1, 'cod_ase__446': 'EPSS16', 'gp_indigen__446': 2, 'departamento_residencia__446': 'CAQUETA'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.StringDataRightTruncation: el valor es demasiado largo para el tipo character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loader.py", line 10, in load_to_postgres
    df.to_sql(table_name, engine, if_exists="append", index=False)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ~~~~~~~~~~^
        self,
        ^^^^^
    ...<8 lines>...
        method=method,
        ^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ~~~~~~~~~~~~~~~~~^
        frame,
        ^^^^^^
    ...<9 lines>...
        **engine_kwargs,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
        table=table,
    ...<7 lines>...
        **engine_kwargs,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1012, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) el valor es demasiado largo para el tipo character varying(30)

[SQL: INSERT INTO staging_maternas (cod_eve, fec_not, semana, ano, cod_pre, cod_sub, edad, uni_med, nacionalidad, nombre_nacionalidad, sexo, cod_pais_o, cod_dpto_o, cod_mun_o, area, ocupacion, tip_ss, cod_ase, per_etn, gru_pob, nom_grupo, estrato, gp_disca ... 680916 characters truncated ... 446)s, %(departamento_notificacion__446)s, %(municipio_notificacion__446)s, %(consecutive_12__446)s)]
[parameters: {'cod_dpto_n__0': 25, 'consecutive_12__0': 0, 'gp_otros__0': 1, 'cer_def__0': 722298969.0, 'pac_hos__0': 1, 'nombre_evento__0': 'MORTALIDAD MATERNA', 'fec_aju__0': '2020-07-19', 'uni_med__0': 1, 'sem_ges__0': '          ', 'cod_pre__0': 2589902990, 'gp_psiquia__0': 2, 'fec_not__0': '2020-07-19', 'cod_mun_n__0': 25899, 'fm_grado__0': None, 'area__0': 1, 'pais_ocurrencia__0': 'COLOMBIA', 'gp_desmovi__0': 2, 'municipio_ocurrencia__0': 'GIRARDOT', 'cbmte__0': '9999', 'confirmados__0': 1, 'edad__0': 17, 'municipio_notificacion__0': 'ZIPAQUIRA', 'nombre_nacionalidad__0': 'COLOMBIA                                                                                            ', 'nom_grupo__0': '                                                                                                    ', 'municipio_residencia__0': 'FLANDES', 'ano__0': 2020, 'cod_mun_o__0': 307, 'gp_discapa__0': 2, 'fuente__0': 1, 'cod_pais_r__0': 170, 'tip_cas__0': 4, 'fec_arc_xl__0': '2020-07-22', 'gp_vic_vio__0': 2, 'gp_gestan__0': 2, 'ini_sin__0': '2020-07-16', 'con_fin__0': 2, 'nacionalidad__0': 170, 'cod_mun_r__0': 275, 'ajuste__0': 0, 'nom_upgd__0': 'HOSPITAL REGIONAL DE ZIPAQUIRA', 'pais_residencia__0': 'COLOMBIA', 'gp_desplaz__0': 2, 'cod_dpto_r__0': 73, 'fec_con__0': '2020-07-16', 'ocupacion__0': 9998, 'fm_unidad__0': None, 'departamento_ocurrencia__0': 'CUNDINAMARCA', 'cod_sub__0': 20, 'semana__0': 29, 'sexo__0': 'F' ... 32531 parameters truncated ... 'nom_grupo__446': '                                                                                                    ', 'municipio_residencia__446': 'FLORENCIA', 'ano__446': 2020, 'cod_mun_o__446': 1, 'gp_discapa__446': 2, 'fuente__446': 1, 'cod_pais_r__446': 170, 'tip_cas__446': 4, 'fec_arc_xl__446': '2020-07-22', 'gp_vic_vio__446': 2, 'gp_gestan__446': 2, 'ini_sin__446': '2020-07-04', 'con_fin__446': 2, 'nacionalidad__446': 170, 'cod_mun_r__446': 1, 'ajuste__446': 7, 'nom_upgd__446': 'CLINIA MEDILASER SA', 'pais_residencia__446': 'COLOMBIA', 'gp_desplaz__446': 2, 'cod_dpto_r__446': 18, 'fec_con__446': '2020-07-14', 'ocupacion__446': 9996, 'fm_unidad__446': None, 'departamento_ocurrencia__446': 'CAQUETA', 'cod_sub__446': 1, 'semana__446': 29, 'sexo__446': 'F', 'tip_ss__446': 'S', 'per_etn__446': 6, 'gru_pob__446': None, 'gp_migrant__446': 2, 'nom_est_f_caso__446': 'Confirmado por ClÃ­nica', 'gp_mad_com__446': 2, 'fec_hos__446': '2020-07-14', 'fec_def__446': '2020-07-17', 'consecutive_origen__446': 444, 'estado_final_de_caso__446': 4, 'gp_carcela__446': 2, 'estrato__446': '2         ', 'gp_pobicfb__446': 2, 'fm_fuerza__446': None, 'cod_dpto_o__446': 18, 'departamento_notificacion__446': 'CAQUETA', 'cod_pais_o__446': 170, 'cod_eve__446': 550, 'fecha_nto__446': '1987-03-13', 'va_sispro__446': 1, 'cod_ase__446': 'EPSS16', 'gp_indigen__446': 2, 'departamento_residencia__446': 'CAQUETA'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-21 22:11:15 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-21 22:11:15 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-21 22:11:15 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-21 22:11:16 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-21 22:11:16 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-21 22:11:16 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:13:05 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:13:05 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:13:05 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-21 22:13:05 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-21 22:13:05 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-21 22:13:05 | INFO | main | âœ… ETL finalizado correctamente
2025-09-21 22:13:30 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-21 22:13:30 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-21 22:13:30 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-21 22:13:31 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-21 22:13:31 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-21 22:13:31 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-21 22:13:31 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-21 22:13:31 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-21 22:13:32 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-21 22:13:32 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-21 22:13:32 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-21 22:13:32 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-21 22:13:32 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-21 22:13:32 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-21 22:13:32 | INFO | main | âœ… ETL finalizado correctamente
2025-09-22 00:03:07 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-22 00:03:07 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-22 00:03:08 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-22 00:03:08 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-22 00:03:08 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-22 00:03:08 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-22 00:03:09 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-22 00:03:09 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-22 00:03:09 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-22 00:03:09 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-22 00:03:10 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-22 00:03:10 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-22 00:03:10 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-22 00:03:10 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-22 00:03:10 | INFO | main | âœ… ETL finalizado correctamente
2025-09-22 00:03:10 | CRITICAL | main | Fallo inesperado en el ETL: name 'sp_maternas_mt' is not defined
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 27, in main
    call_stored_procedure(config["db_connection"], "sp_maternas_mt")
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loaddata.py", line 9, in call_stored_procedure
    conn.execute(text(f"CALL {sp_maternas_mt}();"))
                              ^^^^^^^^^^^^^^
NameError: name 'sp_maternas_mt' is not defined
2025-09-22 00:09:49 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-22 00:09:49 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-22 00:09:49 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-22 00:09:49 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-22 00:09:50 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-22 00:09:50 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-22 00:09:50 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-22 00:09:50 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-22 00:09:50 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-22 00:09:51 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-22 00:09:51 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-22 00:09:51 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-22 00:09:51 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-22 00:09:51 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-22 00:09:51 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:14:10 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:14:10 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:14:12 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 21:14:13 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 21:14:13 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 21:14:13 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 21:14:14 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 21:14:14 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 21:14:14 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 21:14:14 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 21:14:15 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 21:14:15 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 21:14:15 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 21:14:15 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 21:14:15 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:14:15 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-24 21:14:15 | CRITICAL | main | Fallo inesperado en el ETL: name 'cons_qry' is not defined
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 33, in main
    consultar_tblmaternas_mt( config["db_connection"], cons_qry)
                                                       ^^^^^^^^
NameError: name 'cons_qry' is not defined. Did you mean: 'cons_qyr'?
2025-09-24 21:21:17 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:21:17 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:21:18 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 21:21:18 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 21:21:18 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 21:21:19 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 21:21:19 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 21:21:19 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 21:21:19 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 21:21:19 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 21:21:20 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 21:21:20 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 21:21:20 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 21:21:20 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 21:21:20 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:21:20 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-24 21:21:20 | CRITICAL | main | Fallo inesperado en el ETL: name 'cons_qry' is not defined
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 33, in main
    consultar_tblmaternas_mt( config["db_connection"], cons_qry)
                                                       ^^^^^^^^
NameError: name 'cons_qry' is not defined. Did you mean: 'cons_qyr'?
2025-09-24 21:27:27 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:27:27 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:27:28 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 21:27:28 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 21:27:28 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 21:27:29 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 21:27:29 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 21:27:29 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 21:27:29 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 21:27:29 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 21:27:29 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 21:27:29 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 21:27:30 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 21:27:30 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 21:27:30 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:27:30 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-24 21:27:30 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-24 21:27:30 | CRITICAL | main | Fallo inesperado en el ETL: (psycopg2.errors.UndefinedTable) no existe la relaciÃ³n Â«tblmaternas_mtÂ»
LINE 1: SELECT * FROM tblmaternas_mt
                      ^

[SQL: SELECT * FROM tblmaternas_mt]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedTable: no existe la relaciÃ³n Â«tblmaternas_mtÂ»
LINE 1: SELECT * FROM tblmaternas_mt
                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 33, in main
    df_cons=consultar_tblmaternas_mt( config["db_connection"],  "SELECT * FROM tblmaternas_mt")
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\reviewdata.py", line 25, in consultar_tblmaternas_mt
    df = pd.read_sql(query, connection)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
           ~~~~~~~~~~~~~~~~~~~~~^
        sql,
        ^^^^
    ...<6 lines>...
        dtype=dtype,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1848, in read_query
    result = self.execute(sql, params)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1671, in execute
    return self.con.exec_driver_sql(sql, *args)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1779, in exec_driver_sql
    ret = self._execute_context(
        dialect,
    ...<5 lines>...
        distilled_parameters,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) no existe la relaciÃ³n Â«tblmaternas_mtÂ»
LINE 1: SELECT * FROM tblmaternas_mt
                      ^

[SQL: SELECT * FROM tblmaternas_mt]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-24 21:30:51 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:30:51 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:30:51 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 21:30:52 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 21:30:52 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 21:30:52 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 21:30:53 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 21:30:53 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 21:30:53 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 21:30:53 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 21:30:53 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 21:30:53 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 21:30:54 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 21:30:54 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 21:30:54 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:30:54 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-24 21:30:54 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-24 21:35:50 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:35:50 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:35:51 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 21:35:51 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 21:35:52 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 21:35:52 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 21:35:52 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 21:35:52 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 21:35:53 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 21:35:53 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 21:35:53 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 21:35:53 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 21:35:53 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 21:35:53 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 21:35:53 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:35:53 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-24 21:35:53 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-24 21:43:33 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:43:33 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 21:43:33 | CRITICAL | main | Fallo inesperado en el ETL: This result object does not return rows. It has been closed automatically.
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 19, in main
    consultar_tblmaternas_mt( config["db_connection"],  "truncate table tbl_maternas_mt;")
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\reviewdata.py", line 27, in consultar_tblmaternas_mt
    df = pd.read_sql(query, connection)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
           ~~~~~~~~~~~~~~~~~~~~~^
        sql,
        ^^^^
    ...<6 lines>...
        dtype=dtype,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1849, in read_query
    columns = result.keys()
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\result.py", line 908, in keys
    return self._metadata.keys
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\cursor.py", line 1374, in keys
    self._we_dont_return_rows()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\cursor.py", line 1346, in _we_dont_return_rows
    raise exc.ResourceClosedError(
    ...<2 lines>...
    ) from err
sqlalchemy.exc.ResourceClosedError: This result object does not return rows. It has been closed automatically.
2025-09-24 21:51:16 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:51:16 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 21:51:16 | CRITICAL | main | Fallo inesperado en el ETL: This result object does not return rows. It has been closed automatically.
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 19, in main
    consultar_tblmaternas_mt( config["db_connection"],  "truncate table tbl_maternas_mt;")
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\reviewdata.py", line 27, in consultar_tblmaternas_mt
    df = pd.read_sql(str_query, connection)
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 736, in read_sql
    return pandas_sql.read_query(
           ~~~~~~~~~~~~~~~~~~~~~^
        sql,
        ^^^^
    ...<6 lines>...
        dtype=dtype,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\pandas\io\sql.py", line 1849, in read_query
    columns = result.keys()
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\result.py", line 908, in keys
    return self._metadata.keys
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\cursor.py", line 1374, in keys
    self._we_dont_return_rows()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\cursor.py", line 1346, in _we_dont_return_rows
    raise exc.ResourceClosedError(
    ...<2 lines>...
    ) from err
sqlalchemy.exc.ResourceClosedError: This result object does not return rows. It has been closed automatically.
2025-09-24 21:54:48 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:54:48 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 21:54:48 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:54:49 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 21:54:49 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 21:54:49 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 21:54:50 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 21:54:50 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 21:54:50 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 21:54:50 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 21:54:50 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 21:54:51 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 21:54:51 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 21:54:51 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 21:54:51 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 21:54:51 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:54:51 | CRITICAL | main | Fallo inesperado en el ETL: (psycopg2.errors.SyntaxError) error de sintaxis en o cerca de Â«(Â»
LINE 1: call public.sp_maternas_mt()();
                                    ^

[SQL: call public.sp_maternas_mt()();]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.SyntaxError: error de sintaxis en o cerca de Â«(Â»
LINE 1: call public.sp_maternas_mt()();
                                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 33, in main
    call_stored_procedure(config["db_connection"], "public.sp_maternas_mt()")
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\loaddata.py", line 13, in call_stored_procedure
    conn.execute(text(f"call {procedure_name}();"))
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) error de sintaxis en o cerca de Â«(Â»
LINE 1: call public.sp_maternas_mt()();
                                    ^

[SQL: call public.sp_maternas_mt()();]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-24 21:55:18 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:55:18 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 21:55:18 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:55:18 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-24 21:55:18 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:55:18 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-24 21:55:18 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-24 21:57:43 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:57:43 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 21:57:43 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:57:43 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 21:57:44 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 21:57:44 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 21:57:44 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 21:57:45 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 21:57:45 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 21:57:45 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 21:57:45 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 21:57:45 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 21:57:45 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 21:57:46 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 21:57:46 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 21:57:46 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:57:46 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-24 21:57:46 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-24 21:59:18 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:59:18 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 21:59:18 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:59:19 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 21:59:19 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 21:59:20 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 21:59:20 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 21:59:20 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 21:59:20 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 21:59:21 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 21:59:21 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 21:59:21 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 21:59:21 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 21:59:21 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 21:59:21 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 21:59:21 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:59:21 | CRITICAL | main | Fallo inesperado en el ETL: name 'false' is not defined
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 33, in main
    call_stored_procedure(config["db_connection"], "public.sp_maternas_mt",tipo=false)
                                                                                ^^^^^
NameError: name 'false' is not defined. Did you mean: 'False'?
2025-09-24 21:59:57 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 21:59:57 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 21:59:57 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 21:59:57 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-24 21:59:57 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 21:59:57 | CRITICAL | main | Fallo inesperado en el ETL: call_stored_procedure() got an unexpected keyword argument 'tipo'
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 33, in main
    call_stored_procedure(config["db_connection"], "public.sp_maternas_mt",tipo=False)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: call_stored_procedure() got an unexpected keyword argument 'tipo'
2025-09-24 22:01:01 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 22:01:01 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 22:01:02 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 22:01:02 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-24 22:01:02 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 22:01:02 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-24 22:01:02 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-24 22:01:34 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 22:01:34 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 22:01:35 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 22:01:36 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 22:01:36 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 22:01:36 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 22:01:37 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 22:01:37 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 22:01:37 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 22:01:38 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 22:01:38 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 22:01:38 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 22:01:38 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 22:01:38 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 22:01:38 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 22:01:38 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 22:01:38 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-24 22:01:38 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-24 22:08:11 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-24 22:08:11 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-24 22:08:11 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-24 22:08:12 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-24 22:08:12 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-24 22:08:13 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-24 22:08:13 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-24 22:08:13 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-24 22:08:13 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-24 22:08:13 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-24 22:08:13 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-24 22:08:14 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-24 22:08:14 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-24 22:08:14 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-24 22:08:14 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-24 22:08:14 | INFO | main | âœ… ETL finalizado correctamente
2025-09-24 22:08:14 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-24 22:08:14 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 19:11:51 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 19:11:51 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 19:11:51 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 19:11:54 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 19:11:54 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-25 19:11:55 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-25 19:11:55 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-25 19:11:56 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 19:11:56 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 19:11:56 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-25 19:11:56 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-25 19:11:56 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-25 19:11:56 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-25 19:11:57 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-25 19:11:57 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-25 19:11:57 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 19:11:57 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 19:11:57 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 20:45:58 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 20:45:58 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 20:45:58 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 20:46:00 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 20:46:00 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-25 20:46:01 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-25 20:46:01 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-25 20:46:01 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 20:46:01 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 20:46:02 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-25 20:46:02 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-25 20:46:02 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-25 20:46:02 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-25 20:46:03 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-25 20:46:03 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-25 20:46:03 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 20:46:03 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 20:46:03 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 21:20:27 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 21:20:27 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 21:20:27 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 21:20:28 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 21:20:28 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-25 21:20:28 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-25 21:20:29 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-25 21:20:29 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 21:20:29 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 21:20:29 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-25 21:20:29 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-25 21:20:30 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-25 21:20:30 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-25 21:20:30 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-25 21:20:30 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-25 21:20:30 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 21:20:30 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 21:20:30 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 21:26:45 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 21:26:45 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 21:26:45 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 21:26:46 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 21:26:46 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-25 21:26:47 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-25 21:26:47 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-25 21:26:47 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 21:26:47 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 21:26:48 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-25 21:26:48 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-25 21:26:48 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-25 21:26:48 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-25 21:26:48 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-25 21:26:48 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-25 21:26:48 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 21:26:49 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 21:26:49 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 21:35:45 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 21:35:45 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 21:35:46 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 21:35:46 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 21:35:47 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-25 21:35:47 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-25 21:35:47 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-25 21:35:48 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 21:35:48 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 21:35:48 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-25 21:35:48 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-25 21:35:49 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-25 21:35:49 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-25 21:35:49 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-25 21:35:49 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-25 21:35:49 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 21:35:50 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 21:35:50 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 21:51:37 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 21:51:37 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 21:51:37 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 21:51:38 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 21:51:38 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-25 21:51:38 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-25 21:51:39 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-25 21:51:39 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 21:51:39 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 21:51:39 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-25 21:51:39 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-25 21:51:40 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-25 21:51:40 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-25 21:51:40 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-25 21:51:40 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-25 21:51:40 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 21:51:40 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 21:51:40 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 22:00:29 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 22:00:29 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 22:00:29 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 22:00:29 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 22:00:30 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 22:00:30 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 22:00:30 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 22:00:30 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 22:00:30 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 22:02:19 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 22:02:19 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 22:02:19 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 22:02:19 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 22:02:20 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 22:02:20 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 22:02:20 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 22:02:20 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 22:02:20 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 22:17:22 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 22:17:22 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 22:17:23 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 22:17:23 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 22:17:23 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 22:17:23 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 22:17:23 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 22:17:23 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 22:17:23 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 22:39:38 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 22:39:38 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 22:39:38 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 22:39:38 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-25 22:39:38 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 22:39:38 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 22:39:38 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 22:41:35 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 22:41:35 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 22:41:36 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 22:41:36 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 22:41:37 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 22:41:37 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 22:41:37 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 22:41:37 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 22:41:37 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 22:47:37 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 22:47:37 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 22:47:37 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 22:47:38 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 22:47:38 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 22:47:38 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 22:47:38 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 22:47:38 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 22:47:38 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-25 22:48:27 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-25 22:48:27 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-25 22:48:27 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-25 22:48:28 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-25 22:48:28 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-25 22:48:28 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-25 22:48:28 | INFO | main | âœ… ETL finalizado correctamente
2025-09-25 22:48:28 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-25 22:48:28 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-26 19:18:26 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-26 19:18:26 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-26 19:18:27 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-26 19:18:30 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-26 19:18:31 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-26 19:18:31 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-26 19:18:31 | INFO | main | âœ… ETL finalizado correctamente
2025-09-26 19:18:31 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-26 19:18:31 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-26 19:25:23 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-26 19:25:23 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-26 19:25:23 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-26 19:25:24 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-26 19:25:24 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-26 19:25:24 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-26 19:25:24 | INFO | main | âœ… ETL finalizado correctamente
2025-09-26 19:25:24 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-26 19:25:24 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-26 19:33:09 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-26 19:33:09 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-26 19:33:10 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-26 19:33:10 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-26 19:33:11 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-26 19:33:11 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-26 19:33:11 | INFO | main | âœ… ETL finalizado correctamente
2025-09-26 19:33:11 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-26 19:33:11 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-26 20:03:04 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-26 20:03:04 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-26 20:03:04 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-26 20:03:04 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-26 20:03:05 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-26 20:03:05 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-26 20:03:05 | INFO | main | âœ… ETL finalizado correctamente
2025-09-26 20:03:05 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-26 20:03:05 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-26 22:01:11 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-26 22:01:11 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-26 22:01:12 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-26 22:01:14 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-26 22:01:15 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-26 22:01:15 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-26 22:01:15 | INFO | main | âœ… ETL finalizado correctamente
2025-09-26 22:01:15 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-26 22:01:15 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-26 22:01:59 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-26 22:01:59 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-26 22:01:59 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-26 22:02:00 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-26 22:02:01 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-26 22:02:01 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-26 22:02:01 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-26 22:02:02 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-26 22:02:02 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-26 22:02:02 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-26 22:02:02 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-26 22:02:02 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-26 22:02:02 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-26 22:02:03 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-26 22:02:03 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-26 22:02:03 | INFO | main | âœ… ETL finalizado correctamente
2025-09-26 22:02:03 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-26 22:02:03 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-28 10:35:44 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-28 10:35:44 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-28 10:35:45 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-28 10:35:47 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-28 10:35:48 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-28 10:35:48 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-28 10:35:48 | INFO | etl.extractor | Archivo Datos_2022_550.xlsx leÃ­do correctamente con 484 filas
2025-09-28 10:35:48 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-28 10:35:49 | INFO | etl.extractor | Archivo Datos_2024_550.xlsx leÃ­do correctamente con 377 filas
2025-09-28 10:35:49 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-28 10:35:49 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-28 10:35:49 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-28 10:35:49 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-28 10:35:50 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-28 10:35:50 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-28 10:35:50 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (484 filas)
2025-09-28 10:35:50 | INFO | etl.utils | Archivo Datos_2022_550.xlsx movido a data\processed\Datos_2022_550.xlsx
2025-09-28 10:35:50 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-28 10:35:50 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-28 10:35:50 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (377 filas)
2025-09-28 10:35:50 | INFO | etl.utils | Archivo Datos_2024_550.xlsx movido a data\processed\Datos_2024_550.xlsx
2025-09-28 10:35:50 | INFO | main | âœ… ETL finalizado correctamente
2025-09-28 10:35:50 | CRITICAL | main | Fallo inesperado en el ETL: (psycopg2.errors.SyntaxError) error de sintaxis al final de la entrada
LINE 1: call public.sp_maternas_mt
                                  ^

[SQL: call public.sp_maternas_mt]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.SyntaxError: error de sintaxis al final de la entrada
LINE 1: call public.sp_maternas_mt
                                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 33, in main
    consultar_tblmaternas_mt(config["db_connection"], "call public.sp_maternas_mt",tipo=False)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\reviewdata.py", line 30, in consultar_tblmaternas_mt
    connection.execute(text(str_query))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) error de sintaxis al final de la entrada
LINE 1: call public.sp_maternas_mt
                                  ^

[SQL: call public.sp_maternas_mt]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-28 10:36:26 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-28 10:36:26 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-28 10:36:27 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-28 10:36:27 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-28 10:36:27 | INFO | main | âœ… ETL finalizado correctamente
2025-09-28 10:36:27 | CRITICAL | main | Fallo inesperado en el ETL: (psycopg2.errors.SyntaxError) error de sintaxis al final de la entrada
LINE 1: call public.sp_maternas_mt
                                  ^

[SQL: call public.sp_maternas_mt]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.SyntaxError: error de sintaxis al final de la entrada
LINE 1: call public.sp_maternas_mt
                                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 33, in main
    consultar_tblmaternas_mt(config["db_connection"], "call public.sp_maternas_mt",tipo=False)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\reviewdata.py", line 30, in consultar_tblmaternas_mt
    connection.execute(text(str_query))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) error de sintaxis al final de la entrada
LINE 1: call public.sp_maternas_mt
                                  ^

[SQL: call public.sp_maternas_mt]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-28 10:36:41 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-28 10:36:41 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-28 10:36:41 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-28 10:36:41 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-28 10:36:41 | INFO | main | âœ… ETL finalizado correctamente
2025-09-28 10:36:41 | CRITICAL | main | Fallo inesperado en el ETL: (psycopg2.errors.SyntaxError) error de sintaxis en o cerca de Â«;Â»
LINE 1: call public.sp_maternas_mt;
                                  ^

[SQL: call public.sp_maternas_mt;]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.SyntaxError: error de sintaxis en o cerca de Â«;Â»
LINE 1: call public.sp_maternas_mt;
                                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\main.py", line 33, in main
    consultar_tblmaternas_mt(config["db_connection"], "call public.sp_maternas_mt;",tipo=False)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\etl\reviewdata.py", line 30, in consultar_tblmaternas_mt
    connection.execute(text(str_query))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\JoseAntonioPalacioUr\Documents\wPythonProy\etl_Project\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) error de sintaxis en o cerca de Â«;Â»
LINE 1: call public.sp_maternas_mt;
                                  ^

[SQL: call public.sp_maternas_mt;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-28 10:37:05 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-28 10:37:05 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-28 10:37:05 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-28 10:37:05 | WARNING | etl.extractor | No se encontraron archivos Excel en la ruta
2025-09-28 10:37:05 | INFO | main | âœ… ETL finalizado correctamente
2025-09-28 10:37:05 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-28 10:37:05 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-28 10:38:59 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-28 10:38:59 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-28 10:38:59 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-28 10:38:59 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-28 10:39:00 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-28 10:39:00 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-28 10:39:00 | INFO | etl.extractor | Archivo Datos_2022_550.xlsx leÃ­do correctamente con 484 filas
2025-09-28 10:39:00 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-28 10:39:00 | INFO | etl.extractor | Archivo Datos_2024_550.xlsx leÃ­do correctamente con 377 filas
2025-09-28 10:39:01 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-28 10:39:01 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-28 10:39:01 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-28 10:39:01 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-28 10:39:01 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-28 10:39:01 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-28 10:39:02 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (484 filas)
2025-09-28 10:39:02 | INFO | etl.utils | Archivo Datos_2022_550.xlsx movido a data\processed\Datos_2022_550.xlsx
2025-09-28 10:39:02 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-28 10:39:02 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-28 10:39:02 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (377 filas)
2025-09-28 10:39:02 | INFO | etl.utils | Archivo Datos_2024_550.xlsx movido a data\processed\Datos_2024_550.xlsx
2025-09-28 10:39:02 | INFO | main | âœ… ETL finalizado correctamente
2025-09-28 10:39:03 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-28 12:43:31 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-28 12:43:31 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-28 12:43:32 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-28 12:43:33 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-28 12:43:34 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-28 12:43:34 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-28 12:43:34 | INFO | etl.extractor | Archivo Datos_2022_550.xlsx leÃ­do correctamente con 484 filas
2025-09-28 12:43:34 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-28 12:43:35 | INFO | etl.extractor | Archivo Datos_2024_550.xlsx leÃ­do correctamente con 377 filas
2025-09-28 12:43:35 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-28 12:43:35 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-28 12:43:35 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-28 12:43:35 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-28 12:43:36 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-28 12:43:36 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-28 12:43:36 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (484 filas)
2025-09-28 12:43:36 | INFO | etl.utils | Archivo Datos_2022_550.xlsx movido a data\processed\Datos_2022_550.xlsx
2025-09-28 12:43:36 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-28 12:43:36 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-28 12:43:37 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (377 filas)
2025-09-28 12:43:37 | INFO | etl.utils | Archivo Datos_2024_550.xlsx movido a data\processed\Datos_2024_550.xlsx
2025-09-28 12:43:37 | INFO | main | âœ… ETL finalizado correctamente
2025-09-28 12:43:37 | INFO | main | âœ… Procesar SP Maternas_MT
2025-09-28 15:56:29 | INFO | main | ðŸš€ Iniciando ETL...
2025-09-28 15:56:29 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-09-28 15:56:29 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-09-28 15:56:30 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-09-28 15:56:30 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-09-28 15:56:31 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-09-28 15:56:31 | INFO | etl.extractor | Archivo Datos_2022_550.xlsx leÃ­do correctamente con 484 filas
2025-09-28 15:56:31 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-09-28 15:56:31 | INFO | etl.extractor | Archivo Datos_2024_550.xlsx leÃ­do correctamente con 377 filas
2025-09-28 15:56:32 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-09-28 15:56:32 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-09-28 15:56:32 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-09-28 15:56:32 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-09-28 15:56:32 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-09-28 15:56:32 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-09-28 15:56:33 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (484 filas)
2025-09-28 15:56:33 | INFO | etl.utils | Archivo Datos_2022_550.xlsx movido a data\processed\Datos_2022_550.xlsx
2025-09-28 15:56:33 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-09-28 15:56:33 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-09-28 15:56:33 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (377 filas)
2025-09-28 15:56:33 | INFO | etl.utils | Archivo Datos_2024_550.xlsx movido a data\processed\Datos_2024_550.xlsx
2025-09-28 15:56:33 | INFO | main | âœ… ETL finalizado correctamente
2025-09-28 15:56:33 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-28 15:56:35 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-09-28 15:56:35 | INFO | main | âœ… Procesar SP Maternas_MT
2025-10-07 19:21:12 | INFO | main | ðŸš€ Iniciando ETL...
2025-10-07 19:21:12 | INFO | main | ðŸš€ Limpia datos de staging_maternas u tbl_maternas_mt...
2025-10-07 19:21:12 | INFO | etl.extractor | Leyendo archivos desde data/input_excels
2025-10-07 19:21:15 | INFO | etl.extractor | Archivo Datos_2019_550.xlsx leÃ­do correctamente con 550 filas
2025-10-07 19:21:16 | INFO | etl.extractor | Archivo Datos_2020_550.xlsx leÃ­do correctamente con 607 filas
2025-10-07 19:21:16 | INFO | etl.extractor | Archivo Datos_2021_550.xlsx leÃ­do correctamente con 654 filas
2025-10-07 19:21:16 | INFO | etl.extractor | Archivo Datos_2022_550.xlsx leÃ­do correctamente con 484 filas
2025-10-07 19:21:17 | INFO | etl.extractor | Archivo Datos_2023_550.xlsx leÃ­do correctamente con 472 filas
2025-10-07 19:21:17 | INFO | etl.extractor | Archivo Datos_2024_550.xlsx leÃ­do correctamente con 377 filas
2025-10-07 19:21:18 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (550 filas)
2025-10-07 19:21:18 | INFO | etl.utils | Archivo Datos_2019_550.xlsx movido a data\processed\Datos_2019_550.xlsx
2025-10-07 19:21:18 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (607 filas)
2025-10-07 19:21:18 | INFO | etl.utils | Archivo Datos_2020_550.xlsx movido a data\processed\Datos_2020_550.xlsx
2025-10-07 19:21:18 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (654 filas)
2025-10-07 19:21:18 | INFO | etl.utils | Archivo Datos_2021_550.xlsx movido a data\processed\Datos_2021_550.xlsx
2025-10-07 19:21:19 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (484 filas)
2025-10-07 19:21:19 | INFO | etl.utils | Archivo Datos_2022_550.xlsx movido a data\processed\Datos_2022_550.xlsx
2025-10-07 19:21:19 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (472 filas)
2025-10-07 19:21:19 | INFO | etl.utils | Archivo Datos_2023_550.xlsx movido a data\processed\Datos_2023_550.xlsx
2025-10-07 19:21:19 | INFO | etl.loader | Cargado DataFrame a tabla staging_maternas (377 filas)
2025-10-07 19:21:19 | INFO | etl.utils | Archivo Datos_2024_550.xlsx movido a data\processed\Datos_2024_550.xlsx
2025-10-07 19:21:19 | INFO | main | âœ… ETL finalizado correctamente
2025-10-07 19:21:19 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-10-07 19:21:22 | INFO | etl.loaddata | Abre conexiÃ³n: Engine(postgresql+psycopg2://postgres:***@localhost:5432/dbmaterna_mt) )
2025-10-07 19:21:22 | INFO | main | âœ… Procesar SP Maternas_MT
2025-10-07 19:21:22 | INFO | main | ðŸš€ Llamado a modelo
2025-10-07 19:21:22 | INFO | main | âœ… Modelo de Ã¡rbol de decisiÃ³n generado correctamente
